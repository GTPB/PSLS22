<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Tutorial 7.3: ANOVA in the NHANES dataset</title>

<script src="site_libs/header-attrs-2.13/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">PSLS</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-chalkboard-teacher"></span>
     
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="01-intro.html">1. Introduction</a>
    </li>
    <li>
      <a href="02-concepts.html">2. Concepts</a>
    </li>
    <li>
      <a href="03-experimentalDesign.html">3. Experimental Design I</a>
    </li>
    <li>
      <a href="04-dataExploration.html">4. Data Exploration</a>
    </li>
    <li>
      <a href="05-statisticalInference.html">5.1 Statistical Inference 1</a>
    </li>
    <li>
      <a href="05-statisticalInference-twosampleT.html">5.2 Statistical Inference 2</a>
    </li>
    <li>
      <a href="06-linearRegression.html">6. Linear Regression</a>
    </li>
    <li>
      <a href="07-Anova.html">7. Analysis of Variance</a>
    </li>
    <li>
      <a href="08-MultipleRegression.html">8. Multiple Regression</a>
    </li>
    <li>
      <a href="08-MultipleRegression-SpecificDesigns.html">8.2 Multiple Regression: Factorial Designs</a>
    </li>
    <li>
      <a href="08-experimentalDesignII.html">8.3. Experimental Design II</a>
    </li>
    <li>
      <a href="08-experimentalDesignIII.html">8.4. Experimental Design II</a>
    </li>
    <li>
      <a href="09-NonparametericStatistics-WilcoxonMannWithney.html">9.1. Nonparametric Statistics 1</a>
    </li>
    <li>
      <a href="09-NonparametericStatistics-KruskalWallis.html">9.2. Nonparametric Statistics 2</a>
    </li>
    <li>
      <a href="10-categoricalDataAnalysis.html">10. Categorical Data Analysis</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-laptop"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="04_exercises.html">4. Data Exploration</a>
    </li>
    <li>
      <a href="05_exercises.html">5. Statistical inference</a>
    </li>
    <li>
      <a href="06_exercises.html">6. Simple linear regression</a>
    </li>
    <li>
      <a href="07_exercises.html">7. ANOVA</a>
    </li>
    <li>
      <a href="08_exercises.html">8. Multiple linear regression</a>
    </li>
    <li>
      <a href="09_exercises.html">9. Non-parametric statistics</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/statOmics/PSLS">
    <span class="fab fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://statomics.github.io/">statOmics</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Tutorial 7.3: ANOVA in the NHANES dataset</h1>

</div>


<div id="the-nhanes-dataset" class="section level1" number="1">
<h1><span class="header-section-number">1</span> The NHANES dataset</h1>
<p>The National Health and Nutrition Examination Survey (NHANES) contains data that has been collected since 1960. For this tutorial, we will make use of the data that were collected between 2009 and 2012, for 10.000 U.S. civilians. The dataset contains a large number of physical, demographic, nutritional and life-style-related parameters.</p>
</div>
<div id="goal" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Goal</h1>
<p>In the NHANES dataset, one of the columns is named <code>HealthGen</code>. HealthGen is a self-reported rating of a participant’s health in general terms. HealthGen is reported for participants aged 12 years or older. It is a factor with the following levels: Excellent, Vgood, Good, Fair, or Poor.</p>
<p>We want to test whether or not the mean systolic blood pressure value (take column <code>BPSys1</code>) is equal between the five self-reported health categories. To this end, we will use an ANOVA analysis (if the required assumptions are met).</p>
<p>Load the required libraries</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
</div>
<div id="data-import" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Data import</h1>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>NHANES <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/statOmics/PSLS21/data/NHANES.csv&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(NHANES[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>])</span></code></pre></div>
<pre><code>## Rows: 10,000
## Columns: 10
## $ ID            &lt;dbl&gt; 51624, 51624, 51624, 51625, 51630, 51638, 51646, 51647, …
## $ SurveyYr      &lt;chr&gt; &quot;2009_10&quot;, &quot;2009_10&quot;, &quot;2009_10&quot;, &quot;2009_10&quot;, &quot;2009_10&quot;, &quot;…
## $ Gender        &lt;chr&gt; &quot;male&quot;, &quot;male&quot;, &quot;male&quot;, &quot;male&quot;, &quot;female&quot;, &quot;male&quot;, &quot;male&quot;…
## $ Age           &lt;dbl&gt; 34, 34, 34, 4, 49, 9, 8, 45, 45, 45, 66, 58, 54, 10, 58,…
## $ AgeDecade     &lt;chr&gt; &quot;30-39&quot;, &quot;30-39&quot;, &quot;30-39&quot;, &quot;0-9&quot;, &quot;40-49&quot;, &quot;0-9&quot;, &quot;0-9&quot;,…
## $ AgeMonths     &lt;dbl&gt; 409, 409, 409, 49, 596, 115, 101, 541, 541, 541, 795, 70…
## $ Race1         &lt;chr&gt; &quot;White&quot;, &quot;White&quot;, &quot;White&quot;, &quot;Other&quot;, &quot;White&quot;, &quot;White&quot;, &quot;W…
## $ Race3         &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ Education     &lt;chr&gt; &quot;High School&quot;, &quot;High School&quot;, &quot;High School&quot;, NA, &quot;Some C…
## $ MaritalStatus &lt;chr&gt; &quot;Married&quot;, &quot;Married&quot;, &quot;Married&quot;, NA, &quot;LivePartner&quot;, NA, …</code></pre>
</div>
<div id="data-exploration" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Data Exploration</h1>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>NHANES <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>HealthGen,<span class="at">y=</span>BPSys1,<span class="at">fill=</span>HealthGen)) <span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">&quot;RdGy&quot;</span>) <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape=</span><span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_jitter(width = 0.2,size=0.01) + ## omitted as it makes the plot messy</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Boxplot of the systolic bloodpressure for each health category&quot;</span>) <span class="sc">+</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Systolic blood pressure (mmHg)&quot;</span>) <span class="sc">+</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y=</span>mean, <span class="at">geom=</span><span class="st">&quot;point&quot;</span>, <span class="at">shape=</span><span class="dv">5</span>, <span class="at">size=</span><span class="dv">3</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">fill=</span><span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: `fun.y` is deprecated. Use `fun` instead.</code></pre>
<pre><code>## Warning: Removed 1763 rows containing non-finite values (stat_boxplot).</code></pre>
<pre><code>## Warning: Removed 1763 rows containing non-finite values (stat_summary).</code></pre>
<p><img src="07_3_NHANES_sol_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>This plot is not ideal; it would be far more intuitive if the health categories were ordered properly (i.e., Poor –&gt; excellent). In addition, we observe a sixth “category” of NA values.</p>
<p>To get a more informative and intuitive visualization, you can:</p>
<ol style="list-style-type: decimal">
<li>Filter out subjects with NA values for <code>HealthGen</code> or <code>BPSys1</code></li>
<li>Set <code>HealthGen</code> to a factor and relevel it to Poor –&gt; Excellent</li>
</ol>
<p><strong>Hint:</strong> The second task can be achieved by using the <code>mutate</code>, <code>as.factor</code> and <code>fct_relevel</code> functions.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>NHANES <span class="ot">&lt;-</span> NHANES <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(HealthGen),<span class="sc">!</span><span class="fu">is.na</span>(BPSys1)) <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">HealthGen =</span> <span class="fu">as.factor</span>(HealthGen)) <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">HealthGen =</span><span class="fu">fct_relevel</span>(HealthGen,<span class="fu">c</span>(<span class="st">&quot;Poor&quot;</span>,<span class="st">&quot;Fair&quot;</span>,<span class="st">&quot;Good&quot;</span>,<span class="st">&quot;Vgood&quot;</span>,<span class="st">&quot;Excellent&quot;</span>)))</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>NHANES <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>HealthGen,<span class="at">y=</span>BPSys1,<span class="at">fill=</span>HealthGen)) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">&quot;RdGy&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape=</span><span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Boxplot of the systolic bloodpressure for each health category&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Systolic blood pressure (mmHg)&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y=</span>mean, <span class="at">geom=</span><span class="st">&quot;point&quot;</span>, <span class="at">shape=</span><span class="dv">5</span>, <span class="at">size=</span><span class="dv">3</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">fill=</span><span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: `fun.y` is deprecated. Use `fun` instead.</code></pre>
<p><img src="07_3_NHANES_sol_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="anova" class="section level1" number="5">
<h1><span class="header-section-number">5</span> ANOVA</h1>
<p>To study if the observed difference between the average systolic blood pressure values of the different health groups are significant, we may perform an ANOVA.</p>
<div id="formulate-null-and-alternative-hyoptheses" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Formulate null and alternative hyoptheses</h2>
<p>The null hypothesis of ANOVA states that: <span class="math inline">\(H0\)</span>: The mean systolic blood pressure is equal between the different health groups.</p>
<p>The alternative hypothesis of ANOVA states that: <span class="math inline">\(HA\)</span>: The mean systolic blood pressure for at least one health group is different from the mean systolic blood pressure in at least one other health group.</p>
</div>
<div id="check-the-assumptions-for-anova" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Check the assumptions for ANOVA</h2>
<p>Before we may proceed with the analysis, we must make sure that all assumptions for ANOVA are met. ANOVA has three assumptions:</p>
<ol style="list-style-type: decimal">
<li>The observations are independent of each other (in all groups)</li>
<li>The data (BPSys1) must be normally distributed (in all groups)</li>
<li>The variability within all groups is similar</li>
</ol>
<div id="assumption-of-independence" class="section level3" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Assumption of independence</h3>
<p>The first assumption is met; there shoud be no specific pattterns of dependence.</p>
</div>
<div id="assumption-of-normality" class="section level3" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Assumption of normality</h3>
<p>For the second assumption, we must check normality in each group.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>NHANES <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample=</span>BPSys1)) <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>HealthGen)</span></code></pre></div>
<p><img src="07_3_NHANES_sol_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>The data does not appear to be normally distributed for each group. It seems to have a heavy right tail. We can perform a log transformation on the data.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>NHANES <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">BPSys1_log =</span> <span class="fu">log</span>(BPSys1)) <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample=</span>BPSys1_log)) <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>HealthGen)</span></code></pre></div>
<p><img src="07_3_NHANES_sol_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>While the log transformation improved the distributions somewhat, the data still does not appear to be normally distributed for each group. However, we do have a very large number of observations per group:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Count the number of observations per treatment</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>NHANES <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(HealthGen)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["HealthGen"],"name":[1],"type":["fct"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"Poor","2":"184"},{"1":"Fair","2":"934"},{"1":"Good","2":"2803"},{"1":"Vgood","2":"2367"},{"1":"Excellent","2":"848"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>As such, we may rely on the cental limit theorem. Remember, the cental limit theorem that when the number of observations is sufficiently large (i.e. &gt;100), we will assume that the distribution of the sample mean will approximate a normal distribution, even if the underlying data is not normally distributed.</p>
</div>
</div>
<div id="anova-model" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> ANOVA model</h2>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(BPSys1)<span class="sc">~</span>HealthGen, NHANES)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>fit_anova <span class="ot">&lt;-</span> <span class="fu">anova</span>(fit)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>fit_anova</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["Sum Sq"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Mean Sq"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["F value"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"4","2":"1.908401","3":"0.47710019","4":"25.78773","5":"2.993562e-21","_rn_":"HealthGen"},{"1":"7131","2":"131.931042","3":"0.01850106","4":"NA","5":"NA","_rn_":"Residuals"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Not-rounded p-value:&quot;</span>, fit_anova<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>]))</span></code></pre></div>
<pre><code>## [1] &quot;Not-rounded p-value: 2.99356182478463e-21&quot;</code></pre>
<p>The p-value of the ANOVA analysis is extremely significant (p-value = 2.994e-21), so we reject the null hypothesis that the mean egg length is equal between the different bird types. We can say that the mean egg length is significantly different between at least two bird types on the 5% significance level.</p>
<p>Based on this analysis, we do not yet know between which particular bird types there is a significant difference. To study this, we will perfrom the Tuckey post-hoc analysis.</p>
</div>
<div id="post-hoc-analysis" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Post-hoc analysis</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>mcp <span class="ot">&lt;-</span> <span class="fu">glht</span>(fit, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">HealthGen =</span> <span class="st">&quot;Tukey&quot;</span>))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mcp)</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lm(formula = log(BPSys1) ~ HealthGen, data = NHANES)
## 
## Linear Hypotheses:
##                         Estimate Std. Error t value Pr(&gt;|t|)    
## Fair - Poor == 0       -0.015828   0.010971  -1.443  0.57589    
## Good - Poor == 0       -0.036762   0.010351  -3.551  0.00313 ** 
## Vgood - Poor == 0      -0.059415   0.010410  -5.708  &lt; 0.001 ***
## Excellent - Poor == 0  -0.055476   0.011062  -5.015  &lt; 0.001 ***
## Good - Fair == 0       -0.020934   0.005139  -4.074  &lt; 0.001 ***
## Vgood - Fair == 0      -0.043587   0.005256  -8.293  &lt; 0.001 ***
## Excellent - Fair == 0  -0.039648   0.006452  -6.145  &lt; 0.001 ***
## Vgood - Good == 0      -0.022653   0.003797  -5.966  &lt; 0.001 ***
## Excellent - Good == 0  -0.018714   0.005331  -3.511  0.00363 ** 
## Excellent - Vgood == 0  0.003938   0.005444   0.723  0.94609    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(mcp)</span></code></pre></div>
<pre><code>## 
##   Simultaneous Confidence Intervals
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lm(formula = log(BPSys1) ~ HealthGen, data = NHANES)
## 
## Quantile = 2.6821
## 95% family-wise confidence level
##  
## 
## Linear Hypotheses:
##                        Estimate  lwr       upr      
## Fair - Poor == 0       -0.015828 -0.045252  0.013596
## Good - Poor == 0       -0.036762 -0.064525 -0.008999
## Vgood - Poor == 0      -0.059415 -0.087335 -0.031495
## Excellent - Poor == 0  -0.055476 -0.085145 -0.025808
## Good - Fair == 0       -0.020934 -0.034717 -0.007151
## Vgood - Fair == 0      -0.043587 -0.057683 -0.029490
## Excellent - Fair == 0  -0.039648 -0.056952 -0.022344
## Vgood - Good == 0      -0.022653 -0.032836 -0.012469
## Excellent - Good == 0  -0.018714 -0.033012 -0.004417
## Excellent - Vgood == 0  0.003938 -0.010662  0.018539</code></pre>
</div>
<div id="conclusion" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> Conclusion</h2>
<p>We have found an extremely significant dependence (p-value = 2.994e-21), between the mean systolic blood pressure and the health group on the global 5% significance level.</p>
<p>The mean logarithm of systolic blood pressure in the self-reported health category <code>Poor</code> is significantly higher as compared three other groups:</p>
<ul>
<li>the <code>Good</code> group (adjusted p-value = &lt; 0.001, mean difference = -0.036762 mmHg, 95% CI [-0.034725; -0.007142])</li>
<li>the <code>Vgood</code> group (adjusted p-value = &lt; 0.001, mean difference = -0.059415 mmHg, 95% CI [-0.087352; -0.031477])</li>
<li>the <code>Excellent</code> group (adjusted p-value = &lt; 0.001, mean difference = -0.059415 mmHg, 95% CI [-0.085164; -0.025789])</li>
</ul>
<p>The mean logarithm of systolic blood pressure in the self-reported health category <code>Fair</code> is significantly higher as compared three other groups:</p>
<ul>
<li>the <code>Good</code> group (adjusted p-value = 0.00317, mean difference = -0.020934 mmHg, 95% CI [-0.064542; -0.008982])</li>
<li>the <code>Vgood</code> group (adjusted p-value = &lt; 0.001, mean difference = -0.043587 mmHg, 95% CI [-0.057692; -0.029481])</li>
<li>the <code>Excellent</code> group (adjusted p-value = &lt; 0.001, mean difference = -0.039648 mmHg, 95% CI [-0.056963; -0.022333])</li>
</ul>
<p>The mean logarithm of systolic blood pressure in the self-reported health category <code>Good</code> is significantly higher as compared two other groups:</p>
<ul>
<li>the <code>Vgood</code> group (adjusted p-value = &lt; 0.001, mean difference = -0.022653 mmHg, 95% CI [-0.032843; -0.012463])</li>
<li>the <code>Excellent</code> group (adjusted p-value = 0.00362, mean difference = -0.018714 mmHg, 95% CI [-0.033021; -0.004408])</li>
</ul>
<p>We do not find enough evidence to claim a difference in systolic blood pressure levels between the other groups.</p>
<p>Note that in order to interpret the outcomes on the original scale, we should backtransform the outcomes with the <code>exp()</code> functions (interpretation on the geometric mean).</p>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiVHV0b3JpYWwgNy4zOiBBTk9WQSBpbiB0aGUgTkhBTkVTIGRhdGFzZXQiCm91dHB1dDoKICAgIGh0bWxfZG9jdW1lbnQ6CiAgICAgIGNvZGVfZG93bmxvYWQ6IHRydWUKICAgICAgdGhlbWU6IGNvc21vCiAgICAgIHRvYzogdHJ1ZQogICAgICB0b2NfZmxvYXQ6IHRydWUKICAgICAgaGlnaGxpZ2h0OiB0YW5nbwogICAgICBudW1iZXJfc2VjdGlvbnM6IHRydWUKLS0tCgojIFRoZSBOSEFORVMgZGF0YXNldAoKVGhlIE5hdGlvbmFsIEhlYWx0aCBhbmQgTnV0cml0aW9uIEV4YW1pbmF0aW9uIFN1cnZleSAoTkhBTkVTKSBjb250YWlucyBkYXRhCnRoYXQgaGFzIGJlZW4gY29sbGVjdGVkIHNpbmNlIDE5NjAuIEZvciB0aGlzIHR1dG9yaWFsLCB3ZSB3aWxsIG1ha2UgdXNlIG9mCnRoZSBkYXRhIHRoYXQgd2VyZSBjb2xsZWN0ZWQgYmV0d2VlbiAyMDA5IGFuZCAyMDEyLCBmb3IgMTAuMDAwIFUuUy4gY2l2aWxpYW5zLgpUaGUgZGF0YXNldCBjb250YWlucyBhIGxhcmdlIG51bWJlciBvZiBwaHlzaWNhbCwgZGVtb2dyYXBoaWMsIG51dHJpdGlvbmFsIGFuZApsaWZlLXN0eWxlLXJlbGF0ZWQgcGFyYW1ldGVycy4KCiMgR29hbAoKSW4gdGhlIE5IQU5FUyBkYXRhc2V0LCBvbmUgb2YgdGhlIGNvbHVtbnMgaXMgbmFtZWQgYEhlYWx0aEdlbmAuCkhlYWx0aEdlbiBpcyBhIHNlbGYtcmVwb3J0ZWQgcmF0aW5nIG9mIGEgcGFydGljaXBhbnTigJlzIGhlYWx0aAppbiBnZW5lcmFsIHRlcm1zLiBIZWFsdGhHZW4gaXMgcmVwb3J0ZWQgZm9yIHBhcnRpY2lwYW50cyBhZ2VkIDEyCnllYXJzIG9yIG9sZGVyLiBJdCBpcyBhIGZhY3RvciB3aXRoIHRoZSBmb2xsb3dpbmcgbGV2ZWxzOgpFeGNlbGxlbnQsIFZnb29kLCBHb29kLCBGYWlyLCBvciBQb29yLgoKV2Ugd2FudCB0byB0ZXN0IHdoZXRoZXIgb3Igbm90IHRoZSBtZWFuIHN5c3RvbGljIGJsb29kIHByZXNzdXJlCnZhbHVlICh0YWtlIGNvbHVtbiBgQlBTeXMxYCkgaXMgZXF1YWwgYmV0d2VlbiB0aGUgZml2ZSBzZWxmLXJlcG9ydGVkCmhlYWx0aCBjYXRlZ29yaWVzLiBUbyB0aGlzIGVuZCwgd2Ugd2lsbCB1c2UgYW4gQU5PVkEgYW5hbHlzaXMKKGlmIHRoZSByZXF1aXJlZCBhc3N1bXB0aW9ucyBhcmUgbWV0KS4KCkxvYWQgdGhlIHJlcXVpcmVkIGxpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRX0KbGlicmFyeSh0aWR5dmVyc2UpCmBgYAoKIyBEYXRhIGltcG9ydAoKYGBge3IsIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0V9Ck5IQU5FUyA8LSByZWFkX2NzdigiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3N0YXRPbWljcy9QU0xTMjEvZGF0YS9OSEFORVMuY3N2IikKZ2xpbXBzZShOSEFORVNbMToxMF0pCmBgYAoKIyBEYXRhIEV4cGxvcmF0aW9uCgpgYGB7cn0KTkhBTkVTICU+JQogIGdncGxvdChhZXMoeD1IZWFsdGhHZW4seT1CUFN5czEsZmlsbD1IZWFsdGhHZW4pKSArCiAgc2NhbGVfZmlsbF9icmV3ZXIocGFsZXR0ZT0iUmRHeSIpICsKICB0aGVtZV9idygpICsKICBnZW9tX2JveHBsb3Qob3V0bGllci5zaGFwZT1OQSkgKwogICNnZW9tX2ppdHRlcih3aWR0aCA9IDAuMixzaXplPTAuMDEpICsgIyMgb21pdHRlZCBhcyBpdCBtYWtlcyB0aGUgcGxvdCBtZXNzeQogIGdndGl0bGUoIkJveHBsb3Qgb2YgdGhlIHN5c3RvbGljIGJsb29kcHJlc3N1cmUgZm9yIGVhY2ggaGVhbHRoIGNhdGVnb3J5IikgKwogIHlsYWIoIlN5c3RvbGljIGJsb29kIHByZXNzdXJlIChtbUhnKSIpICsKICBzdGF0X3N1bW1hcnkoZnVuLnk9bWVhbiwgZ2VvbT0icG9pbnQiLCBzaGFwZT01LCBzaXplPTMsIGNvbG9yPSJibGFjayIsIGZpbGw9ImJsYWNrIikKYGBgCgpUaGlzIHBsb3QgaXMgbm90IGlkZWFsOyBpdCB3b3VsZCBiZSBmYXIgbW9yZSBpbnR1aXRpdmUgaWYKdGhlIGhlYWx0aCBjYXRlZ29yaWVzIHdlcmUgb3JkZXJlZCBwcm9wZXJseSAoaS5lLiwgUG9vciAtLT4gZXhjZWxsZW50KS4KSW4gYWRkaXRpb24sIHdlIG9ic2VydmUgYSBzaXh0aCAiY2F0ZWdvcnkiIG9mIE5BIHZhbHVlcy4KClRvIGdldCBhIG1vcmUgaW5mb3JtYXRpdmUgYW5kIGludHVpdGl2ZSB2aXN1YWxpemF0aW9uLCB5b3UgY2FuOgoKMS4gRmlsdGVyIG91dCBzdWJqZWN0cyB3aXRoIE5BIHZhbHVlcyBmb3IgYEhlYWx0aEdlbmAgb3IgYEJQU3lzMWAKMi4gU2V0IGBIZWFsdGhHZW5gIHRvIGEgZmFjdG9yIGFuZCByZWxldmVsIGl0IHRvIFBvb3IgLS0+IEV4Y2VsbGVudAoKKipIaW50OioqIFRoZSBzZWNvbmQgdGFzayBjYW4gYmUgYWNoaWV2ZWQgYnkgdXNpbmcgdGhlIGBtdXRhdGVgLApgYXMuZmFjdG9yYCBhbmQgYGZjdF9yZWxldmVsYCBmdW5jdGlvbnMuCgpgYGB7cn0KTkhBTkVTIDwtIE5IQU5FUyAlPiUKICBmaWx0ZXIoIWlzLm5hKEhlYWx0aEdlbiksIWlzLm5hKEJQU3lzMSkpICU+JQogIG11dGF0ZShIZWFsdGhHZW4gPSBhcy5mYWN0b3IoSGVhbHRoR2VuKSkgJT4lCiAgbXV0YXRlKEhlYWx0aEdlbiA9ZmN0X3JlbGV2ZWwoSGVhbHRoR2VuLGMoIlBvb3IiLCJGYWlyIiwiR29vZCIsIlZnb29kIiwiRXhjZWxsZW50IikpKQpgYGAKCmBgYHtyfQpOSEFORVMgJT4lCiAgZ2dwbG90KGFlcyh4PUhlYWx0aEdlbix5PUJQU3lzMSxmaWxsPUhlYWx0aEdlbikpICsKICBzY2FsZV9maWxsX2JyZXdlcihwYWxldHRlPSJSZEd5IikgKwogIHRoZW1lX2J3KCkgKwogIGdlb21fYm94cGxvdChvdXRsaWVyLnNoYXBlPU5BKSArCiAgZ2d0aXRsZSgiQm94cGxvdCBvZiB0aGUgc3lzdG9saWMgYmxvb2RwcmVzc3VyZSBmb3IgZWFjaCBoZWFsdGggY2F0ZWdvcnkiKSArCiAgeWxhYigiU3lzdG9saWMgYmxvb2QgcHJlc3N1cmUgKG1tSGcpIikgKwogIHN0YXRfc3VtbWFyeShmdW4ueT1tZWFuLCBnZW9tPSJwb2ludCIsIHNoYXBlPTUsIHNpemU9MywgY29sb3I9ImJsYWNrIiwgZmlsbD0iYmxhY2siKQpgYGAKCiMgQU5PVkEKClRvIHN0dWR5IGlmIHRoZSBvYnNlcnZlZCBkaWZmZXJlbmNlIGJldHdlZW4gdGhlCmF2ZXJhZ2Ugc3lzdG9saWMgYmxvb2QgcHJlc3N1cmUgdmFsdWVzIG9mIHRoZSBkaWZmZXJlbnQgaGVhbHRoIGdyb3VwcwphcmUgc2lnbmlmaWNhbnQsIHdlIG1heSBwZXJmb3JtIGFuIEFOT1ZBLgoKIyMgRm9ybXVsYXRlIG51bGwgYW5kIGFsdGVybmF0aXZlIGh5b3B0aGVzZXMKClRoZSBudWxsIGh5cG90aGVzaXMgb2YgQU5PVkEgc3RhdGVzIHRoYXQ6CiRIMCQ6IFRoZSBtZWFuIHN5c3RvbGljIGJsb29kIHByZXNzdXJlIGlzIGVxdWFsIGJldHdlZW4gdGhlIGRpZmZlcmVudCBoZWFsdGggZ3JvdXBzLgoKVGhlIGFsdGVybmF0aXZlIGh5cG90aGVzaXMgb2YgQU5PVkEgc3RhdGVzIHRoYXQ6CiRIQSQ6IFRoZSBtZWFuIHN5c3RvbGljIGJsb29kIHByZXNzdXJlIGZvciBhdCBsZWFzdCBvbmUgaGVhbHRoIGdyb3VwIGlzIGRpZmZlcmVudApmcm9tIHRoZSBtZWFuIHN5c3RvbGljIGJsb29kIHByZXNzdXJlIGluIGF0IGxlYXN0IG9uZSBvdGhlciBoZWFsdGggZ3JvdXAuCgojIyBDaGVjayB0aGUgYXNzdW1wdGlvbnMgZm9yIEFOT1ZBCgpCZWZvcmUgd2UgbWF5IHByb2NlZWQgd2l0aCB0aGUgYW5hbHlzaXMsIHdlIG11c3QgbWFrZSBzdXJlIHRoYXQgYWxsCmFzc3VtcHRpb25zIGZvciBBTk9WQSBhcmUgbWV0LiBBTk9WQSBoYXMgdGhyZWUgYXNzdW1wdGlvbnM6CgoxLiBUaGUgb2JzZXJ2YXRpb25zIGFyZSBpbmRlcGVuZGVudCBvZiBlYWNoIG90aGVyIChpbiBhbGwgZ3JvdXBzKQoyLiBUaGUgZGF0YSAoQlBTeXMxKSBtdXN0IGJlIG5vcm1hbGx5IGRpc3RyaWJ1dGVkIChpbiBhbGwgZ3JvdXBzKQozLiBUaGUgdmFyaWFiaWxpdHkgd2l0aGluIGFsbCBncm91cHMgaXMgc2ltaWxhcgoKIyMjIEFzc3VtcHRpb24gb2YgaW5kZXBlbmRlbmNlCgpUaGUgZmlyc3QgYXNzdW1wdGlvbiBpcyBtZXQ7IHRoZXJlIHNob3VkIGJlIG5vIHNwZWNpZmljIHBhdHR0ZXJucyBvZiBkZXBlbmRlbmNlLgoKIyMjIEFzc3VtcHRpb24gb2Ygbm9ybWFsaXR5CgpGb3IgdGhlIHNlY29uZCBhc3N1bXB0aW9uLCB3ZSBtdXN0IGNoZWNrIG5vcm1hbGl0eSBpbiBlYWNoIGdyb3VwLgoKYGBge3J9Ck5IQU5FUyAlPiUKICBnZ3Bsb3QoYWVzKHNhbXBsZT1CUFN5czEpKSArCiAgZ2VvbV9xcSgpICsKICBnZW9tX3FxX2xpbmUoKSArCiAgZmFjZXRfZ3JpZCh+SGVhbHRoR2VuKQpgYGAKClRoZSBkYXRhIGRvZXMgbm90IGFwcGVhciB0byBiZSBub3JtYWxseSBkaXN0cmlidXRlZCBmb3IKZWFjaCBncm91cC4gSXQgc2VlbXMgdG8gaGF2ZSBhIGhlYXZ5IHJpZ2h0IHRhaWwuIFdlIGNhbgpwZXJmb3JtIGEgbG9nIHRyYW5zZm9ybWF0aW9uIG9uIHRoZSBkYXRhLgoKYGBge3J9Ck5IQU5FUyAlPiUKICBtdXRhdGUoQlBTeXMxX2xvZyA9IGxvZyhCUFN5czEpKSAlPiUKICBnZ3Bsb3QoYWVzKHNhbXBsZT1CUFN5czFfbG9nKSkgKwogIGdlb21fcXEoKSArCiAgZ2VvbV9xcV9saW5lKCkgKwogIGZhY2V0X2dyaWQofkhlYWx0aEdlbikKYGBgCgpXaGlsZSB0aGUgbG9nIHRyYW5zZm9ybWF0aW9uIGltcHJvdmVkIHRoZSBkaXN0cmlidXRpb25zIHNvbWV3aGF0LAp0aGUgZGF0YSBzdGlsbCBkb2VzIG5vdCBhcHBlYXIgdG8gYmUgbm9ybWFsbHkgZGlzdHJpYnV0ZWQgZm9yCmVhY2ggZ3JvdXAuIEhvd2V2ZXIsIHdlIGRvIGhhdmUgYSB2ZXJ5IGxhcmdlIG51bWJlciBvZgpvYnNlcnZhdGlvbnMgcGVyIGdyb3VwOgoKYGBge3J9CiMjIENvdW50IHRoZSBudW1iZXIgb2Ygb2JzZXJ2YXRpb25zIHBlciB0cmVhdG1lbnQKTkhBTkVTICU+JQogIGNvdW50KEhlYWx0aEdlbikKYGBgCgpBcyBzdWNoLCB3ZSBtYXkgcmVseSBvbiB0aGUgY2VudGFsIGxpbWl0IHRoZW9yZW0uClJlbWVtYmVyLCB0aGUgY2VudGFsIGxpbWl0IHRoZW9yZW0gdGhhdCB3aGVuIHRoZSBudW1iZXIKb2Ygb2JzZXJ2YXRpb25zIGlzIHN1ZmZpY2llbnRseSBsYXJnZSAoaS5lLiA+MTAwKSwgd2UKd2lsbCBhc3N1bWUgdGhhdCB0aGUgZGlzdHJpYnV0aW9uIG9mIHRoZSBzYW1wbGUgbWVhbiB3aWxsCmFwcHJveGltYXRlIGEgbm9ybWFsIGRpc3RyaWJ1dGlvbiwgZXZlbiBpZiB0aGUgdW5kZXJseWluZwpkYXRhIGlzIG5vdCBub3JtYWxseSBkaXN0cmlidXRlZC4KCiMjIEFOT1ZBIG1vZGVsCgpgYGB7cn0KZml0IDwtIGxtKGxvZyhCUFN5czEpfkhlYWx0aEdlbiwgTkhBTkVTKQpmaXRfYW5vdmEgPC0gYW5vdmEoZml0KQpmaXRfYW5vdmEKcHJpbnQocGFzdGUoIk5vdC1yb3VuZGVkIHAtdmFsdWU6IiwgZml0X2Fub3ZhJGBQcig+RilgWzFdKSkKYGBgCgpUaGUgcC12YWx1ZSBvZiB0aGUgQU5PVkEgYW5hbHlzaXMgaXMgZXh0cmVtZWx5IHNpZ25pZmljYW50CihwLXZhbHVlID0gYHIgZm9ybWF0KGZpdF9hbm92YSQiUHIoPkYpIlsxXSxkaWdpdHM9NClgKSwKc28gd2UgcmVqZWN0IHRoZSBudWxsIGh5cG90aGVzaXMgdGhhdCB0aGUgbWVhbgplZ2cgbGVuZ3RoIGlzIGVxdWFsIGJldHdlZW4gdGhlIGRpZmZlcmVudCBiaXJkIHR5cGVzLgpXZSBjYW4gc2F5IHRoYXQgdGhlIG1lYW4gZWdnIGxlbmd0aCBpcyBzaWduaWZpY2FudGx5IGRpZmZlcmVudApiZXR3ZWVuIGF0IGxlYXN0IHR3byBiaXJkIHR5cGVzIG9uIHRoZSA1JSBzaWduaWZpY2FuY2UgbGV2ZWwuCgpCYXNlZCBvbiB0aGlzIGFuYWx5c2lzLCB3ZSBkbyBub3QgeWV0IGtub3cgYmV0d2VlbiB3aGljaCBwYXJ0aWN1bGFyCmJpcmQgdHlwZXMgdGhlcmUgaXMgYSBzaWduaWZpY2FudCBkaWZmZXJlbmNlLiBUbyBzdHVkeSB0aGlzLCB3ZSB3aWxsCnBlcmZyb20gdGhlIFR1Y2tleSBwb3N0LWhvYyBhbmFseXNpcy4KCiMjIFBvc3QtaG9jIGFuYWx5c2lzCgpgYGB7cixtZXNzYWdlPUZBTFNFfQpsaWJyYXJ5KG11bHRjb21wLCBxdWlldGx5ID0gVFJVRSkKbWNwIDwtIGdsaHQoZml0LCBsaW5mY3QgPSBtY3AoSGVhbHRoR2VuID0gIlR1a2V5IikpCnN1bW1hcnkobWNwKQpjb25maW50KG1jcCkKYGBgCgojIyBDb25jbHVzaW9uCgpXZSBoYXZlIGZvdW5kIGFuIGV4dHJlbWVseSBzaWduaWZpY2FudCBkZXBlbmRlbmNlIChwLXZhbHVlID0gYHIgZm9ybWF0KGZpdF9hbm92YSQiUHIoPkYpIlsxXSxkaWdpdHM9NClgKSwKYmV0d2VlbiB0aGUgbWVhbiBzeXN0b2xpYyBibG9vZCBwcmVzc3VyZSBhbmQgdGhlIGhlYWx0aCBncm91cApvbiB0aGUgZ2xvYmFsIDUlIHNpZ25pZmljYW5jZSBsZXZlbC4KClRoZSBtZWFuIGxvZ2FyaXRobSBvZiBzeXN0b2xpYyBibG9vZCBwcmVzc3VyZSBpbiB0aGUgc2VsZi1yZXBvcnRlZCBoZWFsdGgKY2F0ZWdvcnkgYFBvb3JgIGlzIHNpZ25pZmljYW50bHkgaGlnaGVyIGFzIGNvbXBhcmVkIHRocmVlIG90aGVyIGdyb3VwczoKCi0gdGhlIGBHb29kYCBncm91cCAoYWRqdXN0ZWQgcC12YWx1ZSA9IDwgMC4wMDEsIG1lYW4gZGlmZmVyZW5jZSA9IC0wLjAzNjc2MiBtbUhnLCA5NSUgQ0kgWy0wLjAzNDcyNTsgLTAuMDA3MTQyXSkKLSB0aGUgYFZnb29kYCBncm91cCAoYWRqdXN0ZWQgcC12YWx1ZSA9IDwgMC4wMDEsIG1lYW4gZGlmZmVyZW5jZSA9IC0wLjA1OTQxNSBtbUhnLCA5NSUgQ0kgWy0wLjA4NzM1MjsgLTAuMDMxNDc3XSkKLSB0aGUgYEV4Y2VsbGVudGAgZ3JvdXAgKGFkanVzdGVkIHAtdmFsdWUgPSA8IDAuMDAxLCBtZWFuIGRpZmZlcmVuY2UgPSAtMC4wNTk0MTUgbW1IZywgOTUlIENJIFstMC4wODUxNjQ7IC0wLjAyNTc4OV0pCgpUaGUgbWVhbiBsb2dhcml0aG0gb2YgIHN5c3RvbGljIGJsb29kIHByZXNzdXJlIGluIHRoZSBzZWxmLXJlcG9ydGVkIGhlYWx0aApjYXRlZ29yeSBgRmFpcmAgaXMgc2lnbmlmaWNhbnRseSBoaWdoZXIgYXMgY29tcGFyZWQgdGhyZWUgb3RoZXIgZ3JvdXBzOgoKLSB0aGUgYEdvb2RgIGdyb3VwIChhZGp1c3RlZCBwLXZhbHVlID0gMC4wMDMxNywgbWVhbiBkaWZmZXJlbmNlID0gLTAuMDIwOTM0ICBtbUhnLCA5NSUgQ0kgWy0wLjA2NDU0MjsgLTAuMDA4OTgyXSkKLSB0aGUgYFZnb29kYCBncm91cCAoYWRqdXN0ZWQgcC12YWx1ZSA9IDwgMC4wMDEsIG1lYW4gZGlmZmVyZW5jZSA9IC0wLjA0MzU4NyBtbUhnLCA5NSUgQ0kgWy0wLjA1NzY5MjsgLTAuMDI5NDgxXSkKLSB0aGUgYEV4Y2VsbGVudGAgZ3JvdXAgKGFkanVzdGVkIHAtdmFsdWUgPSA8IDAuMDAxLCBtZWFuIGRpZmZlcmVuY2UgPSAtMC4wMzk2NDggbW1IZywgOTUlIENJIFstMC4wNTY5NjM7IC0wLjAyMjMzM10pCgpUaGUgbWVhbiBsb2dhcml0aG0gb2Ygc3lzdG9saWMgYmxvb2QgcHJlc3N1cmUgaW4gdGhlIHNlbGYtcmVwb3J0ZWQgaGVhbHRoCmNhdGVnb3J5IGBHb29kYCBpcyBzaWduaWZpY2FudGx5IGhpZ2hlciBhcyBjb21wYXJlZCB0d28gb3RoZXIgZ3JvdXBzOgoKLSB0aGUgYFZnb29kYCBncm91cCAoYWRqdXN0ZWQgcC12YWx1ZSA9IDwgMC4wMDEsIG1lYW4gZGlmZmVyZW5jZSA9IC0wLjAyMjY1MyBtbUhnLCA5NSUgQ0kgWy0wLjAzMjg0MzsgLTAuMDEyNDYzXSkKLSB0aGUgYEV4Y2VsbGVudGAgZ3JvdXAgKGFkanVzdGVkIHAtdmFsdWUgPSAwLjAwMzYyLCBtZWFuIGRpZmZlcmVuY2UgPSAtMC4wMTg3MTQgbW1IZywgOTUlIENJIFstMC4wMzMwMjE7IC0wLjAwNDQwOF0pCgpXZSBkbyBub3QgZmluZCBlbm91Z2ggZXZpZGVuY2UgdG8gY2xhaW0gYSBkaWZmZXJlbmNlIGluIHN5c3RvbGljCmJsb29kIHByZXNzdXJlIGxldmVscyBiZXR3ZWVuIHRoZSBvdGhlciBncm91cHMuCgpOb3RlIHRoYXQgaW4gb3JkZXIgdG8gaW50ZXJwcmV0IHRoZSBvdXRjb21lcyBvbiB0aGUgb3JpZ2luYWwgc2NhbGUsCndlIHNob3VsZCBiYWNrdHJhbnNmb3JtIHRoZSBvdXRjb21lcyB3aXRoIHRoZSBgZXhwKClgIGZ1bmN0aW9ucwooaW50ZXJwcmV0YXRpb24gb24gdGhlIGdlb21ldHJpYyBtZWFuKS4K</div>
<div class="footer">
    <hr>
    This work is licensed under the <a href= "https://creativecommons.org/licenses/by-nc-sa/4.0">
    CC BY-NC-SA 4.0</a> licence.
</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("07_3_NHANES_sol.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
