<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Lieven Clement" />


<title>5. Statistical Inference</title>

<script src="site_libs/header-attrs-2.13/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">PSLS</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-chalkboard-teacher"></span>
     
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="01-intro.html">1. Introduction</a>
    </li>
    <li>
      <a href="02-concepts.html">2. Concepts</a>
    </li>
    <li>
      <a href="03-experimentalDesign.html">3. Experimental Design I</a>
    </li>
    <li>
      <a href="04-dataExploration.html">4. Data Exploration</a>
    </li>
    <li>
      <a href="05-statisticalInference.html">5.1 Statistical Inference 1</a>
    </li>
    <li>
      <a href="05-statisticalInference-twosampleT.html">5.2 Statistical Inference 2</a>
    </li>
    <li>
      <a href="06-linearRegression.html">6. Linear Regression</a>
    </li>
    <li>
      <a href="07-Anova.html">7. Analysis of Variance</a>
    </li>
    <li>
      <a href="08-MultipleRegression.html">8. Multiple Regression</a>
    </li>
    <li>
      <a href="08-MultipleRegression-SpecificDesigns.html">8.2 Multiple Regression: Factorial Designs</a>
    </li>
    <li>
      <a href="08-experimentalDesignII.html">8.3. Experimental Design II</a>
    </li>
    <li>
      <a href="08-experimentalDesignIII.html">8.4. Experimental Design II</a>
    </li>
    <li>
      <a href="09-NonparametericStatistics-WilcoxonMannWithney.html">9.1. Nonparametric Statistics 1</a>
    </li>
    <li>
      <a href="09-NonparametericStatistics-KruskalWallis.html">9.2. Nonparametric Statistics 2</a>
    </li>
    <li>
      <a href="10-categoricalDataAnalysis.html">10. Categorical Data Analysis</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-laptop"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="04_exercises.html">4. Data Exploration</a>
    </li>
    <li>
      <a href="05_exercises.html">5. Statistical inference</a>
    </li>
    <li>
      <a href="06_exercises.html">6. Simple linear regression</a>
    </li>
    <li>
      <a href="07_exercises.html">7. ANOVA</a>
    </li>
    <li>
      <a href="08_exercises.html">8. Multiple linear regression</a>
    </li>
    <li>
      <a href="09_exercises.html">9. Non-parametric statistics</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/statOmics/PSLS">
    <span class="fab fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://statomics.github.io/">statOmics</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">5. Statistical Inference</h1>
<h4 class="author">Lieven Clement</h4>
<h4 class="date">statOmics, Ghent University (<a
href="https://statomics.github.io"
class="uri">https://statomics.github.io</a>)</h4>

</div>


<p><a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a></p>
<div id="introduction" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<div id="population" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Population</h2>
<ul>
<li><p>The aim of a scientific study is to draw conclusions on the
general population.</p></li>
<li><p>Here, we study the effect of captopril on the blood pressure of
patients with hypertension.</p></li>
<li><p>We will collect data and we will model the data</p></li>
<li><p>Therefore, we always have to translate the research question into
an effect size that can be estimated with a model parameter or a
combination of model parameters.</p></li>
<li><p>e.g. the population mean <span
class="math display">\[E(X)=\mu\]</span></p></li>
<li><p>Does the blood pressure decreases on average after administering
captopril to patients with hypertension?</p></li>
</ul>
<hr />
</div>
<div id="overview" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Overview</h2>
<ul>
<li>Experimental Design &amp; Data Exploration</li>
<li>Point estimators (Estimation)</li>
<li>Interval estimators (Statistical inference)</li>
<li>Hypothesis tests (Statistical inference)</li>
</ul>
<hr />
</div>
</div>
<div id="experimental-design" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Experimental
Design</h1>
<ul>
<li>15 patients were drawn at random from the population of patients
with hypertension</li>
<li>pre-test/post-test design: the systolic and diasystolic blood
pressure are measured before and after administering captopril</li>
<li>Advantage: we can assess the effect of administering captopril on
the blood pressure for each individual patient.</li>
<li>Disadvantage?</li>
</ul>
<p><img src="05-statisticalInference_files/figure-html/pop2Samp2Pop-1.png" width="672" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="data-exploration-and-descriptive-statistics"
class="section level1" number="3">
<h1><span class="header-section-number">3</span> Data exploration and
Descriptive Statistics</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>captopril <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/GTPB/PSLS20/master/data/captopril.txt&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(captopril)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["id"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["SBPb"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["DBPb"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["SBPa"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["DBPa"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"210","3":"130","4":"201","5":"125"},{"1":"2","2":"169","3":"122","4":"165","5":"121"},{"1":"3","2":"187","3":"124","4":"166","5":"121"},{"1":"4","2":"160","3":"104","4":"157","5":"106"},{"1":"5","2":"167","3":"112","4":"147","5":"101"},{"1":"6","2":"176","3":"101","4":"145","5":"85"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(captopril)</span></code></pre></div>
<pre><code>       id            SBPb            DBPb            SBPa          DBPa      
 Min.   : 1.0   Min.   :146.0   Min.   : 98.0   Min.   :129   Min.   : 82.0  
 1st Qu.: 4.5   1st Qu.:163.5   1st Qu.:103.0   1st Qu.:146   1st Qu.: 98.0  
 Median : 8.0   Median :174.0   Median :112.0   Median :157   Median :103.0  
 Mean   : 8.0   Mean   :176.9   Mean   :112.3   Mean   :158   Mean   :103.1  
 3rd Qu.:11.5   3rd Qu.:192.5   3rd Qu.:121.5   3rd Qu.:168   3rd Qu.:108.0  
 Max.   :15.0   Max.   :210.0   Max.   :130.0   Max.   :201   Max.   :125.0  </code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>captoprilTidy <span class="ot">&lt;-</span> captopril <span class="sc">%&gt;%</span> <span class="fu">gather</span>(type, bp, <span class="sc">-</span>id)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>captoprilTidy <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize_at</span>(<span class="st">&quot;bp&quot;</span>, <span class="fu">list</span>(</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="sc">~</span> <span class="fu">mean</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> <span class="sc">~</span> <span class="fu">sd</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="cf">function</span>(x) {</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>      x <span class="sc">%&gt;%</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">is.na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">!</span><span class="st">`</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sum</span>()</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">se =</span> sd <span class="sc">/</span> <span class="fu">sqrt</span>(n))</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["type"],"name":[1],"type":["chr"],"align":["left"]},{"label":["mean"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sd"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["n"],"name":[4],"type":["int"],"align":["right"]},{"label":["se"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"DBPa","2":"103.0667","3":"12.55540","4":"15","5":"3.241791"},{"1":"DBPb","2":"112.3333","3":"10.47219","4":"15","5":"2.703907"},{"1":"SBPa","2":"158.0000","3":"20.00357","4":"15","5":"5.164900"},{"1":"SBPb","2":"176.9333","3":"20.56511","4":"15","5":"5.309889"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>captoprilTidy <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize_at</span>(<span class="st">&quot;bp&quot;</span>, <span class="fu">list</span>(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="sc">~</span> <span class="fu">mean</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> <span class="sc">~</span> <span class="fu">sd</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="cf">function</span>(x) {</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>      x <span class="sc">%&gt;%</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">is.na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">!</span><span class="st">`</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sum</span>()</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">se =</span> sd <span class="sc">/</span> <span class="fu">sqrt</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> type, <span class="at">y =</span> mean)) <span class="sc">+</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean <span class="sc">-</span> se, <span class="at">ymax =</span> mean <span class="sc">+</span> se), <span class="at">width =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">210</span>) <span class="sc">+</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;blood pressure (mmHg)&quot;</span>)</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<ul>
<li>This figure is not informative! It does not show the raw data.</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>captoprilTidy <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> type, <span class="at">y =</span> bp)) <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">&quot;jitter&quot;</span>) <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">210</span>)</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>We see that a lot of the space that was taken by the barplot does not
contain data!</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>captoprilTidy <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> type, <span class="at">y =</span> bp)) <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">&quot;jitter&quot;</span>)</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<ul>
<li><p>This plot would have been informative if the data was gathered on
different individuals.</p></li>
<li><p>However, the blood pressures are measured op the same
subject!</p></li>
<li><p>We will make a plot by filtering the systolic blood
pressures</p></li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>captoprilTidy <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;SBPa&quot;</span>, <span class="st">&quot;SBPb&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">factor</span>(type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;SBPb&quot;</span>, <span class="st">&quot;SBPa&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> type, <span class="at">y =</span> bp)) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> id)) <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<ul>
<li>We have paired data. So we might estimate the effect of the
treatment directly by comparing the blood pressure after treatment to
the blood pressure before the treatment.</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>captopril<span class="sc">$</span>deltaSBP <span class="ot">&lt;-</span> captopril<span class="sc">$</span>SBPa <span class="sc">-</span> captopril<span class="sc">$</span>SBPb</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>captopril <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">&quot;Systolic blood pressure&quot;</span>, <span class="at">y =</span> deltaSBP)) <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">&quot;jitter&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Difference (mm mercury)&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>captopril <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize_at</span>(<span class="st">&quot;deltaSBP&quot;</span>, <span class="fu">list</span>(</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="sc">~</span> <span class="fu">mean</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> <span class="sc">~</span> <span class="fu">sd</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="cf">function</span>(x) {</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>      x <span class="sc">%&gt;%</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">is.na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">!</span><span class="st">`</span>() <span class="sc">%&gt;%</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sum</span>()</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">se =</span> sd <span class="sc">/</span> <span class="fu">sqrt</span>(n))</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["mean"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["sd"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["n"],"name":[3],"type":["int"],"align":["right"]},{"label":["se"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"-18.93333","2":"9.027471","3":"15","4":"2.330883"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<ul>
<li><p>Pre-test/post-test design: Effect of captopril in sample using
<span
class="math inline">\(X=\Delta_\text{after-before}\)</span>!</p></li>
<li><p>How will we model <span
class="math inline">\(X=\Delta_\text{after-na}\)</span> and estimate the
effect of captopril?</p></li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>captopril <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample =</span> deltaSBP)) <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>()</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>The systolic blood pressure differences are approximately normally
distributed.</p>
<hr />
</div>
<div id="estimation" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Estimation</h1>
<ul>
<li><p>No substantial deviations from normality</p></li>
<li><p>We can assume that the differences <span class="math inline">\(X
\sim N(\mu, \sigma^2)\)</span>.</p></li>
<li><p>Effect of captopril in the population is captured by the average
blood pressure difference <span
class="math inline">\(\mu\)</span>.</p></li>
<li><p>The average blood pressure <span
class="math inline">\(\mu\)</span> in the population can be estimated
using the sample mean <span class="math inline">\(\bar
x\)</span>=-18.93</p></li>
<li><p>The standard deviation <span
class="math inline">\(\sigma\)</span> with the sample standard deviation
<span class="math inline">\(\text{S}\)</span>=9.03.</p></li>
<li><p>Is the effect that we observe in the sample large enough to
conclude that there is an effect of the captopril treatment on the blood
pressure at population level?</p></li>
<li><p>Our estimates will change from sample to sample!</p></li>
<li><p>How are the estimators <span class="math inline">\(\bar
X\)</span> and <span class="math inline">\(S\)</span>
distributed?</p></li>
</ul>
<div id="point-estimator-the-sample-mean" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Point estimator the
sample mean</h2>
<ul>
<li><p>Suppose that <span class="math inline">\(X\)</span> is a random
sample from the population and assume that <span class="math inline">\(X
\sim N(\mu,\sigma^2)\)</span></p></li>
<li><p>Estimate <span class="math inline">\(\mu\)</span> based on sample
<span class="math inline">\(X_1,...,X_n\)</span>, using the sample mean
<span class="math display">\[\bar X = \frac{X_1+ X_2+ ... + X_n}{n} =
\frac{\sum_{i=1}^{n} X_i}{n}\]</span> of random variables <span
class="math inline">\(X_1,X_2, ..., X_n\)</span>.</p></li>
<li><p>Sample mean <span class="math inline">\(\bar X\)</span> is a
random variable that varies from sample to sample</p></li>
<li><p>Study the theoretical distribution of the sample mean to get
insight</p>
<ol style="list-style-type: decimal">
<li>in how the sample mean can vary in a new similar study</li>
<li>how far <span class="math inline">\(\bar X\)</span> can be from the
population mean <span class="math inline">\(\mu\)</span></li>
</ol></li>
</ul>
<hr />
<div id="overview-1" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Overview</h3>
<ol style="list-style-type: decimal">
<li>The sample mean is unbiased</li>
<li>Precision of sample mean</li>
<li>Distribution of sample mean</li>
</ol>
<hr />
</div>
<div id="the-sample-mean-is-unbiased" class="section level3"
number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> The sample mean is
unbiased</h3>
<ul>
<li><p>We can generalize our observations based on the sample towards
the population if the estimate is good approximation of the population
value.</p></li>
<li><p>A representative sample is required to generalize the results
from the sample towards the population</p></li>
<li><p>Avoid bias (so that the population mean is not systematically
under or overestimated)</p></li>
<li><p>Report how the sample is taken!</p></li>
<li><p>Randomisation!</p></li>
<li><p>Draw the subjects at random from population so every subject has
the same probability to end up in the sample.</p></li>
<li><p>Subjects with hypertension are sampled at random from the
population</p></li>
<li><p>Simple random sample: <span
class="math inline">\(X_1,...,X_n\)</span> for characteristic <span
class="math inline">\(X\)</span></p></li>
<li><p><span class="math inline">\(X_1,...,X_n\)</span> have same
distribution</p></li>
<li><p>They have same mean <span class="math inline">\(\mu\)</span> and
variance <span class="math inline">\(\sigma^2\)</span></p></li>
<li><p><span class="math inline">\(E(X_1)=...=E(X_n)=\mu\)</span> and
<span
class="math inline">\(\text{Var}(X_1)=...=\text{Var}(X_n)=\sigma^2\)</span></p></li>
<li><p><span class="math inline">\(\bar X\)</span> is an <em>unbiased
estimator</em> for <span class="math inline">\(\mu\)</span></p></li>
</ul>
<details>
<summary>
Click to see proof
</summary>
<p>
<span class="math display">\[\begin{eqnarray*}
E(\bar X) &amp;=&amp; E \left(\frac{X_1+ X_2+ ... + X_n}{n}\right) \\
&amp;= &amp; \frac{E(X_1)+ E(X_2)+ ... + E(X_n)}{n} \\
&amp;=&amp; \frac{\mu + \mu + ... +\mu}{n} \\
&amp;= &amp; \mu
\end{eqnarray*}\]</span>
</p>
</details>
<hr />
</div>
<div id="imprecisionstandard-error" class="section level3"
number="4.1.3">
<h3><span class="header-section-number">4.1.3</span>
Imprecision/standard error</h3>
<ul>
<li><p>Also for representative samples the results are imprecise.
</p></li>
<li><p>Different samples from the same population give different
results.</p></li>
<li><p>We illustrated this by using the NHANES</p>
<ul>
<li>We will draw 15 females at random from the NHANES study and we will
register their log2 direct cholesterol values</li>
<li>We repeat this 50 times to assess the variation from sample to
sample</li>
<li>We will plot the boxplot for each sample and will indicate the
mean</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(NHANES)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>fem <span class="ot">&lt;-</span> NHANES <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Gender <span class="sc">==</span> <span class="st">&quot;female&quot;</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(DirectChol)) <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">&quot;DirectChol&quot;</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">15</span> <span class="co"># number of subjects per sample</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>nSim <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="co"># number of simulations</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>femSamp <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> n, <span class="at">ncol =</span> nSim)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nSim)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  femSamp[, j] <span class="ot">&lt;-</span> <span class="fu">sample</span>(fem<span class="sc">$</span>DirectChol, <span class="dv">15</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (j <span class="sc">&lt;</span> <span class="dv">4</span>) {</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> femSamp <span class="sc">%&gt;%</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">log2</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">gather</span>(<span class="st">&quot;sample&quot;</span>, <span class="st">&quot;log2cholesterol&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sample, <span class="at">y =</span> log2cholesterol)) <span class="sc">+</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">shape =</span> <span class="dv">19</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(fem<span class="sc">$</span>DirectChol <span class="sc">%&gt;%</span> <span class="fu">log2</span>())) <span class="sc">+</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ylab</span>(<span class="st">&quot;cholesterol (log2)&quot;</span>)</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(p)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-10-1.png" width="672" /><img src="05-statisticalInference_files/figure-html/unnamed-chunk-10-2.png" width="672" /><img src="05-statisticalInference_files/figure-html/unnamed-chunk-10-3.png" width="672" /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>femSamp <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log2</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="st">&quot;sample&quot;</span>, <span class="st">&quot;log2cholesterol&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sample, <span class="at">y =</span> log2cholesterol)) <span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">shape =</span> <span class="dv">19</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(fem<span class="sc">$</span>DirectChol <span class="sc">%&gt;%</span> <span class="fu">log2</span>())) <span class="sc">+</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;cholesterol (log2)&quot;</span>)</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-10-4.png" width="672" /></p>
<p>We observe that the mean nicely fluctuates around the population
mean.</p>
<p>Copy the code, increase the sample size to 100 subjects and observe
what happens!</p>
<hr />
</div>
<div id="how-to-do-this-based-on-a-single-sample" class="section level3"
number="4.1.4">
<h3><span class="header-section-number">4.1.4</span> How to do this
based on a single sample?</h3>
<ul>
<li><p>Insight in how close we can expect <span
class="math inline">\(\bar X\)</span> to <span
class="math inline">\(\mu\)</span>?</p></li>
<li><p>How varies <span class="math inline">\(\bar X\)</span> from
sample to sample?</p></li>
<li><p>Variability on <span class="math inline">\(\bar
X\)</span></p></li>
<li><p>We have to determine this based on a single sample!</p></li>
<li><p>We need to make assumptions</p></li>
<li><p>We assume that the random variables <span
class="math inline">\(X_1, X_2, ..., X_n\)</span> originate from <span
class="math inline">\(n\)</span> <em>independent</em> subjects.</p></li>
<li><p>For the captopril study we had dependent observations.</p>
<ul>
<li>Blood pressure measurements before (<span
class="math inline">\(Y_{i,before}\)</span>) and after (<span
class="math inline">\(Y_{i,after}\)</span>) administering captopril for
the same subject <span class="math inline">\(i=1,\ldots,n\)</span>.</li>
<li>We turned them into n independent measurements by taking the
difference <span
class="math inline">\(Y_{i,after}-Y_{i,before}\)</span></li>
</ul></li>
</ul>
<hr />
</div>
<div id="variance-estimator-for-bar-x" class="section level3"
number="4.1.5">
<h3><span class="header-section-number">4.1.5</span> Variance estimator
for <span class="math inline">\(\bar X\)</span></h3>
<p><span class="math display">\[\sigma^2_{\bar
X}=\frac{\sigma^2}{n}\]</span></p>
<ul>
<li><p>The standard deviation of <span class="math inline">\(\bar
X\)</span> around <span class="math inline">\(\mu\)</span> is <span
class="math inline">\(\sqrt{n}\)</span> times smaller that the deviation
around the original observations <span
class="math inline">\(X\)</span>.</p></li>
<li><p>The more observations we have the more precise <span
class="math inline">\(\bar X\)</span>.</p></li>
</ul>
<details>
<summary>
Click to see proof
</summary>
<p>
<p><span class="math display">\[\begin{eqnarray*}
\text{Var}(\bar X)&amp;=&amp;\text{Var} \left(\frac{X_1+ X_2+ ... +
X_n}{n}\right) \\
&amp;= &amp; \frac{\text{Var} (X_1+ X_2+ ... + X_n)}{n^2} \\
&amp;\overset{*}{=} &amp; \frac{\text{Var}(X_1)+ \text{Var}(X_2)+ ... +
\text{Var}(X_n)}{n^2} \\
&amp;=&amp; \frac{\sigma^2 + \sigma^2 + ... \sigma^2}{n^2} \\
&amp;= &amp; \frac{\sigma^2}{n}.
\end{eqnarray*}\]</span></p>
<ul>
<li><p>(*) this is based on the assumption of independence. <span
class="math display">\[\text{Var}[X_1 + X_2] = \text{Var}[X_1] +
\text{Var}[X_2] + 2 \text{Covar}[X_1,X_2]\]</span></p>
<ul>
<li>With <span class="math inline">\(Covar[X_1,X_2]=0\)</span> when
<span class="math inline">\(X_1\)</span> and <span
class="math inline">\(X_2\)</span> are independent.</li>
</ul></li>
</ul>
</p>
</details>
<p><strong>Definition: standard error</strong></p>
<p>The standard deviation of <span
class="math inline">\(\bar{X}\)</span> is <span
class="math inline">\(\sigma/\sqrt{n}\)</span> and is also referred to
as the <strong>standard error</strong> of the mean. Generally one refers
to the standard deviation of an estimator for a particular parameter
<span class="math inline">\(\theta\)</span> with the term
<strong>standard error</strong> of the estimator, which is denoted as
<span class="math inline">\(SE\)</span>.</p>
<hr />
</div>
<div id="captopril-example" class="section level3" number="4.1.6">
<h3><span class="header-section-number">4.1.6</span> Captopril
example</h3>
<ul>
<li><p><span class="math inline">\(n = 15\)</span> differences in
systolic blood pressure</p></li>
<li><p>Suppose that the standard deviation of the blood pressure
differences in the population is <span class="math inline">\(\sigma =
9.0\)</span> mmHg</p></li>
<li><p>Then, the standard error (SE) on the average systolic blood
pressure differs <span class="math inline">\(\bar X\)</span>
becomes:</p></li>
</ul>
<p><span class="math display">\[
SE= \frac{9.0}{\sqrt{15}}=2.32\text{mmHg.}
\]</span></p>
<ul>
<li><p>Generally <span class="math inline">\(\sigma\)</span>, and thus
the SE on the sample mean are unknown.</p></li>
<li><p>So we also have to estimate the standard deviation of the sample
to obtain the standard error</p></li>
<li><p>Estimator: <span
class="math inline">\(SE=S/\sqrt{n},\)</span></p></li>
<li><p>with <span class="math inline">\(S^2\)</span> the sample variance
of <span class="math inline">\(X_1,...,X_n\)</span> and <span
class="math inline">\(S\)</span> the sample standard deviation</p></li>
<li><p>For the captopril example we obtain:</p></li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(captopril<span class="sc">$</span>deltaSBP)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sd</span>(captopril<span class="sc">$</span>deltaSBP) <span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>se</span></code></pre></div>
<pre><code>[1] 2.330883</code></pre>
<hr />
</div>
<div id="standard-deviation-vs-standard-error" class="section level3"
number="4.1.7">
<h3><span class="header-section-number">4.1.7</span> Standard deviation
vs standard error</h3>
<div id="illustrate-via-repeated-sampling" class="section level4"
number="4.1.7.1">
<h4><span class="header-section-number">4.1.7.1</span> Illustrate via
repeated sampling</h4>
<ul>
<li><p>Different sample sizes: 10, 50, 100</p></li>
<li><p>Draw 1000 samples per sample size from the NHANES study, for each
sample we calculate</p>
<ul>
<li>The mean</li>
<li>The sample standard deviation</li>
<li>The standard error</li>
</ul></li>
<li><p>We make a boxplot of the sample standard deviations and the
standard errors for the different sample sizes</p></li>
<li><p>Instead of using a for loop we will use the sapply function which
is more efficient. It takes a vector or a list as input and applies a
function on each element of the vector or on each list element.</p></li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>femSamp10 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>, <span class="cf">function</span>(j, x, size) <span class="fu">sample</span>(x, size), <span class="at">size =</span> <span class="dv">10</span>, <span class="at">x =</span> fem<span class="sc">$</span>DirectChol)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>femSamp50 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>, <span class="cf">function</span>(j, x, size) <span class="fu">sample</span>(x, size), <span class="at">size =</span> <span class="dv">50</span>, <span class="at">x =</span> fem<span class="sc">$</span>DirectChol)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>femSamp100 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>, <span class="cf">function</span>(j, x, size) <span class="fu">sample</span>(x, size), <span class="at">size =</span> <span class="dv">100</span>, <span class="at">x =</span> fem<span class="sc">$</span>DirectChol)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  femSamp10 <span class="sc">%&gt;%</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">log2</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(sample, log2Chol) <span class="sc">%&gt;%</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(sample) <span class="sc">%&gt;%</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize_at</span>(</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;log2Chol&quot;</span>,</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">median =</span> <span class="sc">~</span> <span class="fu">median</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">mean =</span> <span class="sc">~</span> <span class="fu">mean</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">sd =</span> <span class="sc">~</span> <span class="fu">sd</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">n =</span> <span class="cf">function</span>(x) {</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>          x <span class="sc">%&gt;%</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">is.na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">!</span><span class="st">`</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>            <span class="fu">sum</span>()</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">se =</span> sd <span class="sc">/</span> <span class="fu">sqrt</span>(n)),</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>  femSamp50 <span class="sc">%&gt;%</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">log2</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(sample, log2Chol) <span class="sc">%&gt;%</span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(sample) <span class="sc">%&gt;%</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize_at</span>(</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;log2Chol&quot;</span>,</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">median =</span> <span class="sc">~</span> <span class="fu">median</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">mean =</span> <span class="sc">~</span> <span class="fu">mean</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">sd =</span> <span class="sc">~</span> <span class="fu">sd</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">n =</span> <span class="cf">function</span>(x) {</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>          x <span class="sc">%&gt;%</span></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>            <span class="fu">is.na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">!</span><span class="st">`</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>            <span class="fu">sum</span>()</span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">se =</span> sd <span class="sc">/</span> <span class="fu">sqrt</span>(n)),</span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>  femSamp100 <span class="sc">%&gt;%</span></span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">log2</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(sample, log2Chol) <span class="sc">%&gt;%</span></span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(sample) <span class="sc">%&gt;%</span></span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize_at</span>(</span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;log2Chol&quot;</span>,</span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(</span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">median =</span> <span class="sc">~</span> <span class="fu">median</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">mean =</span> <span class="sc">~</span> <span class="fu">mean</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">sd =</span> <span class="sc">~</span> <span class="fu">sd</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">n =</span> <span class="cf">function</span>(x) {</span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a>          x <span class="sc">%&gt;%</span></span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a>            <span class="fu">is.na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">!</span><span class="st">`</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a>            <span class="fu">sum</span>()</span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">se =</span> sd <span class="sc">/</span> <span class="fu">sqrt</span>(n))</span>
<span id="cb16-68"><a href="#cb16-68" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div id="means" class="section level5" number="4.1.7.1.1">
<h5><span class="header-section-number">4.1.7.1.1</span> Means</h5>
<p>We first illustrate the impact of sample size on the distribution of
the means of the different samples</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n <span class="sc">%&gt;%</span> <span class="fu">as.factor</span>(), <span class="at">y =</span> mean)) <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Direct cholesterol (log2)&quot;</span>) <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;sample size&quot;</span>)</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<ul>
<li>Note, that the variation of the sample means indeed reduces as the
sample size increases. So the estimation gets more precise with
increasing sample size.</li>
</ul>
<hr />
</div>
<div id="standard-deviation" class="section level5" number="4.1.7.1.2">
<h5><span class="header-section-number">4.1.7.1.2</span> Standard
deviation</h5>
<p>We now illustrate the impact of sample size on the distribution of
the standard deviation of the different samples</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n <span class="sc">%&gt;%</span> <span class="fu">as.factor</span>(), <span class="at">y =</span> sd)) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;standard deviation&quot;</span>) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;sample size&quot;</span>)</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<ul>
<li><p>The standard deviation remains similar across sample size. It is
centred around the same value: the standard deviation in the population.
Indeed increasing the sample size does affect the variability in the
population!</p></li>
<li><p>Again we see that the variability of the standard deviation
reduces with increasing sample size. So the standard deviation can also
be estimated more precise with increasing sample size.</p></li>
</ul>
<hr />
</div>
<div id="standard-error-on-the-mean" class="section level5"
number="4.1.7.1.3">
<h5><span class="header-section-number">4.1.7.1.3</span> Standard error
on the mean</h5>
<p>Finally, we illustrate the impact of sample size on the distribution
of the standard deviation on the mean of the different samples</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n <span class="sc">%&gt;%</span> <span class="fu">as.factor</span>(), <span class="at">y =</span> se)) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;standard error&quot;</span>) <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;sample size&quot;</span>)</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<ul>
<li>The standard error, the estimator for the precision of the sample
mean, however, reduces considerably with increasing sample size again
confirming that the estimation of the sample mean gets more
precise.</li>
</ul>
<hr />
</div>
</div>
</div>
<div id="normally-distributed-data" class="section level3"
number="4.1.8">
<h3><span class="header-section-number">4.1.8</span> Normally
distributed data</h3>
<ul>
<li><p>For normally distributed data we have multiple estimators for the
population mean <span class="math inline">\(\mu\)</span> e.g mean and
median.</p></li>
<li><p>But, <span class="math inline">\(\bar{X}\)</span> is the unbiased
estimator of <span class="math inline">\(\mu\)</span> with the smallest
standard error</p></li>
<li><p><span class="math inline">\(\bar{X}\)</span> deviates less from
the mean <span class="math inline">\(\mu\)</span> than the
median</p></li>
<li><p>We illustrate this for repeated sampling with sample size
10</p></li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">==</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(mean, median) <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(type, estimate) <span class="sc">%&gt;%</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> type, <span class="at">y =</span> estimate)) <span class="sc">+</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> fem<span class="sc">$</span>DirectChol <span class="sc">%&gt;%</span> <span class="fu">log2</span>() <span class="sc">%&gt;%</span> <span class="fu">mean</span>()) <span class="sc">+</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;10 subjects&quot;</span>)</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>Next, we compare the distribution of mean and median in repeated
samples of sample size 50.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">==</span> <span class="dv">50</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(mean, median) <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(type, estimate) <span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> type, <span class="at">y =</span> estimate)) <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> fem<span class="sc">$</span>DirectChol <span class="sc">%&gt;%</span> <span class="fu">log2</span>() <span class="sc">%&gt;%</span> <span class="fu">mean</span>()) <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;50 subjects&quot;</span>)</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>
<div id="distribution-of-sample-mean" class="section level3"
number="4.1.9">
<h3><span class="header-section-number">4.1.9</span> Distribution of
sample mean</h3>
<ul>
<li>How varies <span class="math inline">\(\bar X\)</span> from sample
to sample?</li>
<li>Distribution of <span class="math inline">\(\bar X\)</span>?</li>
<li>If <span class="math inline">\(\bar X\)</span> is normally
distributed the standard error has a good interpretation: the s.e. is
the standard deviation of the sample mean.</li>
<li>If the data <span class="math inline">\(X_i\)</span> are normally
distributed, the sample mean is also normally distributed.</li>
</ul>
<p><span class="math display">\[X_i \sim N(\mu,\sigma^2)
\rightarrow  \bar X \sim N(\mu,  \sigma^2/n)\]</span></p>
<hr />
<div id="nhanes-cholesterol" class="section level4" number="4.1.9.1">
<h4><span class="header-section-number">4.1.9.1</span> NHANES:
cholesterol</h4>
<p>We illustrate this again with simulation using the NHANES study. The
log2 cholesterol levels were normally distributed.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>fem <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> DirectChol <span class="sc">%&gt;%</span> <span class="fu">log2</span>())) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density.., <span class="at">fill =</span> ..count..)) <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Direct cholesterol (log2)&quot;</span>) <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(fem<span class="sc">$</span>DirectChol <span class="sc">%&gt;%</span> <span class="fu">log2</span>()), <span class="at">sd =</span> <span class="fu">sd</span>(fem<span class="sc">$</span>DirectChol <span class="sc">%&gt;%</span> <span class="fu">log2</span>()))) <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;All females in Nhanes study&quot;</span>)</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>fem <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample =</span> DirectChol <span class="sc">%&gt;%</span> <span class="fu">log2</span>())) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;All females in Nhanes study&quot;</span>)</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-18-2.png" width="672" /></p>
<hr />
<div id="evaluate-distribution-for-samples-with-5-subjects"
class="section level5" number="4.1.9.1.1">
<h5><span class="header-section-number">4.1.9.1.1</span> Evaluate
distribution for samples with 5 subjects</h5>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>femSamp5 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>, <span class="cf">function</span>(j, x, size) {</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample</span>(x, size)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>}, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">x =</span> fem<span class="sc">$</span>DirectChol)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>femSamp5[, <span class="dv">1</span>] <span class="sc">%&gt;%</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log2</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .)) <span class="sc">+</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density.., <span class="at">fill =</span> ..count..), <span class="at">bins =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Direct cholesterol (log2)&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> femSamp5[, <span class="dv">1</span>] <span class="sc">%&gt;%</span> <span class="fu">log2</span>() <span class="sc">%&gt;%</span> <span class="fu">mean</span>(), <span class="at">sd =</span> femSamp5[, <span class="dv">1</span>] <span class="sc">%&gt;%</span> <span class="fu">log2</span>() <span class="sc">%&gt;%</span> <span class="fu">sd</span>())) <span class="sc">+</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;5 random females&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(fem<span class="sc">$</span>DirectChol <span class="sc">%&gt;%</span> <span class="fu">log2</span>() <span class="sc">%&gt;%</span> <span class="fu">range</span>())</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>femSamp5 <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log2</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colMeans</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .)) <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density.., <span class="at">fill =</span> ..count..), <span class="at">bins =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Mean cholesterol (log2)&quot;</span>) <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> femSamp5 <span class="sc">%&gt;%</span> <span class="fu">log2</span>() <span class="sc">%&gt;%</span> <span class="fu">colMeans</span>() <span class="sc">%&gt;%</span> <span class="fu">mean</span>(), <span class="at">sd =</span> femSamp5 <span class="sc">%&gt;%</span> <span class="fu">log2</span>() <span class="sc">%&gt;%</span> <span class="fu">colMeans</span>() <span class="sc">%&gt;%</span> <span class="fu">sd</span>())) <span class="sc">+</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Means on 5 females&quot;</span>)</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-19-2.png" width="672" /></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>femSamp5 <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log2</span>() <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colMeans</span>() <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample =</span> .)) <span class="sc">+</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Means on 5 females&quot;</span>)</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-19-3.png" width="672" /></p>
<hr />
</div>
<div id="explore-the-distribution-of-the-mean-for-samples-of-size-10"
class="section level5" number="4.1.9.1.2">
<h5><span class="header-section-number">4.1.9.1.2</span> Explore the
distribution of the mean for samples of size 10</h5>
<p>Now we explore the results for the sample size of 10.</p>
<p>We first illustrate the plot for the first sample.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>femSamp10[, <span class="dv">1</span>] <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log2</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .)) <span class="sc">+</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density.., <span class="at">fill =</span> ..count..), <span class="at">bins =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Direct cholesterol (log2)&quot;</span>) <span class="sc">+</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> femSamp10[, <span class="dv">1</span>] <span class="sc">%&gt;%</span> <span class="fu">log2</span>() <span class="sc">%&gt;%</span> <span class="fu">mean</span>(), <span class="at">sd =</span> femSamp10[, <span class="dv">1</span>] <span class="sc">%&gt;%</span> <span class="fu">log2</span>() <span class="sc">%&gt;%</span> <span class="fu">sd</span>())) <span class="sc">+</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;10 random females&quot;</span>) <span class="sc">+</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(fem<span class="sc">$</span>DirectChol <span class="sc">%&gt;%</span> <span class="fu">log2</span>() <span class="sc">%&gt;%</span> <span class="fu">range</span>())</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>Next we look at the distribution of the sample mean over 1000 samples
of sample size 10.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>femSamp10 <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log2</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colMeans</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .)) <span class="sc">+</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density.., <span class="at">fill =</span> ..count..), <span class="at">bins =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Mean cholesterol (log2)&quot;</span>) <span class="sc">+</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> femSamp10 <span class="sc">%&gt;%</span> <span class="fu">log2</span>() <span class="sc">%&gt;%</span> <span class="fu">colMeans</span>() <span class="sc">%&gt;%</span> <span class="fu">mean</span>(), <span class="at">sd =</span> femSamp10 <span class="sc">%&gt;%</span> <span class="fu">log2</span>() <span class="sc">%&gt;%</span> <span class="fu">colMeans</span>() <span class="sc">%&gt;%</span> <span class="fu">sd</span>())) <span class="sc">+</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Means on 10 females&quot;</span>)</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>femSamp10 <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log2</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colMeans</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample =</span> .)) <span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Means on 10 females&quot;</span>)</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-21-2.png" width="672" /></p>
<p><strong>So we confirmed that the mean is approximately normally
distributed for studies with 5 and 10 females when the original data are
approximately normally distributed.</strong></p>
<hr />
</div>
</div>
<div id="captopril-study" class="section level4" number="4.1.9.2">
<h4><span class="header-section-number">4.1.9.2</span> Captopril
study</h4>
<ul>
<li><p>For Captopril study the systolic blood pressure differences are
approximatively normally distributed.</p></li>
<li><p>s.e.= 2.32 mm Hg</p></li>
<li><p>In 95 out of 100 studies with n = 15 subjects we expect the
sample mean of the systolic blood pressure differences (<span
class="math inline">\(\bar X\)</span>) on less then <span
class="math inline">\(2 \times 2.32 = 4.64\)</span>mm Hg of the real
population mean of the blood pressure differences (<span
class="math inline">\(\mu\)</span>).</p></li>
</ul>
<hr />
</div>
</div>
<div id="non-normally-distributed-data" class="section level3"
number="4.1.10">
<h3><span class="header-section-number">4.1.10</span> Non-normally
distributed data</h3>
<ul>
<li><p>When individual observations do not have a normal distribution,
<span class="math inline">\(\bar X\)</span> is still Normally
distributed when the number observations are large enough.</p></li>
<li><p>How large does the sample needs to be for the Normal
approximation to work?</p></li>
<li><p>This depends on the skewness of the distribution!</p></li>
</ul>
<hr />
<div id="nhanes-cholesterol-1" class="section level4" number="4.1.10.1">
<h4><span class="header-section-number">4.1.10.1</span> NHANES:
cholesterol</h4>
<ul>
<li>When can evaluated this in the NHanes study if we do not log2
transform the data.</li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>fem <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> DirectChol)) <span class="sc">+</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density.., <span class="at">fill =</span> ..count..)) <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Direct cholesterol&quot;</span>) <span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(fem<span class="sc">$</span>DirectChol), <span class="at">sd =</span> <span class="fu">sd</span>(fem<span class="sc">$</span>DirectChol))) <span class="sc">+</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;All females in Nhanes study&quot;</span>)</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>fem <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample =</span> DirectChol)) <span class="sc">+</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;All females in Nhanes study&quot;</span>)</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-22-2.png" width="672" /></p>
<p>The cholesterol data is clearly non-Normally distributed.</p>
<div id="distribution-of-the-sample-mean-for-different-sample-sizes"
class="section level5" number="4.1.10.1.1">
<h5><span class="header-section-number">4.1.10.1.1</span> Distribution
of the sample mean for different sample sizes</h5>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>femSamp5 <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colMeans</span>() <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .)) <span class="sc">+</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density.., <span class="at">fill =</span> ..count..), <span class="at">bins =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Mean cholesterol&quot;</span>) <span class="sc">+</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> femSamp5 <span class="sc">%&gt;%</span> <span class="fu">colMeans</span>() <span class="sc">%&gt;%</span> <span class="fu">mean</span>(), <span class="at">sd =</span> femSamp5 <span class="sc">%&gt;%</span> <span class="fu">colMeans</span>() <span class="sc">%&gt;%</span> <span class="fu">sd</span>())) <span class="sc">+</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Means on 5 females&quot;</span>)</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>femSamp5 <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colMeans</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample =</span> .)) <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Means on 5 females&quot;</span>)</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-23-2.png" width="672" /></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>femSamp10 <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colMeans</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .)) <span class="sc">+</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density.., <span class="at">fill =</span> ..count..), <span class="at">bins =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Mean cholesterol&quot;</span>) <span class="sc">+</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> femSamp10 <span class="sc">%&gt;%</span> <span class="fu">colMeans</span>() <span class="sc">%&gt;%</span> <span class="fu">mean</span>(), <span class="at">sd =</span> femSamp10 <span class="sc">%&gt;%</span> <span class="fu">colMeans</span>() <span class="sc">%&gt;%</span> <span class="fu">sd</span>())) <span class="sc">+</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Means on 10 females&quot;</span>)</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-23-3.png" width="672" /></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>femSamp10 <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colMeans</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample =</span> .)) <span class="sc">+</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Means on 10 females&quot;</span>)</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-23-4.png" width="672" /></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>femSamp50 <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colMeans</span>() <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample =</span> .)) <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Means on 50 females&quot;</span>)</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-23-5.png" width="672" /></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>femSamp100 <span class="sc">%&gt;%</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colMeans</span>() <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample =</span> .)) <span class="sc">+</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Means on 100 females&quot;</span>)</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-23-6.png" width="672" /></p>
<ul>
<li><p><strong>We observe that when the data are not normally
distributed the distribution of the sample mean is not normally
distributed in small samples</strong></p></li>
<li><p><strong>For large samples, however, the sample mean of non normal
data is still approximately normally distributed.</strong></p></li>
</ul>
<hr />
</div>
</div>
</div>
<div id="centrale-limit-theorem" class="section level3" number="4.1.11">
<h3><span class="header-section-number">4.1.11</span> Centrale Limit
Theorem</h3>
<p>Let <span class="math inline">\(X_1, \ldots, X_n\)</span> are
sequence of random variables that are drawn independently from the same
distribution (population). As long as the sample size n is sufficiently
large, the sample mean <span class="math inline">\(\bar X\)</span> is
approximately normally distributed, irrespective of the distribution of
the observations <span class="math inline">\(X_i\)</span>.</p>
</div>
<div id="overview-on-the-distribution-of-the-mean"
class="section level3" number="4.1.12">
<h3><span class="header-section-number">4.1.12</span> Overview on the
distribution of the mean</h3>
<p><embed src="https://www.nature.com/articles/nmeth.2613.pdf"
style="width:100.0%" /></p>
<hr />
</div>
</div>
</div>
<div id="interval-estimators" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Interval
estimators</h1>
<ul>
<li><p><span class="math inline">\(\bar X\)</span> varies around <span
class="math inline">\(\mu\)</span></p></li>
<li><p>Here we will develop an interval around <span
class="math inline">\(\bar X\)</span> that will contain the value of
<span class="math inline">\(\mu\)</span> with a probability of 95% for a
random sample.</p></li>
<li><p>We first assume <span class="math inline">\(\sigma^2\)</span> to
be known and we will later relax this assumption.</p></li>
</ul>
<hr />
<div id="normally-distributed-data-with-known-variance"
class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Normally distributed
data with known variance</h2>
<ul>
<li><p><span class="math inline">\(X\sim N(\mu,\sigma^2) \rightarrow
\bar X\sim N\left(\mu,\frac{\sigma^2}{n}\right)\)</span></p></li>
<li><p>95% reference-interval for sample mean</p></li>
</ul>
<p><span class="math display">\[\begin{equation*}
\left[\mu - 1.96 \frac{\sigma}{\sqrt{n}},\mu + 1.96
\frac{\sigma}{\sqrt{n}}%
\right]
\end{equation*}\]</span></p>
<ul>
<li><p>The interval contains the sample mean of a random sample with a
probability of 95%.</p></li>
<li><p>We can not calculate it because <span
class="math inline">\(\mu\)</span> is unknown.</p></li>
<li><p>Estimate <span class="math inline">\(\mu\)</span> by <span
class="math inline">\(\bar X\)</span>. <span
class="math display">\[\begin{equation*}
\left[\bar X - 1.96 \frac{\sigma}{\sqrt{n}},\bar X + 1.96
\frac{\sigma}{\sqrt{n}}\right]
\end{equation*}\]</span></p></li>
<li><p>More useful interpretation: </p></li>
<li><p>Rewrite <span class="math inline">\(\mu - 1.96 \ \sigma/\sqrt{n}
&lt; \bar{X}\)</span> as <span class="math inline">\(\mu &lt; \bar{X} +
1.96 \ \sigma/\sqrt{n}\)</span>.</p></li>
</ul>
<p>So that we can write <span class="math display">\[\begin{eqnarray*}
95\% &amp;=&amp; P( \mu - 1.96 \ \sigma/\sqrt{n} &lt; \bar{X} &lt; \mu +
1.96 \ \sigma/\sqrt{n} ) \\
&amp;=&amp;P( \bar{X} - 1.96 \ \sigma/\sqrt{n} &lt; \mu &lt; \bar{X} +
1.96 \ \sigma/\sqrt{n} )
\end{eqnarray*}\]</span></p>
<hr />
<p><strong>Definition of 95% confidence interval on mean</strong> For a
random sample, the interval <span
class="math display">\[\begin{equation}
[\bar{X} - 1.96 \ \sigma/\sqrt{n} , \bar{X} + 1.96 \ \sigma/\sqrt{n} ],
\end{equation}\]</span> contains the population mean <span
class="math inline">\(\mu\)</span> with a probability of 95%.</p>
<hr />
<ul>
<li><p>The probability that the CI for a random sample contains the
population parameter <span class="math inline">\(\mu\)</span>, i.e. 95%,
is also referred to as the <strong>confidence level</strong>.</p></li>
<li><p>Note, that the lower and upper limit of the interval are also
random variables that vary from sample to sample. Different samples
indeed result in different confidence intervals because they are based
on different observation.</p></li>
<li><p>So they are <em>stochastic intervals</em></p></li>
<li><p>95% of the samples will produce a 95% confidence interval that
will contain the population mean <span
class="math inline">\(\mu\)</span>. The remaining 5% will produce
intervals that do not contain the population mean.</p></li>
<li><p>Based on one interval you cannot conclude that it contains the
real population parameter, because its value is unknown.</p></li>
</ul>
<p>Generally the standard deviation is unknown and has to be estimated
e.g. by <span class="math inline">\(S\)</span></p>
<ul>
<li>For large <span class="math inline">\(n\)</span> <span
class="math inline">\([\bar{X} - 1.96 \ s/\sqrt{n} , \bar{X} + 1.96 \
s/\sqrt{n} ]\)</span> will contain the population mean with a
probability of approximately 95%.</li>
</ul>
<hr />
<div id="nhanes-log2-cholesterol-example" class="section level3"
number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> NHANES log2
cholesterol example</h3>
<div id="one-sample" class="section level4" number="5.1.1.1">
<h4><span class="header-section-number">5.1.1.1</span> One sample</h4>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>samp50 <span class="ot">&lt;-</span> <span class="fu">sample</span>(fem<span class="sc">$</span>DirectChol, <span class="dv">50</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>ll <span class="ot">&lt;-</span> <span class="fu">mean</span>(samp50 <span class="sc">%&gt;%</span> <span class="fu">log2</span>()) <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sd</span>(samp50 <span class="sc">%&gt;%</span> <span class="fu">log2</span>()) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">50</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>ul <span class="ot">&lt;-</span> <span class="fu">mean</span>(samp50 <span class="sc">%&gt;%</span> <span class="fu">log2</span>()) <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sd</span>(samp50 <span class="sc">%&gt;%</span> <span class="fu">log2</span>()) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">50</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>popMean <span class="ot">&lt;-</span> <span class="fu">mean</span>(fem<span class="sc">$</span>DirectChol <span class="sc">%&gt;%</span> <span class="fu">log2</span>())</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="at">ll =</span> ll, <span class="at">ul =</span> ul, <span class="at">popMean =</span> popMean)</span></code></pre></div>
<pre><code>       ll        ul   popMean 
0.3950045 0.6221037 0.5142563 </code></pre>
</div>
<div id="repeated-sampling" class="section level4" number="5.1.1.2">
<h4><span class="header-section-number">5.1.1.2</span> Repeated
sampling</h4>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>ll <span class="ot">&lt;-</span> res<span class="sc">$</span>mean <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> res<span class="sc">$</span>se</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>ul <span class="ot">&lt;-</span> res<span class="sc">$</span>mean <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> res<span class="sc">$</span>se</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> fem<span class="sc">$</span>DirectChol <span class="sc">%&gt;%</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log2</span>() <span class="sc">%&gt;%</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>()</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>inside <span class="ot">&lt;-</span> res<span class="sc">$</span>ll <span class="sc">&lt;=</span> mu <span class="sc">&amp;</span> mu <span class="sc">&lt;=</span> res<span class="sc">$</span>ul</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>n <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(res<span class="sc">$</span>n)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>res <span class="sc">%&gt;%</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(n) <span class="sc">%&gt;%</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">coverage =</span> <span class="fu">mean</span>(inside)) <span class="sc">%&gt;%</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(n, coverage)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["10"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["50"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["100"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.93","2":"0.938","3":"0.947"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<ul>
<li><p>Note, that the coverage in the samples with 10 observations is
too low because we do not account for the uncertainty in the estimation
of the standard deviation.</p></li>
<li><p>If we look to the first 20 intervals, 3 out of 20 do not contain
the population mean.</p></li>
</ul>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">==</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sample, <span class="at">y =</span> mean, <span class="at">color =</span> inside)) <span class="sc">+</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se, <span class="at">ymax =</span> mean <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> se)) <span class="sc">+</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> fem<span class="sc">$</span>DirectChol <span class="sc">%&gt;%</span> <span class="fu">log2</span>() <span class="sc">%&gt;%</span> <span class="fu">mean</span>()) <span class="sc">+</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;20 CI for N=10&quot;</span>) <span class="sc">+</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">range</span>(fem<span class="sc">$</span>DirectChol <span class="sc">%&gt;%</span> <span class="fu">log2</span>()))</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<hr />
<ul>
<li>For large sample sizes (100) the coverage is fine because we can
estimate the standard deviation with a relative high precision.</li>
</ul>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">==</span> <span class="dv">50</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sample, <span class="at">y =</span> mean, <span class="at">color =</span> inside)) <span class="sc">+</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se, <span class="at">ymax =</span> mean <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> se)) <span class="sc">+</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> fem<span class="sc">$</span>DirectChol <span class="sc">%&gt;%</span> <span class="fu">log2</span>() <span class="sc">%&gt;%</span> <span class="fu">mean</span>()) <span class="sc">+</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;20 CI for N=50&quot;</span>) <span class="sc">+</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">range</span>(fem<span class="sc">$</span>DirectChol <span class="sc">%&gt;%</span> <span class="fu">log2</span>()))</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">==</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sample, <span class="at">y =</span> mean, <span class="at">color =</span> inside)) <span class="sc">+</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se, <span class="at">ymax =</span> mean <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> se)) <span class="sc">+</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> fem<span class="sc">$</span>DirectChol <span class="sc">%&gt;%</span> <span class="fu">log2</span>() <span class="sc">%&gt;%</span> <span class="fu">mean</span>()) <span class="sc">+</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;20 CI for N=100&quot;</span>) <span class="sc">+</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">range</span>(fem<span class="sc">$</span>DirectChol <span class="sc">%&gt;%</span> <span class="fu">log2</span>()))</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-27-2.png" width="672" /></p>
<ul>
<li>What have you observed for the interval width?</li>
</ul>
<hr />
</div>
</div>
<div id="other-confidence-levels" class="section level3" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> Other confidence
levels</h3>
<ul>
<li><p>We can replace the <span
class="math inline">\(z_{2.5\%}=1.96\)</span> by another quantile of the
normal distribution <span class="math inline">\(z_{\alpha/2}\)</span> to
obtain an interval with another confidence level <span
class="math inline">\(1-\alpha\)</span>.</p></li>
<li><p>Confidence intervals are not only used for the mean but also for
other population parameters.</p></li>
</ul>
<hr />
</div>
</div>
<div id="unknown-variance" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Unknown variance</h2>
<p>In real examples <span class="math inline">\(\sigma\)</span> is
unknown and estimated based on the sample using the sample standard
deviation <span class="math inline">\(S\)</span>.</p>
<ul>
<li><p>The previous intervals were a bit to small because they did not
account for the uncertainty on the estimation of <span
class="math inline">\(S\)</span>.</p></li>
<li><p>When <span class="math inline">\(n\)</span> is large, <span
class="math inline">\(S\)</span> is close to <span
class="math inline">\(\sigma\)</span>.</p></li>
<li><p>Hence, <span class="math inline">\({(\bar{X} -
\mu)}/{(S/\sqrt{n}) }\)</span> is approximately standard normal and
<span class="math display">\[\begin{equation*}
\left[\bar{X} - z_{\alpha/2} \ \frac{S}{\sqrt{n}} , \bar{X} +
z_{\alpha/2} \
\frac{S}{\sqrt{n}}\right]
\end{equation*}\]</span>n}}] \end{equation*} is an approximate <span
class="math inline">\((1- \alpha)100\%\)</span> CI for <span
class="math inline">\(\mu\)</span>.</p></li>
<li><p>For small samples this no longer holds (e.g. n=10)</p></li>
</ul>
<p>The estimation of <span class="math inline">\(S\)</span> introduces
additional uncertainty in the standardized value <span
class="math inline">\({(\bar{X} - \mu)}/{(S/\sqrt{n})}\)</span>. Its
distribution</p>
<ul>
<li><p>is still symmetric but has heavier tails that the normal
distribution.</p></li>
<li><p>it depends on <span class="math inline">\(n\)</span> how much
heavier the tails are</p></li>
<li><p>is a (Student) <span
class="math inline">\(t\)</span>-distribution with <span
class="math inline">\(n-1\)</span> <em>degrees of freedom</em>.</p></li>
</ul>
<hr />
<div id="t-distribution" class="section level3" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> T-distribution</h3>
<p>More formally: Let <span class="math inline">\(X_1, X_2, ...,
X_n\)</span> be an independent random sample from a Normal distribution
<span class="math inline">\(N(\mu, \sigma^2)\)</span>, then <span
class="math inline">\((\bar{X} - \mu)/(S/\sqrt{n})\)</span> follows a
<span class="math inline">\(t\)</span>-distribution with <span
class="math inline">\(n-1\)</span> degrees of freedom.</p>
<p>The density of a t-distribution can be calculated in R using the
function <code>dt</code>. It has arguments <code>x</code> for the
quantile and <code>df</code> for the degrees of freedom.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, .<span class="dv">1</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>densDist <span class="ot">&lt;-</span> <span class="fu">cbind</span>(grid, <span class="fu">dnorm</span>(grid), <span class="fu">sapply</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>), dt, <span class="at">x =</span> grid))</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(densDist) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;normal&quot;</span>, <span class="fu">paste0</span>(<span class="st">&quot;t&quot;</span>, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>)))</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>densDist <span class="sc">%&gt;%</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(dist, dens, <span class="sc">-</span>x) <span class="sc">%&gt;%</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> dens, <span class="at">color =</span> dist)) <span class="sc">+</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Density&quot;</span>)</span></code></pre></div>
<p>t-distributions have heavier tails then the normal distribution <span
class="math inline">\(\rightarrow\)</span> larger quantiles so broader
intervals for the same confidence level.</p>
<ul>
<li><p>This captures the additional uncertainty for estimating <span
class="math inline">\(S\)</span>.</p></li>
<li><p>If <span class="math inline">\(n \rightarrow \infty\)</span> then
<span class="math inline">\(t(df) \rightarrow N(0,1)\)</span></p></li>
<li><p>Quantiles of the <span
class="math inline">\(t\)</span>-distribution can be calculated in R
using <code>qt</code>. e.g. 95%, 97.5%, 99.5% quantile for a
t-distribution with 14 degrees of freedom:</p></li>
</ul>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qt</span>(.<span class="dv">975</span>, <span class="at">df =</span> <span class="dv">14</span>)</span></code></pre></div>
<pre><code>[1] 2.144787</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qt</span>(<span class="fu">c</span>(.<span class="dv">95</span>, .<span class="dv">975</span>, .<span class="dv">995</span>), <span class="at">df =</span> <span class="dv">14</span>)</span></code></pre></div>
<pre><code>[1] 1.761310 2.144787 2.976843</code></pre>
<ul>
<li><p>These quantiles can be used to calculate 90%, 95% and 99%
CI.</p></li>
<li><p>97.5% quantile 2.14 of a t-distribution with <span
class="math inline">\(n-1=14\)</span> degrees of freedom is indeed
larger than that of a standard Normal distribution 1.96.</p></li>
</ul>
<hr />
</div>
<div id="confidence-interval-based-on-the-t-distribution"
class="section level3" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Confidence interval
based on the t-distribution</h3>
<p>The <span class="math inline">\(100\% (1-\alpha)\)</span> CI for the
mean <span class="math inline">\(\mu\)</span> of a Normal distributed
random variable <span class="math inline">\(X\)</span> with unknown
variance is</p>
<p><span class="math display">\[\begin{equation*}
\left[\bar{X} - t_{n-1, \alpha/2} \frac{s}{\sqrt{n}} , \bar{X} + t_{n-1,
\alpha/2} \frac{s}{\sqrt{n}}\right]
\end{equation*}\]</span></p>
<ul>
<li>We simply replace the <span
class="math inline">\((1-\alpha/2)100\%\)</span> quantile of the Normal
distribution by that of the t-distribution with <span
class="math inline">\(n-1\)</span> degrees of freedom.</li>
</ul>
<div id="captopril-example-1" class="section level4" number="5.2.2.1">
<h4><span class="header-section-number">5.2.2.1</span> Captopril
example</h4>
<p>95% CI for the average blood pressure change becomes</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(captopril<span class="sc">$</span>deltaSBP) <span class="sc">-</span> <span class="fu">qt</span>(.<span class="dv">975</span>, <span class="at">df =</span> <span class="dv">14</span>) <span class="sc">*</span> <span class="fu">sd</span>(captopril<span class="sc">$</span>deltaSBP) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">15</span>)</span></code></pre></div>
<pre><code>[1] -23.93258</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(captopril<span class="sc">$</span>deltaSBP) <span class="sc">+</span> <span class="fu">qt</span>(.<span class="dv">975</span>, <span class="at">df =</span> <span class="dv">14</span>) <span class="sc">*</span> <span class="fu">sd</span>(captopril<span class="sc">$</span>deltaSBP) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">15</span>)</span></code></pre></div>
<pre><code>[1] -13.93409</code></pre>
<p>The 99% CI is given by</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(captopril<span class="sc">$</span>deltaSBP) <span class="sc">-</span> <span class="fu">qt</span>(.<span class="dv">995</span>, <span class="at">df =</span> <span class="dv">14</span>) <span class="sc">*</span> <span class="fu">sd</span>(captopril<span class="sc">$</span>deltaSBP) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">15</span>)</span></code></pre></div>
<pre><code>[1] -25.87201</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(captopril<span class="sc">$</span>deltaSBP) <span class="sc">+</span> <span class="fu">qt</span>(.<span class="dv">995</span>, <span class="at">df =</span> <span class="dv">14</span>) <span class="sc">*</span> <span class="fu">sd</span>(captopril<span class="sc">$</span>deltaSBP) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">15</span>)</span></code></pre></div>
<pre><code>[1] -11.99466</code></pre>
<p>Note, that zero is outside the interval and that the entire interval
is negative indicating that there is on average a large effect by
administrating captopril on the blood pressure of patients with
hypertension.</p>
<hr />
</div>
</div>
<div id="interpretation-of-the-confidence-interval"
class="section level3" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Interpretation of
the confidence interval</h3>
<ul>
<li>We will revisit the results for sampling log2 cholesterol levels
from the large NHANES study. We first focus on the repeated experiments
with sample size 10.</li>
</ul>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>n <span class="ot">&lt;-</span> <span class="fu">as.character</span>(res<span class="sc">$</span>n) <span class="sc">%&gt;%</span> <span class="fu">as.double</span>(res<span class="sc">$</span>n)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>ll <span class="ot">&lt;-</span> res<span class="sc">$</span>mean <span class="sc">-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="at">df =</span> res<span class="sc">$</span>n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> res<span class="sc">$</span>se</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>ul <span class="ot">&lt;-</span> res<span class="sc">$</span>mean <span class="sc">+</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="at">df =</span> res<span class="sc">$</span>n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> res<span class="sc">$</span>se</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> fem<span class="sc">$</span>DirectChol <span class="sc">%&gt;%</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log2</span>() <span class="sc">%&gt;%</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>()</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>inside <span class="ot">&lt;-</span> res<span class="sc">$</span>ll <span class="sc">&lt;=</span> mu <span class="sc">&amp;</span> mu <span class="sc">&lt;=</span> res<span class="sc">$</span>ul</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>n <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(res<span class="sc">$</span>n)</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>res <span class="sc">%&gt;%</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(n) <span class="sc">%&gt;%</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">coverage =</span> <span class="fu">mean</span>(inside)) <span class="sc">%&gt;%</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(n, coverage)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["10"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["50"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["100"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.955","2":"0.944","3":"0.95"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>We observe that all the coverages of the intervals are now controlled
at their nominal 95% confidence level.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">%&gt;%</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">==</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sample, <span class="at">y =</span> mean, <span class="at">color =</span> inside)) <span class="sc">+</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean <span class="sc">-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="at">df =</span> <span class="dv">9</span>) <span class="sc">*</span> se, <span class="at">ymax =</span> mean <span class="sc">+</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="at">df =</span> <span class="dv">9</span>) <span class="sc">*</span> se)) <span class="sc">+</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> fem<span class="sc">$</span>DirectChol <span class="sc">%&gt;%</span> <span class="fu">log2</span>() <span class="sc">%&gt;%</span> <span class="fu">mean</span>()) <span class="sc">+</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;20 CI for N=10&quot;</span>) <span class="sc">+</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">range</span>(fem<span class="sc">$</span>DirectChol <span class="sc">%&gt;%</span> <span class="fu">log2</span>()))</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<p><embed src="https://www.nature.com/articles/nmeth.2659.pdf"
style="width:100.0%" /></p>
<hr />
</div>
</div>
<div id="reporting" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Reporting?</h2>
<ul>
<li><p>Always report the uncertainty on the results!</p></li>
<li><p>Conclusions based on a point estimate can be very
misleading.</p></li>
<li><p>Upon a statistical analysis we therefore always report confidence
intervals</p></li>
<li><p>They are small enough to be informative but almost never
misleading</p></li>
<li><p>They form a good trade-off between statistical significance and
biological relevance.</p></li>
<li><p>We conclude that the population parameter lays in the interval
and know that this statement holds with a probability of 95% for random
samples.</p></li>
</ul>
<div id="captopril-example-2" class="section level3" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Captopril
example</h3>
<p>We conclude that the blood pressure decreases on average with
18.9mmHg upon administering captopril (95% CI [-23.9,-13.9]mmHg).</p>
<p>Based on these results it is obvious that the treatment causes a
strong blood pressure drop for patients with hypertension.</p>
</div>
</div>
</div>
<div id="hypothesis-tests" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Hypothesis tests</h1>
<div id="captopril-example-3" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Captopril
Example:</h2>
<p>Researchers want to assess if the drug captopril decreases the blood
pressure for patients with hypertension.</p>
<ul>
<li><p>Is there no/an effect of administering captopril on the systolic
blood pressure?</p></li>
<li><p>It is not obvious to draw such conclusions based on a small
sample</p></li>
<li><p>It is uncertain if we can generalized the observations in the
sample towards the population!</p></li>
<li><p>Is the apparent beneficial effect systematic or random?</p></li>
</ul>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>captoprilTidy <span class="sc">%&gt;%</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;SBPa&quot;</span>, <span class="st">&quot;SBPb&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">factor</span>(type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;SBPb&quot;</span>, <span class="st">&quot;SBPa&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> type, <span class="at">y =</span> bp)) <span class="sc">+</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> id)) <span class="sc">+</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>captopril<span class="sc">$</span>deltaSBP <span class="ot">&lt;-</span> captopril<span class="sc">$</span>SBPa <span class="sc">-</span> captopril<span class="sc">$</span>SBPb</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>captopril <span class="sc">%&gt;%</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">&quot;Systolic blood pressure&quot;</span>, <span class="at">y =</span> deltaSBP)) <span class="sc">+</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">&quot;jitter&quot;</span>) <span class="sc">+</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Difference (mm mercury)&quot;</span>) <span class="sc">+</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<ul>
<li>The average blood pressure difference <span
class="math inline">\(\bar X\)</span> is a natural basis to base our
decision on.</li>
</ul>
<p><span class="math display">\[\bar x\text{=-18.93 (s=9.03,
SE=2.33)}\]</span></p>
<ul>
<li><p>It is not enough that <span class="math inline">\(\bar{x}&lt;
0\)</span> to conclude that the systolic blood pressure is on average
lower upon administrating captopril <em>at the level of the entire
population</em>.</p></li>
<li><p>To generalize the effect we observe in the sample to the
population it has to be sufficiently large.</p></li>
<li><p>But, how large?</p></li>
</ul>
<hr />
<div id="hypothesis-tests-1" class="section level3" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Hypothesis
tests</h3>
<ul>
<li><p>For this purpose statistical hypothesis tests have been
developed</p></li>
<li><p>They give a black/white answer</p></li>
<li><p>It is almost impossible to read a scientific publication without
results of statistical tests.</p></li>
<li><p>According to the <em>falsification principle</em> of Popper we
can never prove a hypothesis based on data.</p>
<ul>
<li><p>Hence we will introduce two hypotheses: a null hypothesis <span
class="math inline">\(H_0\)</span> and an alternative hypothesis <span
class="math inline">\(H_1\)</span>.</p></li>
<li><p>We will try to falsify the null hypothesis based on the
statistical test.</p></li>
</ul></li>
</ul>
<div id="captopril" class="section level4" number="6.1.1.1">
<h4><span class="header-section-number">6.1.1.1</span> Captopril</h4>
<ul>
<li><p>Based on the sample we cannot prove that there is an effect of
administering captopril (<span class="math inline">\(H_1\)</span> ,
alternative hypothesis).</p></li>
<li><p>We therefore suppose that there is no effect of captopril.</p>
<ul>
<li><p>We refer to this as the null hypothesis <span
class="math inline">\(H_0\)</span>.</p></li>
<li><p>Falsify (“try to reject”) the <span
class="math inline">\(H_0\)</span>.</p></li>
<li><p>How likely is it to observe an effect that is at least as large
as what we have observed in our sample in a novel random sample when
<span class="math inline">\(H_0\)</span> is true?</p></li>
</ul></li>
</ul>
<hr />
</div>
<div id="permutation-test" class="section level4" number="6.1.1.2">
<h4><span class="header-section-number">6.1.1.2</span> Permutation
test</h4>
<ul>
<li><p>Under <span class="math inline">\(H_0\)</span> the blood pressure
measurements before and after administering captopril are two base line
blood pressure measurements for a patient</p></li>
<li><p>Under H<span class="math inline">\(_0\)</span> we can shuffle
(permute) the blood pressure measurements for each patient.</p></li>
</ul>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>captoprilSamp <span class="ot">&lt;-</span> captopril</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>perm <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">TRUE</span>), <span class="dv">15</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>captoprilSamp<span class="sc">$</span>SBPa[perm] <span class="ot">&lt;-</span> captopril<span class="sc">$</span>SBPb[perm]</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>captoprilSamp<span class="sc">$</span>SBPb[perm] <span class="ot">&lt;-</span> captopril<span class="sc">$</span>SBPa[perm]</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>captoprilSamp<span class="sc">$</span>deltaSBP <span class="ot">&lt;-</span> captoprilSamp<span class="sc">$</span>SBPa <span class="sc">-</span> captoprilSamp<span class="sc">$</span>SBPb</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>captoprilSamp <span class="sc">%&gt;%</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(type, bp, <span class="sc">-</span>id) <span class="sc">%&gt;%</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;SBPa&quot;</span>, <span class="st">&quot;SBPb&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">factor</span>(type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;SBPb&quot;</span>, <span class="st">&quot;SBPa&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> type, <span class="at">y =</span> bp)) <span class="sc">+</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> id)) <span class="sc">+</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">deltaSBP =</span> <span class="fu">c</span>(captopril<span class="sc">$</span>deltaSBP, captoprilSamp<span class="sc">$</span>deltaSBP), <span class="at">shuffled =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">TRUE</span>), <span class="at">each =</span> <span class="dv">15</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> shuffled, <span class="at">y =</span> deltaSBP)) <span class="sc">+</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">&quot;jitter&quot;</span>) <span class="sc">+</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">shape =</span> <span class="dv">19</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Difference (mm mercury)&quot;</span>)</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<p>And we permute again</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>captoprilSamp <span class="ot">&lt;-</span> captopril</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>perm <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">TRUE</span>), <span class="dv">15</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>captoprilSamp<span class="sc">$</span>SBPa[perm] <span class="ot">&lt;-</span> captopril<span class="sc">$</span>SBPb[perm]</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>captoprilSamp<span class="sc">$</span>SBPb[perm] <span class="ot">&lt;-</span> captopril<span class="sc">$</span>SBPa[perm]</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>captoprilSamp<span class="sc">$</span>deltaSBP <span class="ot">&lt;-</span> captoprilSamp<span class="sc">$</span>SBPa <span class="sc">-</span> captoprilSamp<span class="sc">$</span>SBPb</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>captoprilSamp <span class="sc">%&gt;%</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(type, bp, <span class="sc">-</span>id) <span class="sc">%&gt;%</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;SBPa&quot;</span>, <span class="st">&quot;SBPb&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">factor</span>(type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;SBPb&quot;</span>, <span class="st">&quot;SBPa&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> type, <span class="at">y =</span> bp)) <span class="sc">+</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> id)) <span class="sc">+</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">deltaSBP =</span> <span class="fu">c</span>(captopril<span class="sc">$</span>deltaSBP, captoprilSamp<span class="sc">$</span>deltaSBP), <span class="at">shuffled =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">TRUE</span>), <span class="at">each =</span> <span class="dv">15</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> shuffled, <span class="at">y =</span> deltaSBP)) <span class="sc">+</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">&quot;jitter&quot;</span>) <span class="sc">+</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">shape =</span> <span class="dv">19</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Difference (mm mercury)&quot;</span>)</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-38-2.png" width="672" /></p>
<ul>
<li>We will do this 10000 times and we will keep track of the mean.</li>
<li>We basically only have to swap the signs of the observed blood
pressure differences <span class="math inline">\(x\)</span> when we
shuffle.</li>
</ul>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate a matrix with 15 rows and 10000 columns which consist of -1 and 1</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>permH <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="dv">150000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(permH) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">10000</span>)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the means for the permuted data</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>muPerm <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(permH <span class="sc">*</span> captopril<span class="sc">$</span>deltaSBP)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>muPerm <span class="sc">%&gt;%</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .)) <span class="sc">+</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(captopril<span class="sc">$</span>deltaSBP), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<ul>
<li><p>We observe that not one of the means that were obtained under
<span class="math inline">\(H_0\)</span> (by permutation) were as
extreme as the sample mean we observed in the captopril study.</p></li>
<li><p>So the probability to observe a blood pressure drop that is
larger then the one in the captopril study in a random sample generated
under the null hypothesis is smaller then 1 out of 10000.</p></li>
</ul>
<p>So we have strong evidence that <span
class="math inline">\(H_0\)</span> is incorrect and we thus we reject it
and conclude <span class="math inline">\(H_1\)</span>: There is an
effect of administering captopril on the blood pressure of patients with
hypertension.</p>
<hr />
</div>
</div>
<div id="pivot" class="section level3" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> Pivot</h3>
<ul>
<li><p>In practice we always use statistics that balance the effect size
(average difference) to the noise (standard error)</p></li>
<li><p>When we falsify the null hypothesis, we standardize the mean
around <span class="math inline">\(\mu_0=0\)</span> the mean under <span
class="math inline">\(H_0\)</span></p></li>
</ul>
<p><span class="math display">\[t=\frac{\bar X-\mu_0}{se_{\bar
X}}\]</span></p>
<ul>
<li>for the captopril example this becomes: <span
class="math display">\[\frac{-18.93-0}{2.33}=-8.12\]</span></li>
</ul>
<p>We now determine the null distribution of test statistic t with
permutation.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>deltaPerms <span class="ot">&lt;-</span> permH <span class="sc">*</span> captopril<span class="sc">$</span>deltaSBP</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>tPerm <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(deltaPerms) <span class="sc">/</span> (<span class="fu">apply</span>(deltaPerms, <span class="dv">2</span>, sd) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">15</span>))</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>tOrig <span class="ot">&lt;-</span> <span class="fu">mean</span>(captopril<span class="sc">$</span>deltaSBP) <span class="sc">/</span> <span class="fu">sd</span>(captopril<span class="sc">$</span>deltaSBP) <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">15</span>)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>tPermPlot <span class="ot">&lt;-</span> tPerm <span class="sc">%&gt;%</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .)) <span class="sc">+</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density.., <span class="at">fill =</span> ..count..)) <span class="sc">+</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> tOrig, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>tPermPlot</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<ul>
<li>Again, none of the permutations gives a t-statistic as extreme as
the one observed in the captopril study.</li>
</ul>
<p>When there is no effect of captopril it is nearly impossible to
obtain a test statistic as extreme as the one that was observed (
t=-8.12).</p>
<ul>
<li><p>The probability to observe a larger blood pressure drop then the
one we observed in our sample in a random sample under <span
class="math inline">\(H_0\)</span> is smaller 1/10000.</p></li>
<li><p>We refer to this probability with the <em>p-value</em>.</p></li>
<li><p>It measures the strength of the evidence against the null: the
smaller the p-value the more evidence we have that the null is not
true.</p></li>
<li><p>The distribution has a nice bell shape.</p></li>
</ul>
<hr />
</div>
<div id="how-do-we-decide" class="section level3" number="6.1.3">
<h3><span class="header-section-number">6.1.3</span> How do we
decide?</h3>
<p>When is the p-value sufficiently small to conclude that there is
strong evidence against the null hypothesis?</p>
<ul>
<li><p>We typically work at a significance level of <span
class="math inline">\(\alpha=0.05\)</span></p></li>
<li><p>We state that we conducted the test at the 5% significance
level</p></li>
</ul>
<hr />
</div>
<div id="permutation-tests-are-computationally-demanding"
class="section level3" number="6.1.4">
<h3><span class="header-section-number">6.1.4</span> Permutation tests
are computationally demanding</h3>
<ul>
<li><p>Can we assess how extreme the blood pressure drop was without
permutation?</p></li>
<li><p>We know that the blood pressure differences are approximately
Normally distributed, so</p></li>
</ul>
<p><span class="math display">\[t=\frac{\bar X - \mu}{se_{\bar
X}}\]</span></p>
<p>follows a t-distribution (with 14 df for the captopril example).</p>
<ul>
<li>Under H<span class="math inline">\(_0\)</span> <span
class="math inline">\(\mu=0\)</span> and <span
class="math display">\[t=\frac{\bar X-0}{se_{\bar X}}\sim
f_{T,14}\]</span></li>
</ul>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>tPermPlot <span class="sc">+</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dt, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">df =</span> <span class="dv">14</span>))</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<ul>
<li><p>Note, the permutation null distribution indeed corresponds to a
t-distribution with 14 degrees of freedom.</p></li>
<li><p>So we can conduct the statistical test using statistical
modelling of the data.</p></li>
<li><p>We need to make assumptions for this, which we verify in the data
exploration phase.</p></li>
</ul>
<hr />
</div>
</div>
<div id="hypotheses" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Hypotheses</h2>
<details>
<summary>
Click to see more formal details
</summary>
<p>
<p>Translate the research question to a null hypothesis (<span
class="math inline">\(H_0\)</span>) and an alternative hypothesis (<span
class="math inline">\(H_1\)</span>)</p>
<p>First the we need to translate the research question to a
parameterized statistical model.</p>
<ul>
<li><p>From the experimental design it follows that <span
class="math display">\[X_1,...,X_n \text{ i.i.d } f(X),\]</span> with
<span class="math inline">\(f(X)\)</span> the density function of blood
pressure differences.</p></li>
<li><p><strong>Simplify</strong>: assume that <span
class="math inline">\(f(X)\)</span> is known except for an finite
dimensional set of parameters <span
class="math inline">\(\mathbf{\theta}\)</span> that still has to be
estimated (parametric statistic model).</p></li>
</ul>
</p>
</details>
<div id="captopril-example-4" class="section level3" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Captopril
example</h3>
<details>
<summary>
Click to see more formal details
</summary>
<p>
<p><span class="math inline">\(X \sim N(\mu,\sigma^2)\)</span> with
<span class="math inline">\(\mathbf{\theta}=(\mu,\sigma^2)\)</span>, the
mean <span class="math inline">\(\mu\)</span> and variance <span
class="math inline">\(\sigma^2\)</span>.</p>
<p>The research question is now translated in terms of the average blood
pressure drop: <span class="math inline">\(\mu=E_f[X]\)</span>.</p>
<p>The <strong>alternative hypothesis</strong> is formulated in terms of
a parameter of <span class="math inline">\(f(X)\)</span> and has to
express what the researchers want to prove with the study.</p>
<ul>
<li>Here: <span class="math display">\[H_1: \mu&lt;0.\]</span> On
average the blood pressure of patients with hypertension decreases upon
administering captopril.</li>
</ul>
<p>The <strong>null hypothesis</strong> generally expresses a null
condition, i.e. when notting exceptional happens.</p>
<ul>
<li><p>Researchers typically aim to prove via empirical research that
observing the data under the null is highly unlikely so that they can
reject the null hypothesis: <strong>Falsification
principle</strong>.</p></li>
<li><p>The <strong>null hypothesis is typically expressed with the same
model parameter as the one used for <span
class="math inline">\(H_1\)</span>.</strong></p></li>
<li><p>Here: <span class="math display">\[H_0 : \mu=0\]</span> i.e. on
average the systolic blood pressure remains unchanged upon administering
captopril.</p></li>
</ul>
</p>
</details>
<hr />
</div>
</div>
<div id="test-statistic" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Test-statistic</h2>
<details>
<summary>
Click to see more formal details
</summary>
<p>
<p>Once the population, the parameters, and, <span
class="math inline">\(H_0\)</span> and <span
class="math inline">\(H_1\)</span> are determined the concept of
hypothesis testing is as follows:</p>
<p>Construct a test statistic so that it</p>
<ol style="list-style-type: decimal">
<li>measures evidence in the sample, </li>
<li>against the null hypothesis, and </li>
<li>in favour of the alternative hypothesis.</li>
</ol>
<p>A test statistic thus has to be a function of the observations in the
sample.</p>
</p>
</details>
<div id="captopril-example-5" class="section level3" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Captopril
example</h3>
<details>
<summary>
Click to see more formal details
</summary>
<p>
<p><span class="math display">\[T=\frac{\bar{X}-\mu_0}{\text{SE}_{\bar
X}}\]</span> With <span class="math inline">\(\mu_0=0\)</span> under
<span class="math inline">\(H_0\)</span></p>
<p>Again</p>
<ul>
<li><p>If <span class="math inline">\(H_0\)</span> holds there is no
effect of captopril on the blood pressure in the population and then we
expect test statistic <span class="math inline">\(T\)</span> close to
0.</p></li>
<li><p>If <span class="math inline">\(H_1\)</span> is true we expect
<span class="math inline">\(T&lt;0\)</span>.</p></li>
<li><p>In the captopril example we observe <span
class="math inline">\(t=(-18.93-0)/2.33=-8.12\)</span>.</p></li>
<li><p>Is <span class="math inline">\(t = -8.12\)</span> large enough in
absolute value to conclude that <span class="math inline">\(\mu &lt;
0\)</span> and with which confidence can we make this
conclusion?</p></li>
<li><p>We known that t follows a t-distribution with 14 d.f. under <span
class="math inline">\(H_0\)</span></p></li>
</ul>
</p>
</details>
<hr />
</div>
</div>
<div id="p-value" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> p-value</h2>
<p>The p-value is the probability to balance between <span
class="math inline">\(H_0\)</span> and <span
class="math inline">\(H_1\)</span>.</p>
<p>The way how we calculate it is context dependent</p>
<ul>
<li>For the captopril example we have <span class="math display">\[
  p = P\left[T \leq t \mid H_0\right] = \text{P}_0\left[T\leq t\right],
\]</span> with the index “0” in <span
class="math inline">\(\text{P}_0\left[.\right]\)</span> indicates that
the probability is calculated under <span
class="math inline">\(H_0\)</span>.</li>
</ul>
<p>It gives the probability to observe a test statistic <span
class="math inline">\(T\)</span> lower or equal to the value observed in
the current sample in a random sample under <span
class="math inline">\(H_0\)</span></p>
<pre><code>- i.e. a test statistic $T$ in the random sample under $H_0$ with a value that is more extreme, more in the direction of $H_1$ then the one observed in the current sample.</code></pre>
<div id="captopril-example-6" class="section level3" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> Captopril
example</h3>
<details>
<summary>
Click to see more formal details
</summary>
<p>
<ul>
<li><p>The <span class="math inline">\(p\)</span>-value for the
captopril example is calculated as follows <span
class="math display">\[p= \text{P}_0\left[T\leq
-8.12\right]=F_t(-8.12;14) = 0.6\ 10^{-6}.\]</span></p>
<p>with <span class="math inline">\(F_t(;14)\)</span> the cumulative
distribution function of a t-distribution with 14 degrees of
freedom:</p></li>
</ul>
<p><span class="math display">\[F_t(x;14)=\int\limits_{-\infty}^{x}
f_t(x;14).\]</span></p>
<p>and <span class="math inline">\(f_t(.;14)\)</span> the density
function of the t-distribution.</p>
<ul>
<li><p>We calculate this probability in R with <code>pt(x,df)</code></p>
<ul>
<li>the value of the observed test statistic <code>x</code> en</li>
<li>the number of degrees of freedom of the t-distribution
<code>df</code>.</li>
</ul></li>
<li><p><code>pt(x,df)</code> calculates the probability to observe a
value smaller or equal to x when we would draw a random sample from a
t-distribution with df degrees of freedom.</p></li>
</ul>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(captopril<span class="sc">$</span>deltaSBP)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>stat <span class="ot">&lt;-</span> (<span class="fu">mean</span>(captopril<span class="sc">$</span>deltaSBP) <span class="sc">-</span> <span class="dv">0</span>) <span class="sc">/</span> (<span class="fu">sd</span>(captopril<span class="sc">$</span>deltaSBP) <span class="sc">/</span> <span class="fu">sqrt</span>(n))</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>stat</span></code></pre></div>
<pre><code>[1] -8.122816</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pt</span>(stat, n <span class="sc">-</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>[1] 5.731936e-07</code></pre>
</p>
</details>
<p>In practice we will not calculate the test ourself, but we will use
the function t.test:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(captopril<span class="sc">$</span>deltaSBP, <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>)</span></code></pre></div>
<pre><code>
    One Sample t-test

data:  captopril$deltaSBP
t = -8.1228, df = 14, p-value = 5.732e-07
alternative hypothesis: true mean is less than 0
95 percent confidence interval:
      -Inf -14.82793
sample estimates:
mean of x 
-18.93333 </code></pre>
<p>Note, that we need to specify the argument
<code>alternative="less"</code> so that the p-value would be calculated
in the left tail.</p>
<p>The function also gives a one-sided interval because we test in one
direction.</p>
<hr />
</div>
<div id="definition-of-the-p-value" class="section level3"
number="6.4.2">
<h3><span class="header-section-number">6.4.2</span> Definition of the
p-value</h3>
<p>The <strong>p-value</strong> (also referred to as the
<strong>observed significance level</strong>) is the probability to
observe a test statistic in a random sample under the null hypothesis
that is as or more extreme then the test statistic observed in the
current sample.</p>
<ul>
<li><p>The smaller the probability the more evidence against <span
class="math inline">\(H_0\)</span>.</p></li>
<li><p>Note, that the p-value is <strong>not</strong> the probability
that null hypothesis is true!</p></li>
<li><p>The word “extreme” indicates on the direction in which the test
statistic is more likely under the alternative hypothesis.</p></li>
<li><p>In the example <span class="math inline">\(H_1: \mu &lt;
0\)</span> and we thus expect very negative values for <span
class="math inline">\(t\)</span> under <span
class="math inline">\(H_1\)</span>.</p></li>
<li><p>From the definition small <span
class="math inline">\(p\)</span>-values indicate that observed test
statistic is unlikely under the assumption that <span
class="math inline">\(H_0\)</span> is correct.</p></li>
<li><p>Thus a small value of <span
class="math inline">\(p\)</span>-value means that we have to
<strong>reject <span class="math inline">\(H_0\)</span></strong> in
favour of <span class="math inline">\(H_1\)</span>.</p></li>
<li><p>The threshold that we use to compare the <span
class="math inline">\(p\)</span>-value with is referred to as the
<strong>significance level</strong> and is denoted with <span
class="math inline">\(\alpha\)</span>.</p></li>
<li><p>A statistical test conducted on the <span
class="math inline">\(\alpha\)</span> significance level is also
referred to as a <strong>level-<span
class="math inline">\(\alpha\)</span> test</strong>.</p></li>
</ul>
<p>A test result is <em>statistically significant</em> if <span
class="math inline">\(p&lt;\alpha\)</span></p>
<ul>
<li><p><span class="math inline">\(\alpha\)</span> is commonly set at
5%.</p></li>
<li><p>The smaller the p-value the more `significant’ the test result
deviates from what can be expected under <span
class="math inline">\(H_0\)</span>.</p></li>
<li><p>It summarizes the evidence against the null.</p></li>
</ul>
<p><span class="math display">\[\begin{array}{cl}&gt;0.10 &amp; \text{
non significant (no evidence)}\\0.05-0.10 &amp; \text{ marginal
significant, weak evidence (do not use this yourself)}\\0.01-0.05 &amp;
\text{ significant}\\0.001-0.01 &amp; \text{strongly
significant}\\&lt;0.001 &amp; \text{ extremely
significant}\end{array}\]</span></p>
<hr />
</div>
</div>
<div id="critical-value" class="section level2" number="6.5">
<h2><span class="header-section-number">6.5</span> Critical value</h2>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-44-1.png" width="100%" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="decision-errors" class="section level2" number="6.6">
<h2><span class="header-section-number">6.6</span> Decision Errors</h2>
<p>The decision to accept or reject <span
class="math inline">\(H_0\)</span> is made based on a single sample. A
wrong decision could have been made.</p>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Reality
</div>
</th>
</tr>
<tr>
<th style="text-align:center;">
Conclusion
</th>
<th style="text-align:center;">
H0
</th>
<th style="text-align:center;">
H1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
Accept H0
</td>
<td style="text-align:center;">
OK
</td>
<td style="text-align:center;">
Type II (<span class="math inline">\(\beta\)</span>)
</td>
</tr>
<tr>
<td style="text-align:center;">
Reject H0
</td>
<td style="text-align:center;">
Type I (<span class="math inline">\(\alpha\)</span>)
</td>
<td style="text-align:center;">
OK
</td>
</tr>
</tbody>
</table>
<ul>
<li><p>Type I error, <span class="math inline">\(\alpha\)</span>:
wrongly reject the null hypothesis (false positive) </p></li>
<li><p>Type II error, <span class="math inline">\(\beta\)</span>:
wrongly accept the null hypothesis</p></li>
<li><p>Decision is also stochastic! See first chapter of the
course</p></li>
</ul>
<div id="captopril-example-7" class="section level3" number="6.6.1">
<h3><span class="header-section-number">6.6.1</span> Captopril
Example</h3>
<ul>
<li><p><span class="math inline">\(H_0\)</span>: administering captopril
has no effect on the systolic blood pressure</p></li>
<li><p><span class="math inline">\(H_1\)</span>: administering captopril
an average leads to a decrease in blood pressure</p></li>
<li><p><strong>Type I error</strong>: there is on average no blood
pressure drop upon administering captopril, but we conclude that there
is an effect of captopril.</p></li>
<li><p><strong>Type II error</strong>: there is on average a blood
pressure drop upon administering captopril, but it is not picked up by
the statistical test.</p></li>
</ul>
<hr />
</div>
<div id="type-i-error-is-controlled" class="section level3"
number="6.6.2">
<h3><span class="header-section-number">6.6.2</span> Type I error is
controlled</h3>
<p>The type I error is controlled by the construction of the statistical
test.</p>
<p><span class="math display">\[\text{P}\left[\text{type I
error}\right]=\text{P}\left[\text{reject }H_0 \mid H_0\right] =
\text{P}_0\left[T&lt;t_{n-1;1-\alpha}\right]=\alpha \]</span></p>
<ul>
<li><p>The significance-level <span
class="math inline">\(\alpha\)</span> is the probability to make a type
I error.</p></li>
<li><p>The statistical test ensures that the probability on a type I
error is controlled at the significance level <span
class="math inline">\(\alpha\)</span>.</p></li>
<li><p>The probability to correctly accept <span
class="math inline">\(H_0\)</span> is <span
class="math inline">\(1-\alpha\)</span>.</p></li>
<li><p>We can show that the p-value under <span
class="math inline">\(H_0\)</span> is uniform distributed.</p></li>
<li><p>So statistical hypothesis testing leads to a uniform decision
strategy.</p></li>
</ul>
<p>We will illustrate this in a simulation study</p>
<ul>
<li>n=15</li>
<li><span class="math inline">\(\mu=0\)</span> mmHg</li>
<li><span class="math inline">\(\sigma =9\)</span> mmHg</li>
<li>number of simulations 1000</li>
</ul>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">9</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate nsim samples of size n</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>deltaSim <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> nsim, mu, sigma), <span class="at">nrow =</span> n, <span class="at">ncol =</span> nsim)</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>pSim <span class="ot">&lt;-</span> <span class="fu">apply</span>(deltaSim, <span class="dv">2</span>, <span class="cf">function</span>(x, mu, alternative) <span class="fu">t.test</span>(x, <span class="at">mu =</span> mu, <span class="at">alternative =</span> alternative)<span class="sc">$</span>p.value, <span class="at">mu =</span> mu0, <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>)</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pSim <span class="sc">&lt;</span> alpha)</span></code></pre></div>
<pre><code>[1] 0.051</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>pSim <span class="sc">%&gt;%</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .)) <span class="sc">+</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<ul>
<li>The type I error is indeed about 0.05</li>
<li>The p-values are uniform</li>
</ul>
<hr />
</div>
<div id="type-ii-error" class="section level3" number="6.6.3">
<h3><span class="header-section-number">6.6.3</span> Type II error</h3>
<ul>
<li><p>Determine the type II error is less evident.</p></li>
<li><p>We have to reason under <span
class="math inline">\(H_1\)</span></p></li>
<li><p>In the captopril voorbeeld is <span class="math inline">\(H_1:
\mu&lt;0\)</span></p></li>
<li><p>Many alternatives are possible</p></li>
<li><p>The distribution under <span class="math inline">\(H_1\)</span>
is not fully specified</p></li>
<li><p><em>work-around:</em> choose one specific distribution under
<span class="math inline">\(H_1\)</span>.</p></li>
</ul>
<p><span class="math display">\[H_1(\delta): \mu=0-\delta \text{ for
}\delta&gt;0.\]</span></p>
<ul>
<li><p>e.g. a blood pressure difference of 2 mmHg</p></li>
<li><p>1-type II is also referred to as the power. It is the probability
to pick up the alternative.</p></li>
<li><p>It is not guaranteed by the design of the test</p></li>
<li><p>It depends on the experimental design of the study</p></li>
</ul>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">9</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate nsim samples of size n</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>deltaSim <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> nsim, mu, sigma), <span class="at">nrow =</span> n, <span class="at">ncol =</span> nsim)</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>pSim <span class="ot">&lt;-</span> <span class="fu">apply</span>(deltaSim, <span class="dv">2</span>, <span class="cf">function</span>(x, mu, alternative) <span class="fu">t.test</span>(x, <span class="at">mu =</span> mu, <span class="at">alternative =</span> alternative)<span class="sc">$</span>p.value, <span class="at">mu =</span> mu0, <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>)</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pSim <span class="sc">&lt;</span> alpha)</span></code></pre></div>
<pre><code>[1] 0.2083</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>pSim <span class="sc">%&gt;%</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .)) <span class="sc">+</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-47-1.png" width="672" />
- We observe that a power of 0.2083 or a type II error of 0.7917.</p>
<hr />
<ul>
<li>When we increase the sample size</li>
</ul>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">9</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate nsim samples of size n</span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>deltaSim <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> nsim, mu, sigma), <span class="at">nrow =</span> n, <span class="at">ncol =</span> nsim)</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>pSim <span class="ot">&lt;-</span> <span class="fu">apply</span>(deltaSim, <span class="dv">2</span>, <span class="cf">function</span>(x, mu, alternative) <span class="fu">t.test</span>(x, <span class="at">mu =</span> mu, <span class="at">alternative =</span> alternative)<span class="sc">$</span>p.value, <span class="at">mu =</span> mu0, <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>)</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pSim <span class="sc">&lt;</span> alpha)</span></code></pre></div>
<pre><code>[1] 0.3232</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>pSim <span class="sc">%&gt;%</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .)) <span class="sc">+</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<ul>
<li>Increasing the sample size leads to a higher power.</li>
<li>Still the power to pick up such a small blood pressure drop remains
very low.</li>
<li>A drop of 2 mmHg is also not relevant for drug companies.</li>
</ul>
<p><embed src="https://www.nature.com/articles/nmeth.2738.pdf"
style="width:100.0%" /></p>
<hr />
</div>
<div id="interpretation" class="section level3" number="6.6.4">
<h3><span class="header-section-number">6.6.4</span> Interpretation</h3>
<p>Suppose that given a particular sample <span
class="math inline">\(p&lt;\alpha\)</span>, i.e. reject <span
class="math inline">\(H_0\)</span></p>
<ul>
<li><p>Two possibilities</p>
<ul>
<li>correct decision,
<ul>
<li>or type I error.</li>
</ul></li>
</ul></li>
<li><p>We known that the probability on a type error is low, i.e. <span
class="math inline">\(\alpha=0.05\)</span>.</p></li>
</ul>
<p>On the other hand, when <span
class="math inline">\(p\geq\alpha\)</span> and we do not reject <span
class="math inline">\(H_0\)</span> we also have two options:</p>
<ul>
<li>Correct decision,</li>
<li>or we made a type II error.</li>
</ul>
<p>The probability on a type II error (<span
class="math inline">\(\beta\)</span>) is not controlled at a specific
value.</p>
<p>Statistical test is constructed to only control the probability on a
type I error at <span class="math inline">\(\alpha\)</span>.</p>
<p>To be scientifically correct we have to take a pessimistic attitude
and we have to admit that <span class="math inline">\(\beta\)</span> can
be large (i.e. a small power to detect the alternative).</p>
<p>Hence,</p>
<ul>
<li><p><span class="math inline">\(p &lt; \alpha\)</span> we reject
<span class="math inline">\(H_0\)</span></p>
<ul>
<li>We conclude that <span class="math inline">\(H_1\)</span> is
probably correct.
<ul>
<li>We refer to this as a strong conclusion.</li>
</ul></li>
</ul></li>
<li><p><span class="math inline">\(p \geq \alpha\)</span> accept <span
class="math inline">\(H_0\)</span></p>
<ul>
<li>Does not imply that we accept <span
class="math inline">\(H_0\)</span> correctly.</li>
<li>We can only conclude that the data do not have enough evidence
against the <span class="math inline">\(H_0\)</span> in favour of <span
class="math inline">\(H_1\)</span>.</li>
<li>We refer to this as a weak conclusion.</li>
<li>We typically conclude that the effect of the treatment is not
significant.</li>
</ul></li>
</ul>
<hr />
</div>
</div>
<div id="conclusions-captopril-example" class="section level2"
number="6.7">
<h2><span class="header-section-number">6.7</span> Conclusions captopril
example</h2>
<p>The test we have performed is referred to as</p>
<ul>
<li><p>the <strong>one sample t-test</strong> on the difference
or</p></li>
<li><p>a <strong>paired t-test</strong>. Indeed we dispose of paired
observations for each patient!</p></li>
<li><p>The test is done one-sided because we test against the
alternative of a blood pressure drop.</p></li>
<li><p>Both tests (one sample t-test on the difference and paired
t-test) give the same results:</p></li>
</ul>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(captopril<span class="sc">$</span>deltaSBP, <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>)</span></code></pre></div>
<pre><code>
    One Sample t-test

data:  captopril$deltaSBP
t = -8.1228, df = 14, p-value = 5.732e-07
alternative hypothesis: true mean is less than 0
95 percent confidence interval:
      -Inf -14.82793
sample estimates:
mean of x 
-18.93333 </code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(captopril<span class="sc">$</span>SBPa, captopril<span class="sc">$</span>SBPb, <span class="at">paired =</span> <span class="cn">TRUE</span>, <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>)</span></code></pre></div>
<pre><code>
    Paired t-test

data:  captopril$SBPa and captopril$SBPb
t = -8.1228, df = 14, p-value = 5.732e-07
alternative hypothesis: true difference in means is less than 0
95 percent confidence interval:
      -Inf -14.82793
sample estimates:
mean of the differences 
              -18.93333 </code></pre>
<hr />
<div id="conclusion" class="section level3" number="6.7.1">
<h3><span class="header-section-number">6.7.1</span> Conclusion</h3>
<p>There is on average an extremely significant blood pressure drop upon
administering captopril to patients with hypertension. The systolic
blood pressure decreases on average with 18.9 mmHg upon the treatment
with captopril (95% CI [<span
class="math inline">\(-\infty,-14.82\)</span>] mmHg).</p>
<p>Note that</p>
<ol style="list-style-type: decimal">
<li><p>A one-sided interval is reported because we are only interested
in a blood pressure drop.</p></li>
<li><p>Because of the pre-test/post-test design we cannot distinguish
between the effect of the treatment and a placebo effect. There was no
good control! The lack of a good control typically occurs in
pre-test/post-test designs. How could we have improved the
design?</p></li>
</ol>
<hr />
</div>
</div>
<div id="one-sided-or-two-side-testing" class="section level2"
number="6.8">
<h2><span class="header-section-number">6.8</span> One-sided or two-side
testing?</h2>
<p>De test in the captopril example was a one-sided test. We only aim to
detect if the captopril treatment on average reduces the blood
pressure.</p>
<p>Suppose that we defined the blood pressure difference as <span
class="math inline">\(X_{i}^\prime=Y_{i}^\text{before}-Y_{i}^\text{after}\)</span></p>
<ul>
<li><p>Now, a positive value indicates a blood pressure drop</p></li>
<li><p>The average change in blood pressure is now denote as <span
class="math inline">\(\mu^\prime=\text{E}[X^\prime]\)</span>.</p></li>
<li><p>So now we should use a one-sided test to assess <span
class="math inline">\(H_0: \mu^\prime=0\)</span> against <span
class="math inline">\(H_1: \mu^\prime&gt;0\)</span>.</p></li>
<li><p>p-value now becomes: <span
class="math display">\[p=\text{P}_0\left[T\geq
t\right].\]</span></p></li>
</ul>
<hr />
<p>Analysis based on <span class="math inline">\(X^\prime\)</span>:
Argument <code>alternative="greater"</code> so that we use <span
class="math inline">\(H_1: \mu^\prime&gt;0\)</span>:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(captopril<span class="sc">$</span>SBPb <span class="sc">-</span> captopril<span class="sc">$</span>SBPa, <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>)</span></code></pre></div>
<pre><code>
    One Sample t-test

data:  captopril$SBPb - captopril$SBPa
t = 8.1228, df = 14, p-value = 5.732e-07
alternative hypothesis: true mean is greater than 0
95 percent confidence interval:
 14.82793      Inf
sample estimates:
mean of x 
 18.93333 </code></pre>
<p>Of course we obtain the same results. Only the sign is swapped.</p>
<hr />
<div id="two-sided-test" class="section level3" number="6.8.1">
<h3><span class="header-section-number">6.8.1</span> Two-sided test</h3>
<p>Suppose that researchers wanted to assess the mode of action of the
new drug captopril in the design phase and suppose that healthy subjects
were used in an early phase of the drug development.</p>
<p>In this case it would have been interesting to observe blood pressure
drops as well as gains.</p>
<p>Then we would require a two-sided test strategy</p>
<p><span class="math display">\[H_0: \mu=0\]</span> against the
alternative hypothesis</p>
<p><span class="math display">\[H_1: \mu\neq0,\]</span></p>
<p>so that the mean under the alternative is different from zero.</p>
<p>It can be positive as well as negative changes and we did not know
upfront in which direction the real mean will deviate from <span
class="math inline">\(H_1\)</span>.</p>
<p>We can conduct a two-sided test on the <span
class="math inline">\(\alpha=5\%\)</span> significance level by</p>
<p><img src="05-statisticalInference_files/figure-html/unnamed-chunk-52-1.png" width="100%" style="display: block; margin: auto;" /></p>
<hr />
<p>The argument <code>alternative</code> of the <code>t.test</code>
function is by default <code>alternative="two.sided"</code>.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(captopril<span class="sc">$</span>deltaSBP)</span></code></pre></div>
<pre><code>
    One Sample t-test

data:  captopril$deltaSBP
t = -8.1228, df = 14, p-value = 1.146e-06
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 -23.93258 -13.93409
sample estimates:
mean of x 
-18.93333 </code></pre>
<ul>
<li>We still obtain an extremely significant result.</li>
<li>The p-value is double as large because we test two-sided.</li>
</ul>
<p>Indeed</p>
<p><span class="math display">\[p=P_0[T \leq -\vert t \vert] + P_0[T
\geq \vert t \vert] = P_0[\vert T \vert \geq \vert t \vert] = 2 \times
P_0[T \geq \vert t \vert]\]</span></p>
<ul>
<li>We also obtain a two-sided confidence interval</li>
</ul>
<hr />
</div>
<div id="one-sided-or-two-sided-test" class="section level3"
number="6.8.2">
<h3><span class="header-section-number">6.8.2</span> One-sided or
two-sided test?</h3>
<p>With a one-sided test we can more easily reject <span
class="math inline">\(H_0\)</span> on condition that <span
class="math inline">\(H_1\)</span> is true than with a two-sided
test.</p>
<ul>
<li><p>All information is used to test into one direction</p></li>
<li><p>The decision to test one-sided has to be done in the design phase
before the experiment is conducted</p></li>
<li><p>Even if we have strong a priori presumptions, we are not entirely
sure otherwise we would have no reason to do the research.</p></li>
<li><p>If we propose a one-sided test in the design phase and we observe
a result in the opposite direction that would be statistically
significant we can not draw conclusions from the experiment.</p></li>
<li><p>In the design phase we have excluded this result because it is so
unexpected that it has to be a false positive.</p></li>
<li><p>Hence, one-sided tests are not recommended.</p></li>
</ul>
<p>A two-sided test can always be defended and allows you to detect any
deviation of <span class="math inline">\(H_0\)</span> and is highly
recommended.</p>
<p>It is <strong>never allowed</strong> to change a two-sided test into
a one-sided test based on what has been observed in the sample!
Otherwise the type I error of the test strategy is not correctly
controlled.</p>
<hr />
<p>We illustrate this in the simulation study below:</p>
<ol style="list-style-type: decimal">
<li>correct two-sided test and</li>
<li>one-sided test with its sign based on what was observed in the
sample.</li>
</ol>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fl">9.0</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>nSim <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>pvalsCor <span class="ot">&lt;-</span> pvalsInCor <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="dv">0</span>, nSim)</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nSim)</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma)</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>  pvalsCor[i] <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x)<span class="sc">$</span>p.value</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">mean</span>(x) <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>    pvalsInCor[i] <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x, <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>    pvalsInCor[i] <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x, <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pvalsCor <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>[1] 0.058</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pvalsInCor <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>[1] 0.113</code></pre>
<ul>
<li>Type I error correctly controlled at <span
class="math inline">\(\alpha\)</span> for two-sided test.</li>
<li>Type I error not correctly controlled when we test one-sided based
on what we observed in the sample.</li>
</ul>
</div>
</div>
</div>
<div id="nature-column-on-testing" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Nature column on
testing</h1>
<p><embed src="https://www.nature.com/articles/nmeth.2698.pdf"
style="width:100.0%" /></p>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiNS4gU3RhdGlzdGljYWwgSW5mZXJlbmNlIgphdXRob3I6ICJMaWV2ZW4gQ2xlbWVudCIKZGF0ZTogInN0YXRPbWljcywgR2hlbnQgVW5pdmVyc2l0eSAoaHR0cHM6Ly9zdGF0b21pY3MuZ2l0aHViLmlvKSIKLS0tCgo8YSByZWw9ImxpY2Vuc2UiIGhyZWY9Imh0dHBzOi8vY3JlYXRpdmVjb21tb25zLm9yZy9saWNlbnNlcy9ieS1uYy1zYS80LjAiPjxpbWcgYWx0PSJDcmVhdGl2ZSBDb21tb25zIExpY2Vuc2UiIHN0eWxlPSJib3JkZXItd2lkdGg6MCIgc3JjPSJodHRwczovL2kuY3JlYXRpdmVjb21tb25zLm9yZy9sL2J5LW5jLXNhLzQuMC84OHgzMS5wbmciIC8+PC9hPgoKYGBge3Igc2V0dXAsIGluY2x1ZGU9RkFMU0UsIGNhY2hlPUZBTFNFfQprbml0cjo6b3B0c19jaHVuayRzZXQoCiAgaW5jbHVkZSA9IFRSVUUsIGNvbW1lbnQgPSBOQSwgZWNobyA9IFRSVUUsCiAgbWVzc2FnZSA9IEZBTFNFLCB3YXJuaW5nID0gRkFMU0UsIGNhY2hlID0gVFJVRQopCmxpYnJhcnkodGlkeXZlcnNlKQpgYGAKCgpgYGB7ciBpbmNsdWRlPUZBTFNFfQojIERvIG5vdCBydW4gZHVyaW5nIHRoZSBsZWN0dXJlIHdoZW4gd2Ugd29yayBpbnRlcmFjdGl2ZWx5CnNldC5zZWVkKDEzMTQpCmBgYAoKIyBJbnRyb2R1Y3Rpb24KIyMgUG9wdWxhdGlvbgoKLSBUaGUgYWltIG9mIGEgc2NpZW50aWZpYyBzdHVkeSBpcyB0byBkcmF3IGNvbmNsdXNpb25zIG9uIHRoZSBnZW5lcmFsIHBvcHVsYXRpb24uCgotIEhlcmUsIHdlIHN0dWR5IHRoZSBlZmZlY3Qgb2YgY2FwdG9wcmlsIG9uIHRoZSBibG9vZCBwcmVzc3VyZSBvZiBwYXRpZW50cyB3aXRoIGh5cGVydGVuc2lvbi4KCi0gV2Ugd2lsbCBjb2xsZWN0IGRhdGEgYW5kIHdlIHdpbGwgbW9kZWwgdGhlIGRhdGEKCi0gVGhlcmVmb3JlLCB3ZSBhbHdheXMgaGF2ZSB0byB0cmFuc2xhdGUgdGhlIHJlc2VhcmNoIHF1ZXN0aW9uIGludG8gYW4gZWZmZWN0IHNpemUgdGhhdCBjYW4gYmUgZXN0aW1hdGVkIHdpdGggYSBtb2RlbCBwYXJhbWV0ZXIgb3IgYSBjb21iaW5hdGlvbiBvZiBtb2RlbCBwYXJhbWV0ZXJzLgoKLSBlLmcuIHRoZSBwb3B1bGF0aW9uIG1lYW4KICAgJCRFKFgpPVxtdSQkCgotIERvZXMgdGhlIGJsb29kIHByZXNzdXJlIGRlY3JlYXNlcyBvbiBhdmVyYWdlIGFmdGVyIGFkbWluaXN0ZXJpbmcgY2FwdG9wcmlsIHRvIHBhdGllbnRzIHdpdGggaHlwZXJ0ZW5zaW9uPwoKLS0tCgojIyBPdmVydmlldwoKLSBFeHBlcmltZW50YWwgRGVzaWduICYgRGF0YSBFeHBsb3JhdGlvbgotIFBvaW50IGVzdGltYXRvcnMgKEVzdGltYXRpb24pCi0gSW50ZXJ2YWwgZXN0aW1hdG9ycyAoU3RhdGlzdGljYWwgaW5mZXJlbmNlKQotIEh5cG90aGVzaXMgdGVzdHMgKFN0YXRpc3RpY2FsIGluZmVyZW5jZSkKCi0tLQoKIyBFeHBlcmltZW50YWwgRGVzaWduCgotIDE1IHBhdGllbnRzIHdlcmUgZHJhd24gYXQgcmFuZG9tIGZyb20gdGhlIHBvcHVsYXRpb24gb2YgcGF0aWVudHMgd2l0aCBoeXBlcnRlbnNpb24KLSBwcmUtdGVzdC9wb3N0LXRlc3QgZGVzaWduOiB0aGUgc3lzdG9saWMgYW5kIGRpYXN5c3RvbGljIGJsb29kIHByZXNzdXJlIGFyZSBtZWFzdXJlZCBiZWZvcmUgYW5kIGFmdGVyIGFkbWluaXN0ZXJpbmcgY2FwdG9wcmlsCi0gQWR2YW50YWdlOiB3ZSBjYW4gYXNzZXNzIHRoZSBlZmZlY3Qgb2YgYWRtaW5pc3RlcmluZyBjYXB0b3ByaWwgb24gdGhlIGJsb29kIHByZXNzdXJlIGZvciBlYWNoIGluZGl2aWR1YWwgcGF0aWVudC4KLSBEaXNhZHZhbnRhZ2U/CgpgYGB7ciBwb3AyU2FtcDJQb3AsZmlnLmFzcD0uOCwgZmlnLmFsaWduPSdjZW50ZXInLGVjaG89RkFMU0V9CmlmICgicGkiICVpbiUgbHMoKSkgcm0oInBpIikKa29wdm9ldGVyIDwtIGZ1bmN0aW9uKHgsIHksIGFuZ2xlID0gMCwgbCA9IC4yLCBjZXguZG90ID0gLjUsIHBjaCA9IDE5LCBjb2wgPSAiYmxhY2siKSB7CiAgYW5nbGUgPC0gYW5nbGUgLyAxODAgKiBwaQogIHBvaW50cyh4LCB5LCBjZXggPSBjZXguZG90LCBwY2ggPSBwY2gsIGNvbCA9IGNvbCkKICBsaW5lcyhjKHgsIHggKyBsICogY29zKC1waSAvIDIgKyBhbmdsZSkpLCBjKHksIHkgKyBsICogc2luKC1waSAvIDIgKyBhbmdsZSkpLCBjb2wgPSBjb2wpCiAgbGluZXMoYyh4ICsgbCAvIDIgKiBjb3MoLXBpIC8gMiArIGFuZ2xlKSwgeCArIGwgLyAyICogY29zKC1waSAvIDIgKyBhbmdsZSkgKyBsIC8gNCAqIGNvcyhhbmdsZSkpLCBjKHkgKyBsIC8gMiAqIHNpbigtcGkgLyAyICsgYW5nbGUpLCB5ICsgbCAvIDIgKiBzaW4oLXBpIC8gMiArIGFuZ2xlKSArIGwgLyA0ICogc2luKGFuZ2xlKSksIGNvbCA9IGNvbCkKICBsaW5lcyhjKHggKyBsIC8gMiAqIGNvcygtcGkgLyAyICsgYW5nbGUpLCB4ICsgbCAvIDIgKiBjb3MoLXBpIC8gMiArIGFuZ2xlKSArIGwgLyA0ICogY29zKHBpICsgYW5nbGUpKSwgYyh5ICsgbCAvIDIgKiBzaW4oLXBpIC8gMiArIGFuZ2xlKSwgeSArIGwgLyAyICogc2luKC1waSAvIDIgKyBhbmdsZSkgKyBsIC8gNCAqIHNpbihwaSArIGFuZ2xlKSksIGNvbCA9IGNvbCkKICBsaW5lcyhjKHggKyBsICogY29zKC1waSAvIDIgKyBhbmdsZSksIHggKyBsICogY29zKC1waSAvIDIgKyBhbmdsZSkgKyBsIC8gMiAqIGNvcygtcGkgLyAyICsgcGkgLyA0ICsgYW5nbGUpKSwgYyh5ICsgbCAqIHNpbigtcGkgLyAyICsgYW5nbGUpLCB5ICsgbCAqIHNpbigtcGkgLyAyICsgYW5nbGUpICsgbCAvIDIgKiBzaW4oLXBpIC8gMiArIHBpIC8gNCArIGFuZ2xlKSksIGNvbCA9IGNvbCkKICBsaW5lcyhjKHggKyBsICogY29zKC1waSAvIDIgKyBhbmdsZSksIHggKyBsICogY29zKC1waSAvIDIgKyBhbmdsZSkgKyBsIC8gMiAqIGNvcygtcGkgLyAyIC0gcGkgLyA0ICsgYW5nbGUpKSwgYyh5ICsgbCAqIHNpbigtcGkgLyAyICsgYW5nbGUpLCB5ICsgbCAqIHNpbigtcGkgLyAyICsgYW5nbGUpICsgbCAvIDIgKiBzaW4oLXBpIC8gMiAtIHBpIC8gNCArIGFuZ2xlKSksIGNvbCA9IGNvbCkKfQoKcGFyKG1hciA9IGMoMCwgMCwgMCwgMCksIG1haSA9IGMoMCwgMCwgMCwgMCkpCnBsb3QoMCwgMCwgeGxhYiA9ICIiLCB5bGFiID0gIiIsIHhsaW0gPSBjKDAsIDEwKSwgeWxpbSA9IGMoMCwgMTApLCBjb2wgPSAwLCB4YXh0ID0gIm5vbmUiLCB5YXh0ID0gIm5vbmUiLCBheGVzID0gRkFMU0UpCnJlY3QoMCwgNiwgMTAsIDEwLCBib3JkZXIgPSAicmVkIiwgbHdkID0gMikKdGV4dCguNSwgOCwgInBvcHVsYXRpb24iLCBzcnQgPSA5MCwgY29sID0gInJlZCIsIGNleCA9IDIpCnN5bWJvbHMoMywgOCwgY2lyY2xlcyA9IDEuNSwgY29sID0gInJlZCIsIGFkZCA9IFRSVUUsIGZnID0gInJlZCIsIGluY2hlcyA9IEZBTFNFLCBsd2QgPSAyKQpncmlkIDwtIHNlcSgwLCAxLjMsIC4wMSkKCmZvciAoaSBpbiAxOjUwKQp7CiAgYW5nbGUxIDwtIHJ1bmlmKG4gPSAxLCBtaW4gPSAwLCBtYXggPSAzNjApCiAgYW5nbGUyIDwtIHJ1bmlmKG4gPSAxLCBtaW4gPSAwLCBtYXggPSAzNjApCiAgcmFkaXVzIDwtIHNhbXBsZShncmlkLCBwcm9iID0gZ3JpZF4yICogcGkgLyBzdW0oZ3JpZF4yICogcGkpLCBzaXplID0gMSkKICBrb3B2b2V0ZXIoMyArIHJhZGl1cyAqIGNvcyhhbmdsZTEgLyAxODAgKiBwaSksIDggKyByYWRpdXMgKiBzaW4oYW5nbGUxIC8gMTgwICogcGkpLCBhbmdsZSA9IGFuZ2xlMikKfQp0ZXh0KDcuNSwgOCwgIkVmZmVjdCBvZiBjYXB0b3ByaWwgaW4gcG9wdWxhdGlvbiIsIGNvbCA9ICJyZWQiLCBjZXggPSAxLjIpCgpyZWN0KDAsIDAsIDEwLCA0LCBib3JkZXIgPSAiYmx1ZSIsIGx3ZCA9IDIpCnRleHQoLjUsIDIsICJzYW1wbGUiLCBzcnQgPSA5MCwgY29sID0gImJsdWUiLCBjZXggPSAyKQpzeW1ib2xzKDMsIDIsIGNpcmNsZXMgPSAxLjUsIGNvbCA9ICJyZWQiLCBhZGQgPSBUUlVFLCBmZyA9ICJibHVlIiwgaW5jaGVzID0gRkFMU0UsIGx3ZCA9IDIpCmZvciAoaSBpbiAwOjIpIHsKICBmb3IgKGogaW4gMDo0KQogIHsKICAgIGtvcHZvZXRlcigyLjEgKyBqICogKDMuOSAtIDIuMSkgLyA0LCAxLjEgKyBpKQogIH0KfQp0ZXh0KDcuNSwgMiwgIkVmZmVjdCBvZiBjYXB0b3ByaWwgaW4gc2FtcGxlIiwgY29sID0gImJsdWUiLCBjZXggPSAxLjIpCgphcnJvd3MoMywgNS45LCAzLCA0LjEsIGNvbCA9ICJibGFjayIsIGx3ZCA9IDMpCmFycm93cyg3LCA0LjEsIDcsIDUuOSwgY29sID0gImJsYWNrIiwgbHdkID0gMykKdGV4dCgxLjUsIDUsICJFWFAuIERFU0lHTiAoMSkiLCBjb2wgPSAiYmxhY2siLCBjZXggPSAxLjIpCnRleHQoOC41LCA1LCAiRVNUSU1BVElPTiAmXG5JTkZFUkVOQ0UgKDMpIiwgY29sID0gImJsYWNrIiwgY2V4ID0gMS4yKQp0ZXh0KDcuNSwgLjUsICJEQVRBIEVYUExPUkFUSU9OICZcbkRFU0NSSVBUSVZFIFNUQVRJU1RJQ1MgKDIpIiwgY29sID0gImJsYWNrIiwgY2V4ID0gMS4yKQpgYGAKCi0tLQoKIyBEYXRhIGV4cGxvcmF0aW9uIGFuZCBEZXNjcmlwdGl2ZSBTdGF0aXN0aWNzCgpgYGB7cn0KY2FwdG9wcmlsIDwtIHJlYWRfY3N2KCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vR1RQQi9QU0xTMjAvbWFzdGVyL2RhdGEvY2FwdG9wcmlsLnR4dCIpCmhlYWQoY2FwdG9wcmlsKQpzdW1tYXJ5KGNhcHRvcHJpbCkKYGBgCgpgYGB7cn0KY2FwdG9wcmlsVGlkeSA8LSBjYXB0b3ByaWwgJT4lIGdhdGhlcih0eXBlLCBicCwgLWlkKQpjYXB0b3ByaWxUaWR5ICU+JQogIGdyb3VwX2J5KHR5cGUpICU+JQogIHN1bW1hcml6ZV9hdCgiYnAiLCBsaXN0KAogICAgbWVhbiA9IH4gbWVhbiguLCBuYS5ybSA9IFRSVUUpLAogICAgc2QgPSB+IHNkKC4sIG5hLnJtID0gVFJVRSksCiAgICBuID0gZnVuY3Rpb24oeCkgewogICAgICB4ICU+JQogICAgICAgIGlzLm5hKCkgJT4lCiAgICAgICAgYCFgKCkgJT4lCiAgICAgICAgc3VtKCkKICAgIH0KICApKSAlPiUKICBtdXRhdGUoc2UgPSBzZCAvIHNxcnQobikpCgpjYXB0b3ByaWxUaWR5ICU+JQogIGdyb3VwX2J5KHR5cGUpICU+JQogIHN1bW1hcml6ZV9hdCgiYnAiLCBsaXN0KAogICAgbWVhbiA9IH4gbWVhbiguLCBuYS5ybSA9IFRSVUUpLAogICAgc2QgPSB+IHNkKC4sIG5hLnJtID0gVFJVRSksCiAgICBuID0gZnVuY3Rpb24oeCkgewogICAgICB4ICU+JQogICAgICAgIGlzLm5hKCkgJT4lCiAgICAgICAgYCFgKCkgJT4lCiAgICAgICAgc3VtKCkKICAgIH0KICApKSAlPiUKICBtdXRhdGUoc2UgPSBzZCAvIHNxcnQobikpICU+JQogIGdncGxvdChhZXMoeCA9IHR5cGUsIHkgPSBtZWFuKSkgKwogIGdlb21fYmFyKHN0YXQgPSAiaWRlbnRpdHkiKSArCiAgZ2VvbV9lcnJvcmJhcihhZXMoeW1pbiA9IG1lYW4gLSBzZSwgeW1heCA9IG1lYW4gKyBzZSksIHdpZHRoID0gLjIpICsKICB5bGltKDAsIDIxMCkgKwogIHlsYWIoImJsb29kIHByZXNzdXJlIChtbUhnKSIpCmBgYAoKLSBUaGlzIGZpZ3VyZSBpcyBub3QgaW5mb3JtYXRpdmUhIEl0IGRvZXMgbm90IHNob3cgdGhlIHJhdyBkYXRhLgoKYGBge3J9CmNhcHRvcHJpbFRpZHkgJT4lCiAgZ2dwbG90KGFlcyh4ID0gdHlwZSwgeSA9IGJwKSkgKwogIGdlb21fYm94cGxvdChvdXRsaWVyLnNoYXBlID0gTkEpICsKICBnZW9tX3BvaW50KHBvc2l0aW9uID0gImppdHRlciIpICsKICB5bGltKDAsIDIxMCkKYGBgCgpXZSBzZWUgdGhhdCBhIGxvdCBvZiB0aGUgc3BhY2UgdGhhdCB3YXMgdGFrZW4gYnkgdGhlIGJhcnBsb3QgZG9lcyBub3QgY29udGFpbiBkYXRhIQoKYGBge3J9CmNhcHRvcHJpbFRpZHkgJT4lCiAgZ2dwbG90KGFlcyh4ID0gdHlwZSwgeSA9IGJwKSkgKwogIGdlb21fYm94cGxvdChvdXRsaWVyLnNoYXBlID0gTkEpICsKICBnZW9tX3BvaW50KHBvc2l0aW9uID0gImppdHRlciIpCmBgYAoKLSBUaGlzIHBsb3Qgd291bGQgaGF2ZSBiZWVuIGluZm9ybWF0aXZlIGlmIHRoZSBkYXRhIHdhcyBnYXRoZXJlZCBvbiBkaWZmZXJlbnQgaW5kaXZpZHVhbHMuCgotIEhvd2V2ZXIsIHRoZSBibG9vZCBwcmVzc3VyZXMgYXJlIG1lYXN1cmVkIG9wIHRoZSBzYW1lIHN1YmplY3QhCgotIFdlIHdpbGwgbWFrZSBhIHBsb3QgYnkgZmlsdGVyaW5nIHRoZSBzeXN0b2xpYyBibG9vZCBwcmVzc3VyZXMKCmBgYHtyfQpjYXB0b3ByaWxUaWR5ICU+JQogIGZpbHRlcih0eXBlICVpbiUgYygiU0JQYSIsICJTQlBiIikpICU+JQogIG11dGF0ZSh0eXBlID0gZmFjdG9yKHR5cGUsIGxldmVscyA9IGMoIlNCUGIiLCAiU0JQYSIpKSkgJT4lCiAgZ2dwbG90KGFlcyh4ID0gdHlwZSwgeSA9IGJwKSkgKwogIGdlb21fbGluZShhZXMoZ3JvdXAgPSBpZCkpICsKICBnZW9tX3BvaW50KCkKYGBgCgotIFdlIGhhdmUgcGFpcmVkIGRhdGEuIFNvIHdlIG1pZ2h0IGVzdGltYXRlIHRoZSBlZmZlY3Qgb2YgdGhlIHRyZWF0bWVudCBkaXJlY3RseSBieSBjb21wYXJpbmcgdGhlIGJsb29kIHByZXNzdXJlIGFmdGVyIHRyZWF0bWVudCB0byB0aGUgYmxvb2QgcHJlc3N1cmUgYmVmb3JlIHRoZSB0cmVhdG1lbnQuCgpgYGB7cn0KY2FwdG9wcmlsJGRlbHRhU0JQIDwtIGNhcHRvcHJpbCRTQlBhIC0gY2FwdG9wcmlsJFNCUGIKY2FwdG9wcmlsICU+JQogIGdncGxvdChhZXMoeCA9ICJTeXN0b2xpYyBibG9vZCBwcmVzc3VyZSIsIHkgPSBkZWx0YVNCUCkpICsKICBnZW9tX2JveHBsb3Qob3V0bGllci5zaGFwZSA9IE5BKSArCiAgZ2VvbV9wb2ludChwb3NpdGlvbiA9ICJqaXR0ZXIiKSArCiAgeWxhYigiRGlmZmVyZW5jZSAobW0gbWVyY3VyeSkiKSArCiAgeGxhYigiIikKYGBgCgpgYGB7cn0KY2FwdG9wcmlsICU+JQogIHN1bW1hcml6ZV9hdCgiZGVsdGFTQlAiLCBsaXN0KAogICAgbWVhbiA9IH4gbWVhbiguLCBuYS5ybSA9IFRSVUUpLAogICAgc2QgPSB+IHNkKC4sIG5hLnJtID0gVFJVRSksCiAgICBuID0gZnVuY3Rpb24oeCkgewogICAgICB4ICU+JQogICAgICAgIGlzLm5hKCkgJT4lCiAgICAgICAgYCFgKCkgJT4lCiAgICAgICAgc3VtKCkKICAgIH0KICApKSAlPiUKICBtdXRhdGUoc2UgPSBzZCAvIHNxcnQobikpCmBgYAoKCi0gUHJlLXRlc3QvcG9zdC10ZXN0IGRlc2lnbjogRWZmZWN0IG9mIGNhcHRvcHJpbCBpbiBzYW1wbGUgdXNpbmcgICRYPVxEZWx0YV9cdGV4dHthZnRlci1iZWZvcmV9JCEKCi0gSG93IHdpbGwgd2UgbW9kZWwgJFg9XERlbHRhX1x0ZXh0e2FmdGVyLW5hfSQgYW5kIGVzdGltYXRlIHRoZSBlZmZlY3Qgb2YgY2FwdG9wcmlsPwoKYGBge3J9CmNhcHRvcHJpbCAlPiUKICBnZ3Bsb3QoYWVzKHNhbXBsZSA9IGRlbHRhU0JQKSkgKwogIHN0YXRfcXEoKSArCiAgc3RhdF9xcV9saW5lKCkKYGBgCgpUaGUgc3lzdG9saWMgYmxvb2QgcHJlc3N1cmUgZGlmZmVyZW5jZXMgYXJlIGFwcHJveGltYXRlbHkgbm9ybWFsbHkgZGlzdHJpYnV0ZWQuCgotLS0KCiMgRXN0aW1hdGlvbgoKCi0gTm8gc3Vic3RhbnRpYWwgZGV2aWF0aW9ucyBmcm9tIG5vcm1hbGl0eQoKLSBXZSBjYW4gYXNzdW1lIHRoYXQgdGhlIGRpZmZlcmVuY2VzICAkWCBcc2ltIE4oXG11LCBcc2lnbWFeMikkLgoKLSBFZmZlY3Qgb2YgY2FwdG9wcmlsIGluIHRoZSBwb3B1bGF0aW9uIGlzIGNhcHR1cmVkIGJ5IHRoZSBhdmVyYWdlIGJsb29kIHByZXNzdXJlIGRpZmZlcmVuY2UgJFxtdSQuCgotIFRoZSBhdmVyYWdlIGJsb29kIHByZXNzdXJlICRcbXUkIGluIHRoZSBwb3B1bGF0aW9uIGNhbiBiZSBlc3RpbWF0ZWQgdXNpbmcgdGhlIHNhbXBsZSBtZWFuICRcYmFyIHgkPWByIHJvdW5kKG1lYW4oY2FwdG9wcmlsJGRlbHRhU0JQKSwyKWAKCi0gVGhlIHN0YW5kYXJkIGRldmlhdGlvbiAkXHNpZ21hJCB3aXRoIHRoZSBzYW1wbGUgc3RhbmRhcmQgZGV2aWF0aW9uICRcdGV4dHtTfSQ9YHIgcm91bmQoc2QoY2FwdG9wcmlsJGRlbHRhU0JQKSwyKWAuCgotIElzIHRoZSBlZmZlY3QgdGhhdCB3ZSBvYnNlcnZlIGluIHRoZSBzYW1wbGUgbGFyZ2UgZW5vdWdoIHRvIGNvbmNsdWRlIHRoYXQgdGhlcmUgaXMgYW4gZWZmZWN0IG9mIHRoZSBjYXB0b3ByaWwgdHJlYXRtZW50IG9uIHRoZSBibG9vZCBwcmVzc3VyZSBhdCBwb3B1bGF0aW9uIGxldmVsPwoKLSBPdXIgZXN0aW1hdGVzIHdpbGwgY2hhbmdlIGZyb20gc2FtcGxlIHRvIHNhbXBsZSEKCi0gSG93IGFyZSB0aGUgZXN0aW1hdG9ycyAkXGJhciBYJCBhbmQgJFMkIGRpc3RyaWJ1dGVkPwoKCiMjIFBvaW50IGVzdGltYXRvciB0aGUgc2FtcGxlIG1lYW4KCi0gU3VwcG9zZSB0aGF0ICRYJCBpcyBhIHJhbmRvbSBzYW1wbGUgZnJvbSB0aGUgcG9wdWxhdGlvbiBhbmQgYXNzdW1lIHRoYXQgJFggXHNpbSBOKFxtdSxcc2lnbWFeMikkCgotIEVzdGltYXRlICRcbXUkIGJhc2VkIG9uIHNhbXBsZSAkWF8xLC4uLixYX24kLCB1c2luZyB0aGUgc2FtcGxlIG1lYW4KICAkJFxiYXIgWCA9IFxmcmFje1hfMSsgWF8yKyAuLi4gKyBYX259e259ID0gXGZyYWN7XHN1bV97aT0xfV57bn0gWF9pfXtufSQkIG9mIHJhbmRvbSB2YXJpYWJsZXMgJFhfMSxYXzIsIC4uLiwgWF9uJC4KCi0gU2FtcGxlIG1lYW4gJFxiYXIgWCQgaXMgYSByYW5kb20gdmFyaWFibGUgdGhhdCB2YXJpZXMgZnJvbSBzYW1wbGUgdG8gc2FtcGxlCgotIFN0dWR5IHRoZSB0aGVvcmV0aWNhbCBkaXN0cmlidXRpb24gb2YgdGhlIHNhbXBsZSBtZWFuIHRvIGdldCBpbnNpZ2h0CgogICAgMS4gaW4gaG93IHRoZSBzYW1wbGUgbWVhbiBjYW4gdmFyeSBpbiBhIG5ldyBzaW1pbGFyIHN0dWR5CiAgICAyLiBob3cgZmFyICRcYmFyIFgkIGNhbiBiZSBmcm9tIHRoZSBwb3B1bGF0aW9uIG1lYW4gJFxtdSQKCi0tLQoKIyMjIE92ZXJ2aWV3CgoxLiBUaGUgc2FtcGxlIG1lYW4gaXMgdW5iaWFzZWQKMi4gUHJlY2lzaW9uIG9mIHNhbXBsZSBtZWFuCjMuIERpc3RyaWJ1dGlvbiBvZiBzYW1wbGUgbWVhbgoKLS0tCgojIyMgVGhlIHNhbXBsZSBtZWFuIGlzIHVuYmlhc2VkCgotIFdlIGNhbiBnZW5lcmFsaXplIG91ciBvYnNlcnZhdGlvbnMgYmFzZWQgb24gdGhlIHNhbXBsZSB0b3dhcmRzIHRoZSBwb3B1bGF0aW9uIGlmIHRoZSBlc3RpbWF0ZSBpcyBnb29kIGFwcHJveGltYXRpb24gb2YgdGhlIHBvcHVsYXRpb24gdmFsdWUuCgotIEEgcmVwcmVzZW50YXRpdmUgc2FtcGxlIGlzIHJlcXVpcmVkIHRvIGdlbmVyYWxpemUgdGhlIHJlc3VsdHMgZnJvbSB0aGUgc2FtcGxlIHRvd2FyZHMgdGhlIHBvcHVsYXRpb24KCi0gQXZvaWQgYmlhcyAoc28gdGhhdCB0aGUgcG9wdWxhdGlvbiBtZWFuIGlzIG5vdCBzeXN0ZW1hdGljYWxseSB1bmRlciBvciBvdmVyZXN0aW1hdGVkKQoKLSBSZXBvcnQgaG93IHRoZSBzYW1wbGUgaXMgdGFrZW4hCgotIFJhbmRvbWlzYXRpb24hCgotIERyYXcgdGhlIHN1YmplY3RzIGF0IHJhbmRvbSBmcm9tIHBvcHVsYXRpb24gc28gZXZlcnkgc3ViamVjdCBoYXMgdGhlIHNhbWUgcHJvYmFiaWxpdHkgdG8gZW5kIHVwIGluIHRoZSBzYW1wbGUuCgotIFN1YmplY3RzIHdpdGggaHlwZXJ0ZW5zaW9uIGFyZSBzYW1wbGVkIGF0IHJhbmRvbSBmcm9tIHRoZSBwb3B1bGF0aW9uCgoKLSBTaW1wbGUgcmFuZG9tIHNhbXBsZTogICRYXzEsLi4uLFhfbiQgZm9yIGNoYXJhY3RlcmlzdGljICRYJAoKLSAkWF8xLC4uLixYX24kIGhhdmUgc2FtZSBkaXN0cmlidXRpb24KLSBUaGV5IGhhdmUgc2FtZSBtZWFuICRcbXUkIGFuZCB2YXJpYW5jZSAkXHNpZ21hXjIkCgotICRFKFhfMSk9Li4uPUUoWF9uKT1cbXUkIGFuZCAkXHRleHR7VmFyfShYXzEpPS4uLj1cdGV4dHtWYXJ9KFhfbik9XHNpZ21hXjIkCgotICRcYmFyIFgkIGlzIGFuICp1bmJpYXNlZCBlc3RpbWF0b3IqIGZvciAkXG11JAoKPGRldGFpbHM+PHN1bW1hcnk+Q2xpY2sgdG8gc2VlIHByb29mPC9zdW1tYXJ5PjxwPgpcYmVnaW57ZXFuYXJyYXkqfQpFKFxiYXIgWCkgJj0mIEUgXGxlZnQoXGZyYWN7WF8xKyBYXzIrIC4uLiArIFhfbn17bn1ccmlnaHQpIFxcCiY9ICYgXGZyYWN7RShYXzEpKyBFKFhfMikrIC4uLiArIEUoWF9uKX17bn0gXFwKJj0mIFxmcmFje1xtdSArIFxtdSArIC4uLiArXG11fXtufSBcXAomPSAmIFxtdQpcZW5ke2VxbmFycmF5Kn0KPC9wPjwvZGV0YWlscz4KCi0tLQoKIyMjIEltcHJlY2lzaW9uL3N0YW5kYXJkIGVycm9yCgotIEFsc28gZm9yIHJlcHJlc2VudGF0aXZlIHNhbXBsZXMgdGhlIHJlc3VsdHMgYXJlIGltcHJlY2lzZS4KXHZzcGFjZXsxMHB0fQotIERpZmZlcmVudCBzYW1wbGVzIGZyb20gdGhlIHNhbWUgcG9wdWxhdGlvbiBnaXZlIGRpZmZlcmVudCByZXN1bHRzLgoKLSBXZSBpbGx1c3RyYXRlZCB0aGlzIGJ5IHVzaW5nIHRoZSBOSEFORVMKCiAgICAtIFdlIHdpbGwgZHJhdyAxNSBmZW1hbGVzIGF0IHJhbmRvbSBmcm9tIHRoZSBOSEFORVMgc3R1ZHkgYW5kIHdlIHdpbGwgcmVnaXN0ZXIgdGhlaXIgbG9nMiBkaXJlY3QgY2hvbGVzdGVyb2wgdmFsdWVzCiAgICAtIFdlIHJlcGVhdCB0aGlzIDUwIHRpbWVzIHRvIGFzc2VzcyB0aGUgdmFyaWF0aW9uIGZyb20gc2FtcGxlIHRvIHNhbXBsZQogICAgLSBXZSB3aWxsIHBsb3QgdGhlIGJveHBsb3QgZm9yIGVhY2ggc2FtcGxlIGFuZCB3aWxsIGluZGljYXRlIHRoZSBtZWFuCgpgYGB7cn0KbGlicmFyeShOSEFORVMpCgpmZW0gPC0gTkhBTkVTICU+JQogIGZpbHRlcihHZW5kZXIgPT0gImZlbWFsZSIgJiAhaXMubmEoRGlyZWN0Q2hvbCkpICU+JQogIHNlbGVjdCgiRGlyZWN0Q2hvbCIpCgpuIDwtIDE1ICMgbnVtYmVyIG9mIHN1YmplY3RzIHBlciBzYW1wbGUKblNpbSA8LSA1MCAjIG51bWJlciBvZiBzaW11bGF0aW9ucwoKZmVtU2FtcCA8LSBtYXRyaXgobnJvdyA9IG4sIG5jb2wgPSBuU2ltKQpmb3IgKGogaW4gMTpuU2ltKQp7CiAgZmVtU2FtcFssIGpdIDwtIHNhbXBsZShmZW0kRGlyZWN0Q2hvbCwgMTUpCiAgaWYgKGogPCA0KSB7CiAgICBwIDwtIGZlbVNhbXAgJT4lCiAgICAgIGxvZzIoKSAlPiUKICAgICAgZGF0YS5mcmFtZSgpICU+JQogICAgICBnYXRoZXIoInNhbXBsZSIsICJsb2cyY2hvbGVzdGVyb2wiKSAlPiUKICAgICAgZ2dwbG90KGFlcyh4ID0gc2FtcGxlLCB5ID0gbG9nMmNob2xlc3Rlcm9sKSkgKwogICAgICBnZW9tX2JveHBsb3QoKSArCiAgICAgIHN0YXRfc3VtbWFyeShmdW4ueSA9IG1lYW4sIGdlb20gPSAicG9pbnQiLCBzaGFwZSA9IDE5LCBzaXplID0gMywgY29sb3IgPSAicmVkIiwgZmlsbCA9ICJyZWQiKSArCiAgICAgIGdlb21faGxpbmUoeWludGVyY2VwdCA9IG1lYW4oZmVtJERpcmVjdENob2wgJT4lIGxvZzIoKSkpICsKICAgICAgeWxhYigiY2hvbGVzdGVyb2wgKGxvZzIpIikKICAgIHByaW50KHApCiAgfQp9CgpmZW1TYW1wICU+JQogIGxvZzIoKSAlPiUKICBkYXRhLmZyYW1lKCkgJT4lCiAgZ2F0aGVyKCJzYW1wbGUiLCAibG9nMmNob2xlc3Rlcm9sIikgJT4lCiAgZ2dwbG90KGFlcyh4ID0gc2FtcGxlLCB5ID0gbG9nMmNob2xlc3Rlcm9sKSkgKwogIGdlb21fYm94cGxvdCgpICsKICBzdGF0X3N1bW1hcnkoZnVuLnkgPSBtZWFuLCBnZW9tID0gInBvaW50Iiwgc2hhcGUgPSAxOSwgc2l6ZSA9IDMsIGNvbG9yID0gInJlZCIsIGZpbGwgPSAicmVkIikgKwogIGdlb21faGxpbmUoeWludGVyY2VwdCA9IG1lYW4oZmVtJERpcmVjdENob2wgJT4lIGxvZzIoKSkpICsKICB5bGFiKCJjaG9sZXN0ZXJvbCAobG9nMikiKQpgYGAKCldlIG9ic2VydmUgdGhhdCB0aGUgbWVhbiBuaWNlbHkgZmx1Y3R1YXRlcyBhcm91bmQgdGhlIHBvcHVsYXRpb24gbWVhbi4KCkNvcHkgdGhlIGNvZGUsIGluY3JlYXNlIHRoZSBzYW1wbGUgc2l6ZSB0byAxMDAgc3ViamVjdHMgYW5kIG9ic2VydmUgd2hhdCBoYXBwZW5zIQoKLS0tCgojIyMgSG93IHRvIGRvIHRoaXMgYmFzZWQgb24gYSBzaW5nbGUgc2FtcGxlPwoKLSBJbnNpZ2h0IGluIGhvdyBjbG9zZSB3ZSBjYW4gZXhwZWN0ICRcYmFyIFgkIHRvICRcbXUkPwoKLSBIb3cgdmFyaWVzICRcYmFyIFgkIGZyb20gc2FtcGxlIHRvIHNhbXBsZT8KCi0gVmFyaWFiaWxpdHkgb24gJFxiYXIgWCQKCi0gV2UgaGF2ZSB0byBkZXRlcm1pbmUgdGhpcyBiYXNlZCBvbiBhIHNpbmdsZSBzYW1wbGUhCgotIFdlIG5lZWQgdG8gbWFrZSBhc3N1bXB0aW9ucwoKLSBXZSBhc3N1bWUgdGhhdCB0aGUgcmFuZG9tIHZhcmlhYmxlcyAkWF8xLCBYXzIsIC4uLiwgWF9uJCBvcmlnaW5hdGUgZnJvbSAkbiQgKmluZGVwZW5kZW50KiBzdWJqZWN0cy4KCi0gRm9yIHRoZSBjYXB0b3ByaWwgc3R1ZHkgd2UgaGFkIGRlcGVuZGVudCBvYnNlcnZhdGlvbnMuCgogICAgLSBCbG9vZCBwcmVzc3VyZSBtZWFzdXJlbWVudHMgYmVmb3JlICgkWV97aSxiZWZvcmV9JCkgYW5kICBhZnRlciAoJFlfe2ksYWZ0ZXJ9JCkgYWRtaW5pc3RlcmluZyBjYXB0b3ByaWwgZm9yIHRoZSBzYW1lIHN1YmplY3QgJGk9MSxcbGRvdHMsbiQuCiAgICAtIFdlIHR1cm5lZCB0aGVtIGludG8gbiBpbmRlcGVuZGVudCBtZWFzdXJlbWVudHMgYnkgdGFraW5nIHRoZSBkaWZmZXJlbmNlICRZX3tpLGFmdGVyfS1ZX3tpLGJlZm9yZX0kCgotLS0KCiMjIyBWYXJpYW5jZSBlc3RpbWF0b3IgZm9yICRcYmFyIFgkCgokJFxzaWdtYV4yX3tcYmFyIFh9PVxmcmFje1xzaWdtYV4yfXtufSQkCgotIFRoZSBzdGFuZGFyZCBkZXZpYXRpb24gb2YgJFxiYXIgWCQgYXJvdW5kICRcbXUkIGlzICRcc3FydHtufSQgdGltZXMgc21hbGxlciB0aGF0IHRoZSBkZXZpYXRpb24gYXJvdW5kIHRoZSBvcmlnaW5hbCBvYnNlcnZhdGlvbnMgJFgkLgoKLSBUaGUgbW9yZSBvYnNlcnZhdGlvbnMgd2UgaGF2ZSB0aGUgbW9yZSBwcmVjaXNlICRcYmFyIFgkLgoKCjxkZXRhaWxzPjxzdW1tYXJ5PkNsaWNrIHRvIHNlZSBwcm9vZjwvc3VtbWFyeT48cD4KXGJlZ2lue2VxbmFycmF5Kn0KXHRleHR7VmFyfShcYmFyIFgpJj0mXHRleHR7VmFyfSBcbGVmdChcZnJhY3tYXzErIFhfMisgLi4uICsgWF9ufXtufVxyaWdodCkgXFwKJj0gJiBcZnJhY3tcdGV4dHtWYXJ9IChYXzErIFhfMisgLi4uICsgWF9uKX17bl4yfSBcXAomXG92ZXJzZXR7Kn17PX0gJiBcZnJhY3tcdGV4dHtWYXJ9KFhfMSkrIFx0ZXh0e1Zhcn0oWF8yKSsgLi4uICsgXHRleHR7VmFyfShYX24pfXtuXjJ9IFxcCiY9JiBcZnJhY3tcc2lnbWFeMiArIFxzaWdtYV4yICsgLi4uIFxzaWdtYV4yfXtuXjJ9IFxcCiY9ICYgXGZyYWN7XHNpZ21hXjJ9e259LgpcZW5ke2VxbmFycmF5Kn0KCi0gKCopIHRoaXMgaXMgYmFzZWQgb24gdGhlIGFzc3VtcHRpb24gb2YgaW5kZXBlbmRlbmNlLgokJFx0ZXh0e1Zhcn1bWF8xICsgWF8yXSA9IFx0ZXh0e1Zhcn1bWF8xXSArIFx0ZXh0e1Zhcn1bWF8yXSArIDIgXHRleHR7Q292YXJ9W1hfMSxYXzJdJCQKCiAgICAtIFdpdGggJENvdmFyW1hfMSxYXzJdPTAkIHdoZW4gJFhfMSQgYW5kICRYXzIkIGFyZSBpbmRlcGVuZGVudC4KPC9wPjwvZGV0YWlscz4KCioqRGVmaW5pdGlvbjogc3RhbmRhcmQgZXJyb3IqKgoKVGhlIHN0YW5kYXJkIGRldmlhdGlvbiBvZiAkXGJhcntYfSQgaXMgJFxzaWdtYS9cc3FydHtufSQgYW5kIGlzIGFsc28gcmVmZXJyZWQgdG8gYXMgdGhlICoqc3RhbmRhcmQgZXJyb3IqKiBvZiB0aGUgbWVhbi4KR2VuZXJhbGx5IG9uZSByZWZlcnMgdG8gdGhlIHN0YW5kYXJkIGRldmlhdGlvbiBvZiBhbiBlc3RpbWF0b3IgZm9yIGEgcGFydGljdWxhciBwYXJhbWV0ZXIgJFx0aGV0YSQgd2l0aCB0aGUgdGVybSAqKnN0YW5kYXJkIGVycm9yKiogb2YgdGhlIGVzdGltYXRvciwgd2hpY2ggaXMgZGVub3RlZCBhcyAkU0UkLgoKLS0tCgojIyMgQ2FwdG9wcmlsIGV4YW1wbGUKCgotICRuID0gMTUkIGRpZmZlcmVuY2VzIGluIHN5c3RvbGljIGJsb29kIHByZXNzdXJlCgotIFN1cHBvc2UgdGhhdCB0aGUgc3RhbmRhcmQgZGV2aWF0aW9uIG9mIHRoZSBibG9vZCBwcmVzc3VyZSBkaWZmZXJlbmNlcyBpbiB0aGUgcG9wdWxhdGlvbiBpcyAkXHNpZ21hID0gOS4wJCBtbUhnCgotIFRoZW4sIHRoZSBzdGFuZGFyZCBlcnJvciAoU0UpIG9uIHRoZSBhdmVyYWdlIHN5c3RvbGljIGJsb29kIHByZXNzdXJlIGRpZmZlcnMgJFxiYXIgWCQgYmVjb21lczoKCiQkClNFPSBcZnJhY3s5LjB9e1xzcXJ0ezE1fX09Mi4zMlx0ZXh0e21tSGcufQokJAoKLSBHZW5lcmFsbHkgJFxzaWdtYSQsIGFuZCB0aHVzIHRoZSBTRSBvbiB0aGUgc2FtcGxlIG1lYW4gYXJlIHVua25vd24uCi0gU28gd2UgYWxzbyBoYXZlIHRvIGVzdGltYXRlIHRoZSBzdGFuZGFyZCBkZXZpYXRpb24gb2YgdGhlIHNhbXBsZSB0byBvYnRhaW4gdGhlIHN0YW5kYXJkIGVycm9yCi0gRXN0aW1hdG9yOiAkU0U9Uy9cc3FydHtufSwkCi0gd2l0aCAkU14yJCB0aGUgc2FtcGxlIHZhcmlhbmNlIG9mICRYXzEsLi4uLFhfbiQgIGFuZCAkUyQgdGhlIHNhbXBsZSBzdGFuZGFyZCBkZXZpYXRpb24KCi0gRm9yIHRoZSBjYXB0b3ByaWwgZXhhbXBsZSB3ZSBvYnRhaW46CgpgYGB7cn0KbiA8LSBsZW5ndGgoY2FwdG9wcmlsJGRlbHRhU0JQKQpzZSA8LSBzZChjYXB0b3ByaWwkZGVsdGFTQlApIC8gc3FydChuKQpzZQpgYGAKCi0tLQoKIyMjIFN0YW5kYXJkIGRldmlhdGlvbiB2cyBzdGFuZGFyZCBlcnJvcgoKIyMjIyBJbGx1c3RyYXRlIHZpYSByZXBlYXRlZCBzYW1wbGluZwoKLSBEaWZmZXJlbnQgc2FtcGxlIHNpemVzOiAxMCwgNTAsIDEwMAotIERyYXcgMTAwMCBzYW1wbGVzIHBlciBzYW1wbGUgc2l6ZSBmcm9tIHRoZSBOSEFORVMgc3R1ZHksIGZvciBlYWNoIHNhbXBsZSB3ZSBjYWxjdWxhdGUKICAgIC0gVGhlIG1lYW4KICAgIC0gVGhlIHNhbXBsZSBzdGFuZGFyZCBkZXZpYXRpb24KICAgIC0gVGhlIHN0YW5kYXJkIGVycm9yCi0gV2UgbWFrZSBhIGJveHBsb3Qgb2YgdGhlIHNhbXBsZSBzdGFuZGFyZCBkZXZpYXRpb25zIGFuZCB0aGUgc3RhbmRhcmQgZXJyb3JzIGZvciB0aGUgZGlmZmVyZW50IHNhbXBsZSBzaXplcwoKLSBJbnN0ZWFkIG9mIHVzaW5nIGEgZm9yIGxvb3Agd2Ugd2lsbCB1c2UgdGhlIHNhcHBseSBmdW5jdGlvbiB3aGljaCBpcyBtb3JlIGVmZmljaWVudC4gSXQgdGFrZXMgYSB2ZWN0b3Igb3IgYSBsaXN0IGFzIGlucHV0IGFuZCBhcHBsaWVzIGEgZnVuY3Rpb24gb24gZWFjaCBlbGVtZW50IG9mIHRoZSB2ZWN0b3Igb3Igb24gZWFjaCBsaXN0IGVsZW1lbnQuCgpgYGB7cn0KZmVtU2FtcDEwIDwtIHNhcHBseSgxOjEwMDAsIGZ1bmN0aW9uKGosIHgsIHNpemUpIHNhbXBsZSh4LCBzaXplKSwgc2l6ZSA9IDEwLCB4ID0gZmVtJERpcmVjdENob2wpCgpmZW1TYW1wNTAgPC0gc2FwcGx5KDE6MTAwMCwgZnVuY3Rpb24oaiwgeCwgc2l6ZSkgc2FtcGxlKHgsIHNpemUpLCBzaXplID0gNTAsIHggPSBmZW0kRGlyZWN0Q2hvbCkKCmZlbVNhbXAxMDAgPC0gc2FwcGx5KDE6MTAwMCwgZnVuY3Rpb24oaiwgeCwgc2l6ZSkgc2FtcGxlKHgsIHNpemUpLCBzaXplID0gMTAwLCB4ID0gZmVtJERpcmVjdENob2wpCgpyZXMgPC0gcmJpbmQoCiAgZmVtU2FtcDEwICU+JQogICAgbG9nMigpICU+JQogICAgYXMuZGF0YS5mcmFtZSgpICU+JQogICAgZ2F0aGVyKHNhbXBsZSwgbG9nMkNob2wpICU+JQogICAgZ3JvdXBfYnkoc2FtcGxlKSAlPiUKICAgIHN1bW1hcml6ZV9hdCgKICAgICAgImxvZzJDaG9sIiwKICAgICAgbGlzdCgKICAgICAgICBtZWRpYW4gPSB+IG1lZGlhbiguLCBuYS5ybSA9IFRSVUUpLAogICAgICAgIG1lYW4gPSB+IG1lYW4oLiwgbmEucm0gPSBUUlVFKSwKICAgICAgICBzZCA9IH4gc2QoLiwgbmEucm0gPSBUUlVFKSwKICAgICAgICBuID0gZnVuY3Rpb24oeCkgewogICAgICAgICAgeCAlPiUKICAgICAgICAgICAgaXMubmEoKSAlPiUKICAgICAgICAgICAgYCFgKCkgJT4lCiAgICAgICAgICAgIHN1bSgpCiAgICAgICAgfQogICAgICApCiAgICApICU+JQogICAgbXV0YXRlKHNlID0gc2QgLyBzcXJ0KG4pKSwKICBmZW1TYW1wNTAgJT4lCiAgICBsb2cyKCkgJT4lCiAgICBhcy5kYXRhLmZyYW1lKCkgJT4lCiAgICBnYXRoZXIoc2FtcGxlLCBsb2cyQ2hvbCkgJT4lCiAgICBncm91cF9ieShzYW1wbGUpICU+JQogICAgc3VtbWFyaXplX2F0KAogICAgICAibG9nMkNob2wiLAogICAgICBsaXN0KAogICAgICAgIG1lZGlhbiA9IH4gbWVkaWFuKC4sIG5hLnJtID0gVFJVRSksCiAgICAgICAgbWVhbiA9IH4gbWVhbiguLCBuYS5ybSA9IFRSVUUpLAogICAgICAgIHNkID0gfiBzZCguLCBuYS5ybSA9IFRSVUUpLAogICAgICAgIG4gPSBmdW5jdGlvbih4KSB7CiAgICAgICAgICB4ICU+JQogICAgICAgICAgICBpcy5uYSgpICU+JQogICAgICAgICAgICBgIWAoKSAlPiUKICAgICAgICAgICAgc3VtKCkKICAgICAgICB9CiAgICAgICkKICAgICkgJT4lCiAgICBtdXRhdGUoc2UgPSBzZCAvIHNxcnQobikpLAogIGZlbVNhbXAxMDAgJT4lCiAgICBsb2cyKCkgJT4lCiAgICBhcy5kYXRhLmZyYW1lKCkgJT4lCiAgICBnYXRoZXIoc2FtcGxlLCBsb2cyQ2hvbCkgJT4lCiAgICBncm91cF9ieShzYW1wbGUpICU+JQogICAgc3VtbWFyaXplX2F0KAogICAgICAibG9nMkNob2wiLAogICAgICBsaXN0KAogICAgICAgIG1lZGlhbiA9IH4gbWVkaWFuKC4sIG5hLnJtID0gVFJVRSksCiAgICAgICAgbWVhbiA9IH4gbWVhbiguLCBuYS5ybSA9IFRSVUUpLAogICAgICAgIHNkID0gfiBzZCguLCBuYS5ybSA9IFRSVUUpLAogICAgICAgIG4gPSBmdW5jdGlvbih4KSB7CiAgICAgICAgICB4ICU+JQogICAgICAgICAgICBpcy5uYSgpICU+JQogICAgICAgICAgICBgIWAoKSAlPiUKICAgICAgICAgICAgc3VtKCkKICAgICAgICB9CiAgICAgICkKICAgICkgJT4lCiAgICBtdXRhdGUoc2UgPSBzZCAvIHNxcnQobikpCikKYGBgCgojIyMjIyBNZWFucwoKV2UgZmlyc3QgaWxsdXN0cmF0ZSB0aGUgaW1wYWN0IG9mIHNhbXBsZSBzaXplIG9uIHRoZSBkaXN0cmlidXRpb24gb2YgdGhlIG1lYW5zIG9mIHRoZSBkaWZmZXJlbnQgc2FtcGxlcwoKYGBge3J9CnJlcyAlPiUKICBnZ3Bsb3QoYWVzKHggPSBuICU+JSBhcy5mYWN0b3IoKSwgeSA9IG1lYW4pKSArCiAgZ2VvbV9ib3hwbG90KCkgKwogIHlsYWIoIkRpcmVjdCBjaG9sZXN0ZXJvbCAobG9nMikiKSArCiAgeGxhYigic2FtcGxlIHNpemUiKQpgYGAKCi0gTm90ZSwgdGhhdCB0aGUgdmFyaWF0aW9uIG9mIHRoZSBzYW1wbGUgbWVhbnMgaW5kZWVkIHJlZHVjZXMgYXMgdGhlIHNhbXBsZSBzaXplIGluY3JlYXNlcy4gU28gdGhlIGVzdGltYXRpb24gZ2V0cyBtb3JlIHByZWNpc2Ugd2l0aCBpbmNyZWFzaW5nIHNhbXBsZSBzaXplLgoKLS0tCgojIyMjIyBTdGFuZGFyZCBkZXZpYXRpb24KCldlIG5vdyBpbGx1c3RyYXRlIHRoZSBpbXBhY3Qgb2Ygc2FtcGxlIHNpemUgb24gdGhlIGRpc3RyaWJ1dGlvbiBvZiB0aGUgc3RhbmRhcmQgZGV2aWF0aW9uIG9mIHRoZSBkaWZmZXJlbnQgc2FtcGxlcwoKYGBge3J9CnJlcyAlPiUKICBnZ3Bsb3QoYWVzKHggPSBuICU+JSBhcy5mYWN0b3IoKSwgeSA9IHNkKSkgKwogIGdlb21fYm94cGxvdCgpICsKICB5bGFiKCJzdGFuZGFyZCBkZXZpYXRpb24iKSArCiAgeGxhYigic2FtcGxlIHNpemUiKQpgYGAKCgotIFRoZSBzdGFuZGFyZCBkZXZpYXRpb24gcmVtYWlucyBzaW1pbGFyIGFjcm9zcyBzYW1wbGUgc2l6ZS4KSXQgaXMgY2VudHJlZCBhcm91bmQgdGhlIHNhbWUgdmFsdWU6IHRoZSBzdGFuZGFyZCBkZXZpYXRpb24gaW4gdGhlIHBvcHVsYXRpb24uIEluZGVlZCBpbmNyZWFzaW5nIHRoZSBzYW1wbGUgc2l6ZSBkb2VzIGFmZmVjdCB0aGUgdmFyaWFiaWxpdHkgaW4gdGhlIHBvcHVsYXRpb24hCgotIEFnYWluIHdlIHNlZSB0aGF0IHRoZSB2YXJpYWJpbGl0eSBvZiB0aGUgc3RhbmRhcmQgZGV2aWF0aW9uIHJlZHVjZXMgd2l0aCBpbmNyZWFzaW5nIHNhbXBsZSBzaXplLiBTbyB0aGUgc3RhbmRhcmQgZGV2aWF0aW9uIGNhbiBhbHNvIGJlIGVzdGltYXRlZCBtb3JlIHByZWNpc2Ugd2l0aCBpbmNyZWFzaW5nIHNhbXBsZSBzaXplLgoKLS0tCgojIyMjIyBTdGFuZGFyZCBlcnJvciBvbiB0aGUgbWVhbgoKRmluYWxseSwgd2UgaWxsdXN0cmF0ZSB0aGUgaW1wYWN0IG9mIHNhbXBsZSBzaXplIG9uIHRoZSBkaXN0cmlidXRpb24gb2YgdGhlIHN0YW5kYXJkIGRldmlhdGlvbiBvbiB0aGUgbWVhbiBvZiB0aGUgZGlmZmVyZW50IHNhbXBsZXMKCmBgYHtyfQpyZXMgJT4lCiAgZ2dwbG90KGFlcyh4ID0gbiAlPiUgYXMuZmFjdG9yKCksIHkgPSBzZSkpICsKICBnZW9tX2JveHBsb3QoKSArCiAgeWxhYigic3RhbmRhcmQgZXJyb3IiKSArCiAgeGxhYigic2FtcGxlIHNpemUiKQpgYGAKCi0gVGhlIHN0YW5kYXJkIGVycm9yLCB0aGUgZXN0aW1hdG9yIGZvciB0aGUgcHJlY2lzaW9uIG9mIHRoZSBzYW1wbGUgbWVhbiwgaG93ZXZlciwgcmVkdWNlcyBjb25zaWRlcmFibHkgd2l0aCBpbmNyZWFzaW5nIHNhbXBsZSBzaXplIGFnYWluIGNvbmZpcm1pbmcgdGhhdCB0aGUgZXN0aW1hdGlvbiBvZiB0aGUgc2FtcGxlIG1lYW4gZ2V0cyBtb3JlIHByZWNpc2UuCgotLS0KCiMjIyBOb3JtYWxseSBkaXN0cmlidXRlZCBkYXRhCgotIEZvciBub3JtYWxseSBkaXN0cmlidXRlZCBkYXRhIHdlIGhhdmUgbXVsdGlwbGUgZXN0aW1hdG9ycyBmb3IgdGhlIHBvcHVsYXRpb24gbWVhbiAkXG11JCBlLmcgbWVhbiBhbmQgbWVkaWFuLgoKLSBCdXQsICRcYmFye1h9JCBpcyB0aGUgdW5iaWFzZWQgZXN0aW1hdG9yIG9mICRcbXUkIHdpdGggdGhlIHNtYWxsZXN0IHN0YW5kYXJkIGVycm9yCgotICAkXGJhcntYfSQgZGV2aWF0ZXMgbGVzcyBmcm9tIHRoZSBtZWFuICRcbXUkIHRoYW4gdGhlIG1lZGlhbgoKLSBXZSBpbGx1c3RyYXRlIHRoaXMgZm9yIHJlcGVhdGVkIHNhbXBsaW5nIHdpdGggc2FtcGxlIHNpemUgMTAKYGBge3J9CnJlcyAlPiUKICBmaWx0ZXIobiA9PSAxMCkgJT4lCiAgc2VsZWN0KG1lYW4sIG1lZGlhbikgJT4lCiAgZ2F0aGVyKHR5cGUsIGVzdGltYXRlKSAlPiUKICBnZ3Bsb3QoYWVzKHggPSB0eXBlLCB5ID0gZXN0aW1hdGUpKSArCiAgZ2VvbV9ib3hwbG90KCkgKwogIGdlb21faGxpbmUoeWludGVyY2VwdCA9IGZlbSREaXJlY3RDaG9sICU+JSBsb2cyKCkgJT4lIG1lYW4oKSkgKwogIGdndGl0bGUoIjEwIHN1YmplY3RzIikKYGBgCgpOZXh0LCB3ZSBjb21wYXJlIHRoZSBkaXN0cmlidXRpb24gb2YgbWVhbiBhbmQgbWVkaWFuIGluIHJlcGVhdGVkIHNhbXBsZXMgb2Ygc2FtcGxlIHNpemUgNTAuCgpgYGB7cn0KcmVzICU+JQogIGZpbHRlcihuID09IDUwKSAlPiUKICBzZWxlY3QobWVhbiwgbWVkaWFuKSAlPiUKICBnYXRoZXIodHlwZSwgZXN0aW1hdGUpICU+JQogIGdncGxvdChhZXMoeCA9IHR5cGUsIHkgPSBlc3RpbWF0ZSkpICsKICBnZW9tX2JveHBsb3QoKSArCiAgZ2VvbV9obGluZSh5aW50ZXJjZXB0ID0gZmVtJERpcmVjdENob2wgJT4lIGxvZzIoKSAlPiUgbWVhbigpKSArCiAgZ2d0aXRsZSgiNTAgc3ViamVjdHMiKQpgYGAKCiMjIyBEaXN0cmlidXRpb24gb2Ygc2FtcGxlIG1lYW4KCgotIEhvdyB2YXJpZXMgJFxiYXIgWCQgZnJvbSBzYW1wbGUgdG8gc2FtcGxlPwotIERpc3RyaWJ1dGlvbiBvZiAkXGJhciBYJD8KLSBJZiAkXGJhciBYJCBpcyBub3JtYWxseSBkaXN0cmlidXRlZCB0aGUgc3RhbmRhcmQgZXJyb3IgaGFzIGEgZ29vZCBpbnRlcnByZXRhdGlvbjogdGhlIHMuZS4gaXMgdGhlIHN0YW5kYXJkIGRldmlhdGlvbiBvZiB0aGUgc2FtcGxlIG1lYW4uCi0gSWYgdGhlIGRhdGEgJFhfaSQgYXJlIG5vcm1hbGx5IGRpc3RyaWJ1dGVkLCB0aGUgc2FtcGxlIG1lYW4gaXMgYWxzbyBub3JtYWxseSBkaXN0cmlidXRlZC4KCiQkWF9pIFxzaW0gTihcbXUsXHNpZ21hXjIpIFxyaWdodGFycm93ICBcYmFyIFggXHNpbSBOKFxtdSwgIFxzaWdtYV4yL24pJCQKCi0tLQoKIyMjIyBOSEFORVM6IGNob2xlc3Rlcm9sCgpXZSBpbGx1c3RyYXRlIHRoaXMgYWdhaW4gd2l0aCBzaW11bGF0aW9uIHVzaW5nIHRoZSBOSEFORVMgc3R1ZHkuClRoZSBsb2cyIGNob2xlc3Rlcm9sIGxldmVscyB3ZXJlIG5vcm1hbGx5IGRpc3RyaWJ1dGVkLgoKYGBge3J9CmZlbSAlPiUKICBnZ3Bsb3QoYWVzKHggPSBEaXJlY3RDaG9sICU+JSBsb2cyKCkpKSArCiAgZ2VvbV9oaXN0b2dyYW0oYWVzKHkgPSAuLmRlbnNpdHkuLiwgZmlsbCA9IC4uY291bnQuLikpICsKICB4bGFiKCJEaXJlY3QgY2hvbGVzdGVyb2wgKGxvZzIpIikgKwogIHN0YXRfZnVuY3Rpb24oZnVuID0gZG5vcm0sIGNvbG9yID0gInJlZCIsIGFyZ3MgPSBsaXN0KG1lYW4gPSBtZWFuKGZlbSREaXJlY3RDaG9sICU+JSBsb2cyKCkpLCBzZCA9IHNkKGZlbSREaXJlY3RDaG9sICU+JSBsb2cyKCkpKSkgKwogIGdndGl0bGUoIkFsbCBmZW1hbGVzIGluIE5oYW5lcyBzdHVkeSIpCgpmZW0gJT4lCiAgZ2dwbG90KGFlcyhzYW1wbGUgPSBEaXJlY3RDaG9sICU+JSBsb2cyKCkpKSArCiAgc3RhdF9xcSgpICsKICBzdGF0X3FxX2xpbmUoKSArCiAgZ2d0aXRsZSgiQWxsIGZlbWFsZXMgaW4gTmhhbmVzIHN0dWR5IikKYGBgCgotLS0KCiMjIyMjIEV2YWx1YXRlIGRpc3RyaWJ1dGlvbiBmb3Igc2FtcGxlcyB3aXRoIDUgc3ViamVjdHMKCmBgYHtyfQpmZW1TYW1wNSA8LSBzYXBwbHkoMToxMDAwLCBmdW5jdGlvbihqLCB4LCBzaXplKSB7CiAgc2FtcGxlKHgsIHNpemUpCn0sIHNpemUgPSA1LCB4ID0gZmVtJERpcmVjdENob2wpCgpmZW1TYW1wNVssIDFdICU+JQogIGxvZzIoKSAlPiUKICBhcy5kYXRhLmZyYW1lKCkgJT4lCiAgZ2dwbG90KGFlcyh4ID0gLikpICsKICBnZW9tX2hpc3RvZ3JhbShhZXMoeSA9IC4uZGVuc2l0eS4uLCBmaWxsID0gLi5jb3VudC4uKSwgYmlucyA9IDEwKSArCiAgeGxhYigiRGlyZWN0IGNob2xlc3Rlcm9sIChsb2cyKSIpICsKICBzdGF0X2Z1bmN0aW9uKGZ1biA9IGRub3JtLCBjb2xvciA9ICJyZWQiLCBhcmdzID0gbGlzdChtZWFuID0gZmVtU2FtcDVbLCAxXSAlPiUgbG9nMigpICU+JSBtZWFuKCksIHNkID0gZmVtU2FtcDVbLCAxXSAlPiUgbG9nMigpICU+JSBzZCgpKSkgKwogIGdndGl0bGUoIjUgcmFuZG9tIGZlbWFsZXMiKSArCiAgeGxpbShmZW0kRGlyZWN0Q2hvbCAlPiUgbG9nMigpICU+JSByYW5nZSgpKQoKCmZlbVNhbXA1ICU+JQogIGxvZzIoKSAlPiUKICBjb2xNZWFucygpICU+JQogIGFzLmRhdGEuZnJhbWUoKSAlPiUKICBnZ3Bsb3QoYWVzKHggPSAuKSkgKwogIGdlb21faGlzdG9ncmFtKGFlcyh5ID0gLi5kZW5zaXR5Li4sIGZpbGwgPSAuLmNvdW50Li4pLCBiaW5zID0gMTUpICsKICB4bGFiKCJNZWFuIGNob2xlc3Rlcm9sIChsb2cyKSIpICsKICBzdGF0X2Z1bmN0aW9uKGZ1biA9IGRub3JtLCBjb2xvciA9ICJyZWQiLCBhcmdzID0gbGlzdChtZWFuID0gZmVtU2FtcDUgJT4lIGxvZzIoKSAlPiUgY29sTWVhbnMoKSAlPiUgbWVhbigpLCBzZCA9IGZlbVNhbXA1ICU+JSBsb2cyKCkgJT4lIGNvbE1lYW5zKCkgJT4lIHNkKCkpKSArCiAgZ2d0aXRsZSgiTWVhbnMgb24gNSBmZW1hbGVzIikKCmZlbVNhbXA1ICU+JQogIGxvZzIoKSAlPiUKICBjb2xNZWFucygpICU+JQogIGFzLmRhdGEuZnJhbWUoKSAlPiUKICBnZ3Bsb3QoYWVzKHNhbXBsZSA9IC4pKSArCiAgc3RhdF9xcSgpICsKICBzdGF0X3FxX2xpbmUoKSArCiAgZ2d0aXRsZSgiTWVhbnMgb24gNSBmZW1hbGVzIikKYGBgCgotLS0KCiMjIyMjIEV4cGxvcmUgdGhlIGRpc3RyaWJ1dGlvbiBvZiB0aGUgbWVhbiBmb3Igc2FtcGxlcyBvZiBzaXplIDEwCgpOb3cgd2UgZXhwbG9yZSB0aGUgcmVzdWx0cyBmb3IgdGhlIHNhbXBsZSBzaXplIG9mIDEwLgoKV2UgZmlyc3QgaWxsdXN0cmF0ZSB0aGUgcGxvdCBmb3IgdGhlIGZpcnN0IHNhbXBsZS4KCmBgYHtyfQpmZW1TYW1wMTBbLCAxXSAlPiUKICBsb2cyKCkgJT4lCiAgYXMuZGF0YS5mcmFtZSgpICU+JQogIGdncGxvdChhZXMoeCA9IC4pKSArCiAgZ2VvbV9oaXN0b2dyYW0oYWVzKHkgPSAuLmRlbnNpdHkuLiwgZmlsbCA9IC4uY291bnQuLiksIGJpbnMgPSAxMCkgKwogIHhsYWIoIkRpcmVjdCBjaG9sZXN0ZXJvbCAobG9nMikiKSArCiAgc3RhdF9mdW5jdGlvbihmdW4gPSBkbm9ybSwgY29sb3IgPSAicmVkIiwgYXJncyA9IGxpc3QobWVhbiA9IGZlbVNhbXAxMFssIDFdICU+JSBsb2cyKCkgJT4lIG1lYW4oKSwgc2QgPSBmZW1TYW1wMTBbLCAxXSAlPiUgbG9nMigpICU+JSBzZCgpKSkgKwogIGdndGl0bGUoIjEwIHJhbmRvbSBmZW1hbGVzIikgKwogIHhsaW0oZmVtJERpcmVjdENob2wgJT4lIGxvZzIoKSAlPiUgcmFuZ2UoKSkKYGBgCgpOZXh0IHdlIGxvb2sgYXQgdGhlIGRpc3RyaWJ1dGlvbiBvZiB0aGUgc2FtcGxlIG1lYW4gb3ZlciAxMDAwIHNhbXBsZXMgb2Ygc2FtcGxlIHNpemUgMTAuCgpgYGB7cn0KZmVtU2FtcDEwICU+JQogIGxvZzIoKSAlPiUKICBjb2xNZWFucygpICU+JQogIGFzLmRhdGEuZnJhbWUoKSAlPiUKICBnZ3Bsb3QoYWVzKHggPSAuKSkgKwogIGdlb21faGlzdG9ncmFtKGFlcyh5ID0gLi5kZW5zaXR5Li4sIGZpbGwgPSAuLmNvdW50Li4pLCBiaW5zID0gMTUpICsKICB4bGFiKCJNZWFuIGNob2xlc3Rlcm9sIChsb2cyKSIpICsKICBzdGF0X2Z1bmN0aW9uKGZ1biA9IGRub3JtLCBjb2xvciA9ICJyZWQiLCBhcmdzID0gbGlzdChtZWFuID0gZmVtU2FtcDEwICU+JSBsb2cyKCkgJT4lIGNvbE1lYW5zKCkgJT4lIG1lYW4oKSwgc2QgPSBmZW1TYW1wMTAgJT4lIGxvZzIoKSAlPiUgY29sTWVhbnMoKSAlPiUgc2QoKSkpICsKICBnZ3RpdGxlKCJNZWFucyBvbiAxMCBmZW1hbGVzIikKCmZlbVNhbXAxMCAlPiUKICBsb2cyKCkgJT4lCiAgY29sTWVhbnMoKSAlPiUKICBhcy5kYXRhLmZyYW1lKCkgJT4lCiAgZ2dwbG90KGFlcyhzYW1wbGUgPSAuKSkgKwogIHN0YXRfcXEoKSArCiAgc3RhdF9xcV9saW5lKCkgKwogIGdndGl0bGUoIk1lYW5zIG9uIDEwIGZlbWFsZXMiKQpgYGAKCioqU28gd2UgY29uZmlybWVkIHRoYXQgdGhlIG1lYW4gaXMgYXBwcm94aW1hdGVseSBub3JtYWxseSBkaXN0cmlidXRlZCBmb3Igc3R1ZGllcyB3aXRoIDUgYW5kIDEwIGZlbWFsZXMgd2hlbiB0aGUgb3JpZ2luYWwgZGF0YSBhcmUgYXBwcm94aW1hdGVseSBub3JtYWxseSBkaXN0cmlidXRlZC4qKgoKLS0tCgojIyMjIENhcHRvcHJpbCBzdHVkeQoKLSBGb3IgQ2FwdG9wcmlsIHN0dWR5IHRoZSBzeXN0b2xpYyBibG9vZCBwcmVzc3VyZSBkaWZmZXJlbmNlcyBhcmUgYXBwcm94aW1hdGl2ZWx5IG5vcm1hbGx5IGRpc3RyaWJ1dGVkLgoKLSBzLmUuPSAyLjMyIG1tIEhnCgotIEluIDk1IG91dCBvZiAxMDAgc3R1ZGllcyB3aXRoIG4gPSAxNSBzdWJqZWN0cyB3ZSBleHBlY3QgdGhlIHNhbXBsZSBtZWFuIG9mIHRoZSBzeXN0b2xpYyBibG9vZCBwcmVzc3VyZSBkaWZmZXJlbmNlcyAoJFxiYXIgWCQpIG9uIGxlc3MgdGhlbiAkMiBcdGltZXMgMi4zMiA9IDQuNjQkbW0gSGcgb2YgdGhlIHJlYWwgcG9wdWxhdGlvbiBtZWFuIG9mIHRoZSBibG9vZCBwcmVzc3VyZSBkaWZmZXJlbmNlcyAoJFxtdSQpLgoKLS0tCgojIyMgTm9uLW5vcm1hbGx5IGRpc3RyaWJ1dGVkIGRhdGEKCi0gV2hlbiBpbmRpdmlkdWFsIG9ic2VydmF0aW9ucyBkbyBub3QgaGF2ZSBhIG5vcm1hbCBkaXN0cmlidXRpb24sICAgJFxiYXIgWCQgaXMgc3RpbGwgXHRleHRpdHthcHByb3hpbWF0ZWx5fSBOb3JtYWxseSBkaXN0cmlidXRlZAp3aGVuIHRoZSBudW1iZXIgb2JzZXJ2YXRpb25zIGFyZSBsYXJnZSBlbm91Z2guCgotIEhvdyBsYXJnZSBkb2VzIHRoZSBzYW1wbGUgbmVlZHMgdG8gYmUgZm9yIHRoZSBOb3JtYWwgYXBwcm94aW1hdGlvbiB0byB3b3JrPwoKLSBUaGlzIGRlcGVuZHMgb24gdGhlIHNrZXduZXNzIG9mIHRoZSBkaXN0cmlidXRpb24hCgotLS0KCiMjIyMgTkhBTkVTOiBjaG9sZXN0ZXJvbAoKLSBXaGVuIGNhbiBldmFsdWF0ZWQgdGhpcyBpbiB0aGUgTkhhbmVzIHN0dWR5IGlmIHdlIGRvIG5vdCBsb2cyIHRyYW5zZm9ybSB0aGUgZGF0YS4KCmBgYHtyfQpmZW0gJT4lIGdncGxvdChhZXMoeCA9IERpcmVjdENob2wpKSArCiAgZ2VvbV9oaXN0b2dyYW0oYWVzKHkgPSAuLmRlbnNpdHkuLiwgZmlsbCA9IC4uY291bnQuLikpICsKICB4bGFiKCJEaXJlY3QgY2hvbGVzdGVyb2wiKSArCiAgc3RhdF9mdW5jdGlvbihmdW4gPSBkbm9ybSwgY29sb3IgPSAicmVkIiwgYXJncyA9IGxpc3QobWVhbiA9IG1lYW4oZmVtJERpcmVjdENob2wpLCBzZCA9IHNkKGZlbSREaXJlY3RDaG9sKSkpICsKICBnZ3RpdGxlKCJBbGwgZmVtYWxlcyBpbiBOaGFuZXMgc3R1ZHkiKQoKZmVtICU+JSBnZ3Bsb3QoYWVzKHNhbXBsZSA9IERpcmVjdENob2wpKSArCiAgc3RhdF9xcSgpICsKICBzdGF0X3FxX2xpbmUoKSArCiAgZ2d0aXRsZSgiQWxsIGZlbWFsZXMgaW4gTmhhbmVzIHN0dWR5IikKYGBgCgpUaGUgY2hvbGVzdGVyb2wgZGF0YSBpcyBjbGVhcmx5IG5vbi1Ob3JtYWxseSBkaXN0cmlidXRlZC4KCiMjIyMjIERpc3RyaWJ1dGlvbiBvZiB0aGUgc2FtcGxlIG1lYW4gZm9yIGRpZmZlcmVudCBzYW1wbGUgc2l6ZXMKCmBgYHtyfQpmZW1TYW1wNSAlPiUKICBjb2xNZWFucygpICU+JQogIGFzLmRhdGEuZnJhbWUoKSAlPiUKICBnZ3Bsb3QoYWVzKHggPSAuKSkgKwogIGdlb21faGlzdG9ncmFtKGFlcyh5ID0gLi5kZW5zaXR5Li4sIGZpbGwgPSAuLmNvdW50Li4pLCBiaW5zID0gMTUpICsKICB4bGFiKCJNZWFuIGNob2xlc3Rlcm9sIikgKwogIHN0YXRfZnVuY3Rpb24oZnVuID0gZG5vcm0sIGNvbG9yID0gInJlZCIsIGFyZ3MgPSBsaXN0KG1lYW4gPSBmZW1TYW1wNSAlPiUgY29sTWVhbnMoKSAlPiUgbWVhbigpLCBzZCA9IGZlbVNhbXA1ICU+JSBjb2xNZWFucygpICU+JSBzZCgpKSkgKwogIGdndGl0bGUoIk1lYW5zIG9uIDUgZmVtYWxlcyIpCgpmZW1TYW1wNSAlPiUKICBjb2xNZWFucygpICU+JQogIGFzLmRhdGEuZnJhbWUoKSAlPiUKICBnZ3Bsb3QoYWVzKHNhbXBsZSA9IC4pKSArCiAgc3RhdF9xcSgpICsKICBzdGF0X3FxX2xpbmUoKSArCiAgZ2d0aXRsZSgiTWVhbnMgb24gNSBmZW1hbGVzIikKCgpmZW1TYW1wMTAgJT4lCiAgY29sTWVhbnMoKSAlPiUKICBhcy5kYXRhLmZyYW1lKCkgJT4lCiAgZ2dwbG90KGFlcyh4ID0gLikpICsKICBnZW9tX2hpc3RvZ3JhbShhZXMoeSA9IC4uZGVuc2l0eS4uLCBmaWxsID0gLi5jb3VudC4uKSwgYmlucyA9IDE1KSArCiAgeGxhYigiTWVhbiBjaG9sZXN0ZXJvbCIpICsKICBzdGF0X2Z1bmN0aW9uKGZ1biA9IGRub3JtLCBjb2xvciA9ICJyZWQiLCBhcmdzID0gbGlzdChtZWFuID0gZmVtU2FtcDEwICU+JSBjb2xNZWFucygpICU+JSBtZWFuKCksIHNkID0gZmVtU2FtcDEwICU+JSBjb2xNZWFucygpICU+JSBzZCgpKSkgKwogIGdndGl0bGUoIk1lYW5zIG9uIDEwIGZlbWFsZXMiKQoKZmVtU2FtcDEwICU+JQogIGNvbE1lYW5zKCkgJT4lCiAgYXMuZGF0YS5mcmFtZSgpICU+JQogIGdncGxvdChhZXMoc2FtcGxlID0gLikpICsKICBzdGF0X3FxKCkgKwogIHN0YXRfcXFfbGluZSgpICsKICBnZ3RpdGxlKCJNZWFucyBvbiAxMCBmZW1hbGVzIikKCmZlbVNhbXA1MCAlPiUKICBjb2xNZWFucygpICU+JQogIGFzLmRhdGEuZnJhbWUoKSAlPiUKICBnZ3Bsb3QoYWVzKHNhbXBsZSA9IC4pKSArCiAgc3RhdF9xcSgpICsKICBzdGF0X3FxX2xpbmUoKSArCiAgZ2d0aXRsZSgiTWVhbnMgb24gNTAgZmVtYWxlcyIpCgpmZW1TYW1wMTAwICU+JQogIGNvbE1lYW5zKCkgJT4lCiAgYXMuZGF0YS5mcmFtZSgpICU+JQogIGdncGxvdChhZXMoc2FtcGxlID0gLikpICsKICBzdGF0X3FxKCkgKwogIHN0YXRfcXFfbGluZSgpICsKICBnZ3RpdGxlKCJNZWFucyBvbiAxMDAgZmVtYWxlcyIpCmBgYAoKLSAqKldlIG9ic2VydmUgdGhhdCB3aGVuIHRoZSBkYXRhIGFyZSBub3Qgbm9ybWFsbHkgZGlzdHJpYnV0ZWQgdGhlIGRpc3RyaWJ1dGlvbiBvZiB0aGUgc2FtcGxlIG1lYW4gaXMgbm90IG5vcm1hbGx5IGRpc3RyaWJ1dGVkIGluIHNtYWxsIHNhbXBsZXMqKgoKLSAqKkZvciBsYXJnZSBzYW1wbGVzLCBob3dldmVyLCB0aGUgc2FtcGxlIG1lYW4gb2Ygbm9uIG5vcm1hbCBkYXRhIGlzIHN0aWxsIGFwcHJveGltYXRlbHkgbm9ybWFsbHkgZGlzdHJpYnV0ZWQuKioKCi0tLQoKIyMjIENlbnRyYWxlIExpbWl0IFRoZW9yZW0KCkxldCAkWF8xLCBcbGRvdHMsIFhfbiQgYXJlIHNlcXVlbmNlIG9mIHJhbmRvbSB2YXJpYWJsZXMgdGhhdCBhcmUgZHJhd24gaW5kZXBlbmRlbnRseSBmcm9tIHRoZSBzYW1lIGRpc3RyaWJ1dGlvbiAocG9wdWxhdGlvbikuCkFzIGxvbmcgYXMgdGhlIHNhbXBsZSBzaXplIG4gaXMgc3VmZmljaWVudGx5IGxhcmdlLCB0aGUgc2FtcGxlIG1lYW4gJFxiYXIgWCQgaXMgYXBwcm94aW1hdGVseSBub3JtYWxseSBkaXN0cmlidXRlZCwgaXJyZXNwZWN0aXZlIG9mIHRoZSBkaXN0cmlidXRpb24gb2YgdGhlIG9ic2VydmF0aW9ucyAkWF9pJC4KCiMjIyBPdmVydmlldyBvbiB0aGUgZGlzdHJpYnV0aW9uIG9mIHRoZSBtZWFuCgohW10oaHR0cHM6Ly93d3cubmF0dXJlLmNvbS9hcnRpY2xlcy9ubWV0aC4yNjEzLnBkZil7d2lkdGg9MTAwJX0KCi0tLQoKIyBJbnRlcnZhbCBlc3RpbWF0b3JzCgotICRcYmFyIFgkIHZhcmllcyBhcm91bmQgJFxtdSQKCi0gSGVyZSB3ZSB3aWxsIGRldmVsb3AgYW4gaW50ZXJ2YWwgYXJvdW5kICRcYmFyIFgkIHRoYXQgd2lsbCBjb250YWluIHRoZSB2YWx1ZSBvZiAkXG11JCB3aXRoIGEgcHJvYmFiaWxpdHkgb2YgOTUlIGZvciBhIHJhbmRvbSBzYW1wbGUuCgotIFdlIGZpcnN0IGFzc3VtZSAkXHNpZ21hXjIkIHRvIGJlIGtub3duIGFuZCB3ZSB3aWxsIGxhdGVyIHJlbGF4IHRoaXMgYXNzdW1wdGlvbi4KCi0tLQoKIyMgTm9ybWFsbHkgZGlzdHJpYnV0ZWQgZGF0YSB3aXRoIGtub3duIHZhcmlhbmNlCgotICRYXHNpbSBOKFxtdSxcc2lnbWFeMikgXHJpZ2h0YXJyb3cgXGJhciBYXHNpbSBOXGxlZnQoXG11LFxmcmFje1xzaWdtYV4yfXtufVxyaWdodCkkCgotIDk1JSByZWZlcmVuY2UtaW50ZXJ2YWwgZm9yIHNhbXBsZSBtZWFuCgpcYmVnaW57ZXF1YXRpb24qfQpcbGVmdFtcbXUgLSAxLjk2IFxmcmFje1xzaWdtYX17XHNxcnR7bn19LFxtdSArIDEuOTYgXGZyYWN7XHNpZ21hfXtcc3FydHtufX0lClxyaWdodF0KXGVuZHtlcXVhdGlvbip9CgotIFRoZSBpbnRlcnZhbCBjb250YWlucyB0aGUgc2FtcGxlIG1lYW4gb2YgYSByYW5kb20gc2FtcGxlIHdpdGggYSBwcm9iYWJpbGl0eSBvZiA5NSUuCgotIFdlIGNhbiBub3QgY2FsY3VsYXRlIGl0IGJlY2F1c2UgJFxtdSQgaXMgdW5rbm93bi4KCi0gRXN0aW1hdGUgJFxtdSQgYnkgJFxiYXIgWCQuClxiZWdpbntlcXVhdGlvbip9ClxsZWZ0W1xiYXIgWCAtIDEuOTYgXGZyYWN7XHNpZ21hfXtcc3FydHtufX0sXGJhciBYICsgMS45NiBcZnJhY3tcc2lnbWF9e1xzcXJ0e259fVxyaWdodF0KXGVuZHtlcXVhdGlvbip9CgoKLSBNb3JlIHVzZWZ1bCBpbnRlcnByZXRhdGlvbjoKXHZzcGFjZXsxNXB0fQotIFJld3JpdGUgJFxtdSAtIDEuOTYgXCBcc2lnbWEvXHNxcnR7bn0gPCBcYmFye1h9JCBhcyAkXG11IDwgXGJhcntYfSArIDEuOTYgXCBcc2lnbWEvXHNxcnR7bn0kLgoKU28gdGhhdCB3ZSBjYW4gd3JpdGUKXGJlZ2lue2VxbmFycmF5Kn0KOTVcJSAmPSYgUCggXG11IC0gMS45NiBcIFxzaWdtYS9cc3FydHtufSA8IFxiYXJ7WH0gPCBcbXUgKyAxLjk2IFwgXHNpZ21hL1xzcXJ0e259ICkgXFwKJj0mUCggXGJhcntYfSAtIDEuOTYgXCBcc2lnbWEvXHNxcnR7bn0gPCBcbXUgPCBcYmFye1h9ICsgMS45NiBcIFxzaWdtYS9cc3FydHtufSApClxlbmR7ZXFuYXJyYXkqfQoKLS0tCgoqKkRlZmluaXRpb24gb2YgOTUlIGNvbmZpZGVuY2UgaW50ZXJ2YWwgb24gbWVhbioqCkZvciBhIHJhbmRvbSBzYW1wbGUsIHRoZSBpbnRlcnZhbApcYmVnaW57ZXF1YXRpb259CltcYmFye1h9IC0gMS45NiBcIFxzaWdtYS9cc3FydHtufSAsIFxiYXJ7WH0gKyAxLjk2IFwgXHNpZ21hL1xzcXJ0e259IF0sClxlbmR7ZXF1YXRpb259CmNvbnRhaW5zIHRoZSBwb3B1bGF0aW9uIG1lYW4gJFxtdSQgd2l0aCBhIHByb2JhYmlsaXR5IG9mIDk1JS4KCi0tLQoKLSBUaGUgcHJvYmFiaWxpdHkgdGhhdCB0aGUgQ0kgZm9yIGEgcmFuZG9tIHNhbXBsZSBjb250YWlucyB0aGUgcG9wdWxhdGlvbiBwYXJhbWV0ZXIgJFxtdSQsIGkuZS4gOTUlLCBpcyBhbHNvIHJlZmVycmVkIHRvIGFzIHRoZSAqKmNvbmZpZGVuY2UgbGV2ZWwqKi4KCi0gTm90ZSwgdGhhdCB0aGUgbG93ZXIgYW5kIHVwcGVyIGxpbWl0IG9mIHRoZSBpbnRlcnZhbCBhcmUgYWxzbyByYW5kb20gdmFyaWFibGVzIHRoYXQgdmFyeSBmcm9tIHNhbXBsZSB0byBzYW1wbGUuIERpZmZlcmVudCBzYW1wbGVzIGluZGVlZCByZXN1bHQgaW4gZGlmZmVyZW50IGNvbmZpZGVuY2UgaW50ZXJ2YWxzIGJlY2F1c2UgdGhleSBhcmUgYmFzZWQgb24gZGlmZmVyZW50IG9ic2VydmF0aW9uLgoKLSBTbyB0aGV5IGFyZSAqc3RvY2hhc3RpYyBpbnRlcnZhbHMqCgotIDk1JSBvZiB0aGUgc2FtcGxlcyB3aWxsIHByb2R1Y2UgYSA5NSUgY29uZmlkZW5jZSBpbnRlcnZhbCB0aGF0IHdpbGwgY29udGFpbiB0aGUgcG9wdWxhdGlvbiBtZWFuICRcbXUkLiBUaGUgcmVtYWluaW5nIDUlIHdpbGwgcHJvZHVjZSBpbnRlcnZhbHMgdGhhdCBkbyBub3QgY29udGFpbiB0aGUgcG9wdWxhdGlvbiBtZWFuLgoKLSBCYXNlZCBvbiBvbmUgaW50ZXJ2YWwgeW91IGNhbm5vdCBjb25jbHVkZSB0aGF0IGl0IGNvbnRhaW5zIHRoZSByZWFsIHBvcHVsYXRpb24gcGFyYW1ldGVyLCBiZWNhdXNlIGl0cyB2YWx1ZSBpcyB1bmtub3duLgoKR2VuZXJhbGx5IHRoZSBzdGFuZGFyZCBkZXZpYXRpb24gaXMgdW5rbm93biBhbmQgaGFzIHRvIGJlIGVzdGltYXRlZCBlLmcuIGJ5ICRTJAoKLSBGb3IgbGFyZ2UgJG4kICRbXGJhcntYfSAtIDEuOTYgXCBzL1xzcXJ0e259ICwgXGJhcntYfSArIDEuOTYgXCBzL1xzcXJ0e259IF0kIHdpbGwgY29udGFpbiB0aGUgcG9wdWxhdGlvbiBtZWFuIHdpdGggYSBwcm9iYWJpbGl0eSBvZiBhcHByb3hpbWF0ZWx5IDk1JS4KCi0tLQoKIyMjIE5IQU5FUyBsb2cyIGNob2xlc3Rlcm9sIGV4YW1wbGUKCiMjIyMgT25lIHNhbXBsZQpgYGB7cn0Kc2FtcDUwIDwtIHNhbXBsZShmZW0kRGlyZWN0Q2hvbCwgNTApCgpsbCA8LSBtZWFuKHNhbXA1MCAlPiUgbG9nMigpKSAtIDEuOTYgKiBzZChzYW1wNTAgJT4lIGxvZzIoKSkgLyBzcXJ0KDUwKQp1bCA8LSBtZWFuKHNhbXA1MCAlPiUgbG9nMigpKSArIDEuOTYgKiBzZChzYW1wNTAgJT4lIGxvZzIoKSkgLyBzcXJ0KDUwKQpwb3BNZWFuIDwtIG1lYW4oZmVtJERpcmVjdENob2wgJT4lIGxvZzIoKSkKCmMobGwgPSBsbCwgdWwgPSB1bCwgcG9wTWVhbiA9IHBvcE1lYW4pCmBgYAoKIyMjIyBSZXBlYXRlZCBzYW1wbGluZwpgYGB7cn0KcmVzJGxsIDwtIHJlcyRtZWFuIC0gMS45NiAqIHJlcyRzZQpyZXMkdWwgPC0gcmVzJG1lYW4gKyAxLjk2ICogcmVzJHNlCm11IDwtIGZlbSREaXJlY3RDaG9sICU+JQogIGxvZzIoKSAlPiUKICBtZWFuKCkKcmVzJGluc2lkZSA8LSByZXMkbGwgPD0gbXUgJiBtdSA8PSByZXMkdWwKcmVzJG4gPC0gYXMuZmFjdG9yKHJlcyRuKQpyZXMgJT4lCiAgZ3JvdXBfYnkobikgJT4lCiAgc3VtbWFyaXplKGNvdmVyYWdlID0gbWVhbihpbnNpZGUpKSAlPiUKICBzcHJlYWQobiwgY292ZXJhZ2UpCmBgYAoKLSBOb3RlLCB0aGF0IHRoZSBjb3ZlcmFnZSBpbiB0aGUgc2FtcGxlcyB3aXRoIDEwIG9ic2VydmF0aW9ucyBpcyB0b28gbG93IGJlY2F1c2Ugd2UgZG8gbm90IGFjY291bnQgZm9yIHRoZSB1bmNlcnRhaW50eSBpbiB0aGUgZXN0aW1hdGlvbiBvZiB0aGUgc3RhbmRhcmQgZGV2aWF0aW9uLgoKLSBJZiB3ZSBsb29rIHRvIHRoZSBmaXJzdCAyMCBpbnRlcnZhbHMsIGByIHN1bSgoIXJlc1tyZXMkbj09MTAsImluc2lkZSJdKVsxOjIwXSlgICBvdXQgb2YgMjAgZG8gbm90IGNvbnRhaW4gdGhlIHBvcHVsYXRpb24gbWVhbi4KCmBgYHtyfQpyZXMgJT4lCiAgZmlsdGVyKG4gPT0gMTApICU+JQogIHNsaWNlKDE6MjApICU+JQogIGdncGxvdChhZXMoeCA9IHNhbXBsZSwgeSA9IG1lYW4sIGNvbG9yID0gaW5zaWRlKSkgKwogIGdlb21fcG9pbnQoKSArCiAgZ2VvbV9lcnJvcmJhcihhZXMoeW1pbiA9IG1lYW4gLSAxLjk2ICogc2UsIHltYXggPSBtZWFuICsgMS45NiAqIHNlKSkgKwogIGdlb21faGxpbmUoeWludGVyY2VwdCA9IGZlbSREaXJlY3RDaG9sICU+JSBsb2cyKCkgJT4lIG1lYW4oKSkgKwogIGdndGl0bGUoIjIwIENJIGZvciBOPTEwIikgKwogIHlsaW0ocmFuZ2UoZmVtJERpcmVjdENob2wgJT4lIGxvZzIoKSkpCmBgYAoKLS0tCgotIEZvciBsYXJnZSBzYW1wbGUgc2l6ZXMgKDEwMCkgdGhlIGNvdmVyYWdlIGlzIGZpbmUgYmVjYXVzZSB3ZSBjYW4gZXN0aW1hdGUgdGhlIHN0YW5kYXJkIGRldmlhdGlvbiB3aXRoIGEgcmVsYXRpdmUgaGlnaCBwcmVjaXNpb24uCgpgYGB7cn0KcmVzICU+JQogIGZpbHRlcihuID09IDUwKSAlPiUKICBzbGljZSgxOjIwKSAlPiUKICBnZ3Bsb3QoYWVzKHggPSBzYW1wbGUsIHkgPSBtZWFuLCBjb2xvciA9IGluc2lkZSkpICsKICBnZW9tX3BvaW50KCkgKwogIGdlb21fZXJyb3JiYXIoYWVzKHltaW4gPSBtZWFuIC0gMS45NiAqIHNlLCB5bWF4ID0gbWVhbiArIDEuOTYgKiBzZSkpICsKICBnZW9tX2hsaW5lKHlpbnRlcmNlcHQgPSBmZW0kRGlyZWN0Q2hvbCAlPiUgbG9nMigpICU+JSBtZWFuKCkpICsKICBnZ3RpdGxlKCIyMCBDSSBmb3IgTj01MCIpICsKICB5bGltKHJhbmdlKGZlbSREaXJlY3RDaG9sICU+JSBsb2cyKCkpKQoKcmVzICU+JQogIGZpbHRlcihuID09IDEwMCkgJT4lCiAgc2xpY2UoMToyMCkgJT4lCiAgZ2dwbG90KGFlcyh4ID0gc2FtcGxlLCB5ID0gbWVhbiwgY29sb3IgPSBpbnNpZGUpKSArCiAgZ2VvbV9wb2ludCgpICsKICBnZW9tX2Vycm9yYmFyKGFlcyh5bWluID0gbWVhbiAtIDEuOTYgKiBzZSwgeW1heCA9IG1lYW4gKyAxLjk2ICogc2UpKSArCiAgZ2VvbV9obGluZSh5aW50ZXJjZXB0ID0gZmVtJERpcmVjdENob2wgJT4lIGxvZzIoKSAlPiUgbWVhbigpKSArCiAgZ2d0aXRsZSgiMjAgQ0kgZm9yIE49MTAwIikgKwogIHlsaW0ocmFuZ2UoZmVtJERpcmVjdENob2wgJT4lIGxvZzIoKSkpCmBgYAoKLSBXaGF0IGhhdmUgeW91IG9ic2VydmVkIGZvciB0aGUgaW50ZXJ2YWwgd2lkdGg/CgotLS0KCiMjIyBPdGhlciBjb25maWRlbmNlIGxldmVscwoKLSBXZSBjYW4gcmVwbGFjZSB0aGUgJHpfezIuNVwlfT0xLjk2JCBieSBhbm90aGVyIHF1YW50aWxlIG9mIHRoZSBub3JtYWwgZGlzdHJpYnV0aW9uICR6X3tcYWxwaGEvMn0kIHRvIG9idGFpbiBhbiBpbnRlcnZhbCB3aXRoIGFub3RoZXIgY29uZmlkZW5jZSBsZXZlbCAkMS1cYWxwaGEkLgoKLSBDb25maWRlbmNlIGludGVydmFscyBhcmUgbm90IG9ubHkgdXNlZCBmb3IgdGhlIG1lYW4gYnV0IGFsc28gZm9yIG90aGVyIHBvcHVsYXRpb24gcGFyYW1ldGVycy4KCi0tLQoKIyMgVW5rbm93biB2YXJpYW5jZQoKSW4gcmVhbCBleGFtcGxlcyAkXHNpZ21hJCBpcyB1bmtub3duIGFuZCBlc3RpbWF0ZWQgYmFzZWQgb24gdGhlIHNhbXBsZSB1c2luZyB0aGUgc2FtcGxlIHN0YW5kYXJkIGRldmlhdGlvbiAkUyQuCgotIFRoZSBwcmV2aW91cyBpbnRlcnZhbHMgd2VyZSBhIGJpdCB0byBzbWFsbCBiZWNhdXNlIHRoZXkgZGlkIG5vdCBhY2NvdW50IGZvciB0aGUgdW5jZXJ0YWludHkgb24gdGhlIGVzdGltYXRpb24gb2YgJFMkLgoKLSBXaGVuICRuJCBpcyBsYXJnZSwgJFMkIGlzIGNsb3NlIHRvICRcc2lnbWEkLgoKLSBIZW5jZSwgJHsoXGJhcntYfSAtIFxtdSl9L3soUy9cc3FydHtufSkgfSQgaXMgYXBwcm94aW1hdGVseSBzdGFuZGFyZCBub3JtYWwgYW5kClxiZWdpbntlcXVhdGlvbip9ClxsZWZ0W1xiYXJ7WH0gLSB6X3tcYWxwaGEvMn0gXCBcZnJhY3tTfXtcc3FydHtufX0gLCBcYmFye1h9ICsgel97XGFscGhhLzJ9IFwKXGZyYWN7U317XHNxcnR7bn19XHJpZ2h0XQpcZW5ke2VxdWF0aW9uKn0KaXMgYW4gYXBwcm94aW1hdGUgJCgxLSBcYWxwaGEpMTAwXCUkIENJIGZvciAkXG11JC4KCi0gRm9yIHNtYWxsIHNhbXBsZXMgdGhpcyBubyBsb25nZXIgaG9sZHMgKGUuZy4gbj0xMCkKClRoZSBlc3RpbWF0aW9uIG9mICRTJCBpbnRyb2R1Y2VzIGFkZGl0aW9uYWwgdW5jZXJ0YWludHkgaW4gdGhlIHN0YW5kYXJkaXplZCB2YWx1ZSAkeyhcYmFye1h9IC0gXG11KX0veyhTL1xzcXJ0e259KX0kLiBJdHMgZGlzdHJpYnV0aW9uCgotIGlzIHN0aWxsIHN5bW1ldHJpYyBidXQgaGFzIGhlYXZpZXIgdGFpbHMgdGhhdCB0aGUgbm9ybWFsIGRpc3RyaWJ1dGlvbi4KCi0gaXQgZGVwZW5kcyBvbiAkbiQgaG93IG11Y2ggaGVhdmllciB0aGUgdGFpbHMgYXJlCgotIGlzIGEgKFN0dWRlbnQpICR0JC1kaXN0cmlidXRpb24gd2l0aCAkbi0xJCAqZGVncmVlcyBvZiBmcmVlZG9tKi4KCi0tLQoKIyMjIFQtZGlzdHJpYnV0aW9uCgpNb3JlIGZvcm1hbGx5OiBMZXQgJFhfMSwgWF8yLCAuLi4sIFhfbiQgYmUgYW4gaW5kZXBlbmRlbnQgcmFuZG9tIHNhbXBsZSBmcm9tIGEgTm9ybWFsIGRpc3RyaWJ1dGlvbiAkTihcbXUsIFxzaWdtYV4yKSQsIHRoZW4gJChcYmFye1h9IC0gXG11KS8oUy9cc3FydHtufSkkIGZvbGxvd3MgYSAkdCQtZGlzdHJpYnV0aW9uIHdpdGggJG4tMSQgZGVncmVlcyBvZiBmcmVlZG9tLgoKVGhlIGRlbnNpdHkgb2YgYSB0LWRpc3RyaWJ1dGlvbiBjYW4gYmUgY2FsY3VsYXRlZCBpbiBSIHVzaW5nIHRoZSBmdW5jdGlvbiBgZHRgLiBJdCBoYXMgYXJndW1lbnRzIGB4YCBmb3IgdGhlIHF1YW50aWxlIGFuZCBgZGZgIGZvciB0aGUgZGVncmVlcyBvZiBmcmVlZG9tLgoKYGBge3IgZXZhbD1GQUxTRX0KZ3JpZCA8LSBzZXEoLTUsIDUsIC4xKQpkZW5zRGlzdCA8LSBjYmluZChncmlkLCBkbm9ybShncmlkKSwgc2FwcGx5KGMoMiwgNSwgMTApLCBkdCwgeCA9IGdyaWQpKQpjb2xuYW1lcyhkZW5zRGlzdCkgPC0gYygieCIsICJub3JtYWwiLCBwYXN0ZTAoInQiLCBjKDIsIDUsIDEwKSkpCgpkZW5zRGlzdCAlPiUKICBhcy5kYXRhLmZyYW1lKCkgJT4lCiAgZ2F0aGVyKGRpc3QsIGRlbnMsIC14KSAlPiUKICBnZ3Bsb3QoYWVzKHggPSB4LCB5ID0gZGVucywgY29sb3IgPSBkaXN0KSkgKwogIGdlb21fbGluZSgpICsKICB5bGFiKCJEZW5zaXR5IikKYGBgCgoKdC1kaXN0cmlidXRpb25zIGhhdmUgaGVhdmllciB0YWlscyB0aGVuIHRoZSBub3JtYWwgZGlzdHJpYnV0aW9uICRccmlnaHRhcnJvdyQgbGFyZ2VyIHF1YW50aWxlcyBzbyBicm9hZGVyIGludGVydmFscyBmb3IgdGhlIHNhbWUgY29uZmlkZW5jZSBsZXZlbC4KCi0gVGhpcyBjYXB0dXJlcyB0aGUgYWRkaXRpb25hbCB1bmNlcnRhaW50eSBmb3IgZXN0aW1hdGluZyAkUyQuCgotIElmICRuIFxyaWdodGFycm93IFxpbmZ0eSQgdGhlbiAkdChkZikgXHJpZ2h0YXJyb3cgTigwLDEpJAoKCi0gUXVhbnRpbGVzIG9mIHRoZSAkdCQtZGlzdHJpYnV0aW9uIGNhbiBiZSBjYWxjdWxhdGVkIGluIFIgdXNpbmcgYHF0YC4gZS5nLiA5NSUsIDk3LjUlLCA5OS41JSBxdWFudGlsZSBmb3IgYSB0LWRpc3RyaWJ1dGlvbiB3aXRoIDE0IGRlZ3JlZXMgb2YgZnJlZWRvbToKYGBge3J9CnF0KC45NzUsIGRmID0gMTQpCnF0KGMoLjk1LCAuOTc1LCAuOTk1KSwgZGYgPSAxNCkKYGBgCgotIFRoZXNlIHF1YW50aWxlcyBjYW4gYmUgdXNlZCB0byBjYWxjdWxhdGUgOTAlLCA5NSUgYW5kIDk5JSBDSS4KCi0gOTcuNSUgcXVhbnRpbGUgYHIgcm91bmQocXQoLjk3NSxkZj0xNCksMilgIG9mIGEgdC1kaXN0cmlidXRpb24gd2l0aCAkbi0xPTE0JCBkZWdyZWVzIG9mIGZyZWVkb20gaXMgaW5kZWVkIGxhcmdlciB0aGFuIHRoYXQgb2YgYSBzdGFuZGFyZCBOb3JtYWwgZGlzdHJpYnV0aW9uIGByIHJvdW5kKHFub3JtKC45NzUpLDIpYC4KCi0tLQoKIyMjIENvbmZpZGVuY2UgaW50ZXJ2YWwgYmFzZWQgb24gdGhlIHQtZGlzdHJpYnV0aW9uCgpUaGUgJDEwMFwlICgxLVxhbHBoYSkkIENJIGZvciB0aGUgbWVhbiAkXG11JCBvZiBhCk5vcm1hbCBkaXN0cmlidXRlZCByYW5kb20gdmFyaWFibGUgJFgkIHdpdGggdW5rbm93biB2YXJpYW5jZSBpcwoKXGJlZ2lue2VxdWF0aW9uKn0KXGxlZnRbXGJhcntYfSAtIHRfe24tMSwgXGFscGhhLzJ9IFxmcmFje3N9e1xzcXJ0e259fSAsIFxiYXJ7WH0gKyB0X3tuLTEsClxhbHBoYS8yfSBcZnJhY3tzfXtcc3FydHtufX1ccmlnaHRdClxlbmR7ZXF1YXRpb24qfQoKLSBXZSBzaW1wbHkgcmVwbGFjZSB0aGUgJCgxLVxhbHBoYS8yKTEwMFwlJCBxdWFudGlsZSBvZiB0aGUgTm9ybWFsIGRpc3RyaWJ1dGlvbiBieSB0aGF0IG9mIHRoZSB0LWRpc3RyaWJ1dGlvbiB3aXRoICRuLTEkIGRlZ3JlZXMgb2YgZnJlZWRvbS4KCiMjIyMgQ2FwdG9wcmlsIGV4YW1wbGUKCgo5NSUgQ0kgZm9yIHRoZSBhdmVyYWdlIGJsb29kIHByZXNzdXJlIGNoYW5nZSBiZWNvbWVzCgpgYGB7cn0KbWVhbihjYXB0b3ByaWwkZGVsdGFTQlApIC0gcXQoLjk3NSwgZGYgPSAxNCkgKiBzZChjYXB0b3ByaWwkZGVsdGFTQlApIC8gc3FydCgxNSkKbWVhbihjYXB0b3ByaWwkZGVsdGFTQlApICsgcXQoLjk3NSwgZGYgPSAxNCkgKiBzZChjYXB0b3ByaWwkZGVsdGFTQlApIC8gc3FydCgxNSkKYGBgCgpUaGUgOTklIENJIGlzIGdpdmVuIGJ5CmBgYHtyfQptZWFuKGNhcHRvcHJpbCRkZWx0YVNCUCkgLSBxdCguOTk1LCBkZiA9IDE0KSAqIHNkKGNhcHRvcHJpbCRkZWx0YVNCUCkgLyBzcXJ0KDE1KQptZWFuKGNhcHRvcHJpbCRkZWx0YVNCUCkgKyBxdCguOTk1LCBkZiA9IDE0KSAqIHNkKGNhcHRvcHJpbCRkZWx0YVNCUCkgLyBzcXJ0KDE1KQpgYGAKCk5vdGUsIHRoYXQgemVybyBpcyBvdXRzaWRlIHRoZSBpbnRlcnZhbCBhbmQgdGhhdCB0aGUgZW50aXJlIGludGVydmFsIGlzIG5lZ2F0aXZlIGluZGljYXRpbmcgdGhhdCB0aGVyZSBpcyBvbiBhdmVyYWdlIGEgbGFyZ2UgZWZmZWN0IGJ5IGFkbWluaXN0cmF0aW5nIGNhcHRvcHJpbCBvbiB0aGUgYmxvb2QgcHJlc3N1cmUgb2YgcGF0aWVudHMgd2l0aCBoeXBlcnRlbnNpb24uCgotLS0KCiMjIyBJbnRlcnByZXRhdGlvbiBvZiB0aGUgY29uZmlkZW5jZSBpbnRlcnZhbAoKLSBXZSB3aWxsIHJldmlzaXQgdGhlIHJlc3VsdHMgZm9yIHNhbXBsaW5nIGxvZzIgY2hvbGVzdGVyb2wgbGV2ZWxzIGZyb20gdGhlIGxhcmdlIE5IQU5FUyBzdHVkeS4gV2UgZmlyc3QgZm9jdXMgb24gdGhlIHJlcGVhdGVkIGV4cGVyaW1lbnRzIHdpdGggc2FtcGxlIHNpemUgMTAuCgpgYGB7cn0KcmVzJG4gPC0gYXMuY2hhcmFjdGVyKHJlcyRuKSAlPiUgYXMuZG91YmxlKHJlcyRuKQpyZXMkbGwgPC0gcmVzJG1lYW4gLSBxdCgwLjk3NSwgZGYgPSByZXMkbiAtIDEpICogcmVzJHNlCnJlcyR1bCA8LSByZXMkbWVhbiArIHF0KDAuOTc1LCBkZiA9IHJlcyRuIC0gMSkgKiByZXMkc2UKbXUgPC0gZmVtJERpcmVjdENob2wgJT4lCiAgbG9nMigpICU+JQogIG1lYW4oKQpyZXMkaW5zaWRlIDwtIHJlcyRsbCA8PSBtdSAmIG11IDw9IHJlcyR1bApyZXMkbiA8LSBhcy5mYWN0b3IocmVzJG4pCnJlcyAlPiUKICBncm91cF9ieShuKSAlPiUKICBzdW1tYXJpemUoY292ZXJhZ2UgPSBtZWFuKGluc2lkZSkpICU+JQogIHNwcmVhZChuLCBjb3ZlcmFnZSkKYGBgCgpXZSBvYnNlcnZlIHRoYXQgYWxsIHRoZSBjb3ZlcmFnZXMgb2YgdGhlIGludGVydmFscyBhcmUgbm93IGNvbnRyb2xsZWQgYXQgdGhlaXIgbm9taW5hbCA5NSUgY29uZmlkZW5jZSBsZXZlbC4KCmBgYHtyfQpyZXMgJT4lCiAgZmlsdGVyKG4gPT0gMTApICU+JQogIHNsaWNlKDE6MjApICU+JQogIGdncGxvdChhZXMoeCA9IHNhbXBsZSwgeSA9IG1lYW4sIGNvbG9yID0gaW5zaWRlKSkgKwogIGdlb21fcG9pbnQoKSArCiAgZ2VvbV9lcnJvcmJhcihhZXMoeW1pbiA9IG1lYW4gLSBxdCgwLjk3NSwgZGYgPSA5KSAqIHNlLCB5bWF4ID0gbWVhbiArIHF0KDAuOTc1LCBkZiA9IDkpICogc2UpKSArCiAgZ2VvbV9obGluZSh5aW50ZXJjZXB0ID0gZmVtJERpcmVjdENob2wgJT4lIGxvZzIoKSAlPiUgbWVhbigpKSArCiAgZ2d0aXRsZSgiMjAgQ0kgZm9yIE49MTAiKSArCiAgeWxpbShyYW5nZShmZW0kRGlyZWN0Q2hvbCAlPiUgbG9nMigpKSkKYGBgCgohW10oaHR0cHM6Ly93d3cubmF0dXJlLmNvbS9hcnRpY2xlcy9ubWV0aC4yNjU5LnBkZil7d2lkdGg9MTAwJX0KCi0tLQoKIyMgUmVwb3J0aW5nPwoKLSBBbHdheXMgcmVwb3J0IHRoZSB1bmNlcnRhaW50eSBvbiB0aGUgcmVzdWx0cyEKCi0gQ29uY2x1c2lvbnMgYmFzZWQgb24gYSBwb2ludCBlc3RpbWF0ZSBjYW4gYmUgdmVyeSBtaXNsZWFkaW5nLgoKLSBVcG9uIGEgc3RhdGlzdGljYWwgYW5hbHlzaXMgd2UgdGhlcmVmb3JlIGFsd2F5cyByZXBvcnQgY29uZmlkZW5jZSBpbnRlcnZhbHMKCi0gVGhleSBhcmUgc21hbGwgZW5vdWdoIHRvIGJlIGluZm9ybWF0aXZlIGJ1dCBhbG1vc3QgbmV2ZXIgbWlzbGVhZGluZwoKLSBUaGV5IGZvcm0gYSBnb29kIHRyYWRlLW9mZiBiZXR3ZWVuIHN0YXRpc3RpY2FsIHNpZ25pZmljYW5jZSBhbmQgYmlvbG9naWNhbCByZWxldmFuY2UuCgotIFdlIGNvbmNsdWRlIHRoYXQgdGhlIHBvcHVsYXRpb24gcGFyYW1ldGVyIGxheXMgaW4gdGhlIGludGVydmFsIGFuZCBrbm93IHRoYXQgdGhpcyBzdGF0ZW1lbnQgaG9sZHMgd2l0aCBhIHByb2JhYmlsaXR5IG9mIDk1JSBmb3IgcmFuZG9tIHNhbXBsZXMuCgojIyMgQ2FwdG9wcmlsIGV4YW1wbGUKCldlIGNvbmNsdWRlIHRoYXQgdGhlIGJsb29kIHByZXNzdXJlIGRlY3JlYXNlcyBvbiBhdmVyYWdlIHdpdGgKYHIgYWJzKHJvdW5kKG1lYW4oY2FwdG9wcmlsJGRlbHRhU0JQKSwxKSlgbW1IZyB1cG9uIGFkbWluaXN0ZXJpbmcgY2FwdG9wcmlsICg5NSUgQ0kgW2ByIHBhc3RlKHJvdW5kKG1lYW4oY2FwdG9wcmlsJGRlbHRhU0JQKStxdChjKDAuMDI1LC45NzUpLG4tMSkqc2QoY2FwdG9wcmlsJGRlbHRhU0JQKS9zcXJ0KG4pLDEpLGNvbGxhcHNlPSIsIilgXW1tSGcpLgoKQmFzZWQgb24gdGhlc2UgcmVzdWx0cyBpdCBpcyBvYnZpb3VzIHRoYXQgdGhlIHRyZWF0bWVudCBjYXVzZXMgYSBzdHJvbmcgYmxvb2QgcHJlc3N1cmUgZHJvcCBmb3IgcGF0aWVudHMgd2l0aCBoeXBlcnRlbnNpb24uCgojIEh5cG90aGVzaXMgdGVzdHMKCiMjIENhcHRvcHJpbCBFeGFtcGxlOgpSZXNlYXJjaGVycyB3YW50IHRvIGFzc2VzcyBpZiB0aGUgZHJ1ZyBjYXB0b3ByaWwgZGVjcmVhc2VzIHRoZSBibG9vZCBwcmVzc3VyZSBmb3IgcGF0aWVudHMgd2l0aCBoeXBlcnRlbnNpb24uCgotIElzIHRoZXJlIG5vL2FuIGVmZmVjdCBvZiBhZG1pbmlzdGVyaW5nIGNhcHRvcHJpbCBvbiB0aGUgc3lzdG9saWMgYmxvb2QgcHJlc3N1cmU/CgotIEl0IGlzIG5vdCBvYnZpb3VzIHRvIGRyYXcgc3VjaCBjb25jbHVzaW9ucyBiYXNlZCBvbiBhIHNtYWxsIHNhbXBsZQoKLSBJdCBpcyB1bmNlcnRhaW4gaWYgd2UgY2FuIGdlbmVyYWxpemVkIHRoZSBvYnNlcnZhdGlvbnMgaW4gdGhlIHNhbXBsZSB0b3dhcmRzIHRoZSBwb3B1bGF0aW9uIQoKLSBJcyB0aGUgYXBwYXJlbnQgYmVuZWZpY2lhbCBlZmZlY3Qgc3lzdGVtYXRpYyBvciByYW5kb20/CgpgYGB7cn0KY2FwdG9wcmlsVGlkeSAlPiUKICBmaWx0ZXIodHlwZSAlaW4lIGMoIlNCUGEiLCAiU0JQYiIpKSAlPiUKICBtdXRhdGUodHlwZSA9IGZhY3Rvcih0eXBlLCBsZXZlbHMgPSBjKCJTQlBiIiwgIlNCUGEiKSkpICU+JQogIGdncGxvdChhZXMoeCA9IHR5cGUsIHkgPSBicCkpICsKICBnZW9tX2xpbmUoYWVzKGdyb3VwID0gaWQpKSArCiAgZ2VvbV9wb2ludCgpCmBgYAoKYGBge3J9CmNhcHRvcHJpbCRkZWx0YVNCUCA8LSBjYXB0b3ByaWwkU0JQYSAtIGNhcHRvcHJpbCRTQlBiCmNhcHRvcHJpbCAlPiUKICBnZ3Bsb3QoYWVzKHggPSAiU3lzdG9saWMgYmxvb2QgcHJlc3N1cmUiLCB5ID0gZGVsdGFTQlApKSArCiAgZ2VvbV9ib3hwbG90KG91dGxpZXIuc2hhcGUgPSBOQSkgKwogIGdlb21fcG9pbnQocG9zaXRpb24gPSAiaml0dGVyIikgKwogIHlsYWIoIkRpZmZlcmVuY2UgKG1tIG1lcmN1cnkpIikgKwogIHhsYWIoIiIpCmBgYAoKCi0gVGhlIGF2ZXJhZ2UgYmxvb2QgcHJlc3N1cmUgZGlmZmVyZW5jZSAkXGJhciBYJCBpcyBhIG5hdHVyYWwgYmFzaXMgdG8gYmFzZSBvdXIgZGVjaXNpb24gb24uCgokJFxiYXIgeFx0ZXh0ez1gciByb3VuZChtZWFuKGNhcHRvcHJpbCRkZWx0YVNCUCksMilgIChzPWByIHJvdW5kKHNkKGNhcHRvcHJpbCRkZWx0YVNCUCksMilgLCBTRT1gciByb3VuZChzZChjYXB0b3ByaWwkZGVsdGFTQlApL3NxcnQoMTUpLDIpYCl9JCQKCi0gSXQgaXMgbm90IGVub3VnaCB0aGF0ICRcYmFye3h9PCAwJCB0byBjb25jbHVkZSB0aGF0IHRoZSBzeXN0b2xpYyBibG9vZCBwcmVzc3VyZSBpcyBvbiBhdmVyYWdlIGxvd2VyIHVwb24gYWRtaW5pc3RyYXRpbmcgY2FwdG9wcmlsICphdCB0aGUgbGV2ZWwgb2YgdGhlIGVudGlyZSBwb3B1bGF0aW9uKi4KCi0gVG8gZ2VuZXJhbGl6ZSB0aGUgZWZmZWN0IHdlIG9ic2VydmUgaW4gdGhlIHNhbXBsZSB0byB0aGUgcG9wdWxhdGlvbiBpdCBoYXMgdG8gYmUgc3VmZmljaWVudGx5IGxhcmdlLgoKLSBCdXQsIGhvdyBsYXJnZT8KCi0tLQoKIyMjIEh5cG90aGVzaXMgdGVzdHMKCi0gRm9yIHRoaXMgcHVycG9zZSBzdGF0aXN0aWNhbCBoeXBvdGhlc2lzIHRlc3RzIGhhdmUgYmVlbiBkZXZlbG9wZWQKLSBUaGV5IGdpdmUgYSBibGFjay93aGl0ZSBhbnN3ZXIKLSBJdCBpcyBhbG1vc3QgaW1wb3NzaWJsZSB0byByZWFkIGEgc2NpZW50aWZpYyBwdWJsaWNhdGlvbiB3aXRob3V0IHJlc3VsdHMgb2Ygc3RhdGlzdGljYWwgdGVzdHMuCi0gQWNjb3JkaW5nIHRvIHRoZSAqZmFsc2lmaWNhdGlvbiBwcmluY2lwbGUqIG9mIFBvcHBlciB3ZSBjYW4gbmV2ZXIgcHJvdmUgYSBoeXBvdGhlc2lzIGJhc2VkIG9uIGRhdGEuCgogICAgLSBIZW5jZSB3ZSB3aWxsIGludHJvZHVjZSB0d28gaHlwb3RoZXNlczogYSBudWxsIGh5cG90aGVzaXMgJEhfMCQgYW5kIGFuIGFsdGVybmF0aXZlIGh5cG90aGVzaXMgJEhfMSQuCgogICAgLSBXZSB3aWxsIHRyeSB0byBmYWxzaWZ5IHRoZSBudWxsIGh5cG90aGVzaXMgYmFzZWQgb24gdGhlIHN0YXRpc3RpY2FsIHRlc3QuCgojIyMjIENhcHRvcHJpbAoKLSBCYXNlZCBvbiB0aGUgc2FtcGxlIHdlIGNhbm5vdCBwcm92ZSB0aGF0IHRoZXJlIGlzIGFuIGVmZmVjdCBvZiBhZG1pbmlzdGVyaW5nIGNhcHRvcHJpbCAoJEhfMSQgLCBhbHRlcm5hdGl2ZSBoeXBvdGhlc2lzKS4KCi0gV2UgdGhlcmVmb3JlIHN1cHBvc2UgdGhhdCB0aGVyZSBpcyBubyBlZmZlY3Qgb2YgY2FwdG9wcmlsLgoKICAgIC0gV2UgcmVmZXIgdG8gdGhpcyBhcyB0aGUgbnVsbCBoeXBvdGhlc2lzICRIXzAkLgoKICAgIC0gRmFsc2lmeSAoInRyeSB0byByZWplY3QiKSB0aGUgJEhfMCQuCgogICAgLSBIb3cgbGlrZWx5IGlzIGl0IHRvIG9ic2VydmUgYW4gZWZmZWN0IHRoYXQgaXMgYXQgbGVhc3QgYXMgbGFyZ2UgYXMgd2hhdCB3ZSBoYXZlIG9ic2VydmVkIGluIG91ciBzYW1wbGUgaW4gYSBub3ZlbCByYW5kb20gc2FtcGxlIHdoZW4gICRIXzAkIGlzIHRydWU/CgotLS0KCgojIyMjIFBlcm11dGF0aW9uIHRlc3QKCgotIFVuZGVyICRIXzAkIHRoZSBibG9vZCBwcmVzc3VyZSBtZWFzdXJlbWVudHMgYmVmb3JlIGFuZCBhZnRlciBhZG1pbmlzdGVyaW5nIGNhcHRvcHJpbCBhcmUgdHdvIGJhc2UgbGluZSBibG9vZCBwcmVzc3VyZSBtZWFzdXJlbWVudHMgZm9yIGEgcGF0aWVudAoKLSBVbmRlciBIJF8wJCB3ZSBjYW4gc2h1ZmZsZSAocGVybXV0ZSkgdGhlIGJsb29kIHByZXNzdXJlIG1lYXN1cmVtZW50cyBmb3IgZWFjaCBwYXRpZW50LgoKCmBgYHtyfQpjYXB0b3ByaWxTYW1wIDwtIGNhcHRvcHJpbApwZXJtIDwtIHNhbXBsZShjKEZBTFNFLCBUUlVFKSwgMTUsIHJlcGxhY2UgPSBUUlVFKQpjYXB0b3ByaWxTYW1wJFNCUGFbcGVybV0gPC0gY2FwdG9wcmlsJFNCUGJbcGVybV0KY2FwdG9wcmlsU2FtcCRTQlBiW3Blcm1dIDwtIGNhcHRvcHJpbCRTQlBhW3Blcm1dCmNhcHRvcHJpbFNhbXAkZGVsdGFTQlAgPC0gY2FwdG9wcmlsU2FtcCRTQlBhIC0gY2FwdG9wcmlsU2FtcCRTQlBiCmNhcHRvcHJpbFNhbXAgJT4lCiAgZ2F0aGVyKHR5cGUsIGJwLCAtaWQpICU+JQogIGZpbHRlcih0eXBlICVpbiUgYygiU0JQYSIsICJTQlBiIikpICU+JQogIG11dGF0ZSh0eXBlID0gZmFjdG9yKHR5cGUsIGxldmVscyA9IGMoIlNCUGIiLCAiU0JQYSIpKSkgJT4lCiAgZ2dwbG90KGFlcyh4ID0gdHlwZSwgeSA9IGJwKSkgKwogIGdlb21fbGluZShhZXMoZ3JvdXAgPSBpZCkpICsKICBnZW9tX3BvaW50KCkKYGBgCgoKCgpgYGB7cn0KZGF0YS5mcmFtZShkZWx0YVNCUCA9IGMoY2FwdG9wcmlsJGRlbHRhU0JQLCBjYXB0b3ByaWxTYW1wJGRlbHRhU0JQKSwgc2h1ZmZsZWQgPSByZXAoYyhGQUxTRSwgVFJVRSksIGVhY2ggPSAxNSkpICU+JQogIGdncGxvdChhZXMoeCA9IHNodWZmbGVkLCB5ID0gZGVsdGFTQlApKSArCiAgZ2VvbV9ib3hwbG90KG91dGxpZXIuc2hhcGUgPSBOQSkgKwogIGdlb21fcG9pbnQocG9zaXRpb24gPSAiaml0dGVyIikgKwogIHN0YXRfc3VtbWFyeShmdW4ueSA9IG1lYW4sIGdlb20gPSAicG9pbnQiLCBzaGFwZSA9IDE5LCBzaXplID0gMywgY29sb3IgPSAicmVkIiwgZmlsbCA9ICJyZWQiKSArCiAgeWxhYigiRGlmZmVyZW5jZSAobW0gbWVyY3VyeSkiKQpgYGAKCkFuZCB3ZSBwZXJtdXRlIGFnYWluCgoKYGBge3J9CmNhcHRvcHJpbFNhbXAgPC0gY2FwdG9wcmlsCnBlcm0gPC0gc2FtcGxlKGMoRkFMU0UsIFRSVUUpLCAxNSwgcmVwbGFjZSA9IFRSVUUpCmNhcHRvcHJpbFNhbXAkU0JQYVtwZXJtXSA8LSBjYXB0b3ByaWwkU0JQYltwZXJtXQpjYXB0b3ByaWxTYW1wJFNCUGJbcGVybV0gPC0gY2FwdG9wcmlsJFNCUGFbcGVybV0KY2FwdG9wcmlsU2FtcCRkZWx0YVNCUCA8LSBjYXB0b3ByaWxTYW1wJFNCUGEgLSBjYXB0b3ByaWxTYW1wJFNCUGIKCmNhcHRvcHJpbFNhbXAgJT4lCiAgZ2F0aGVyKHR5cGUsIGJwLCAtaWQpICU+JQogIGZpbHRlcih0eXBlICVpbiUgYygiU0JQYSIsICJTQlBiIikpICU+JQogIG11dGF0ZSh0eXBlID0gZmFjdG9yKHR5cGUsIGxldmVscyA9IGMoIlNCUGIiLCAiU0JQYSIpKSkgJT4lCiAgZ2dwbG90KGFlcyh4ID0gdHlwZSwgeSA9IGJwKSkgKwogIGdlb21fbGluZShhZXMoZ3JvdXAgPSBpZCkpICsKICBnZW9tX3BvaW50KCkKCmRhdGEuZnJhbWUoZGVsdGFTQlAgPSBjKGNhcHRvcHJpbCRkZWx0YVNCUCwgY2FwdG9wcmlsU2FtcCRkZWx0YVNCUCksIHNodWZmbGVkID0gcmVwKGMoRkFMU0UsIFRSVUUpLCBlYWNoID0gMTUpKSAlPiUKICBnZ3Bsb3QoYWVzKHggPSBzaHVmZmxlZCwgeSA9IGRlbHRhU0JQKSkgKwogIGdlb21fYm94cGxvdChvdXRsaWVyLnNoYXBlID0gTkEpICsKICBnZW9tX3BvaW50KHBvc2l0aW9uID0gImppdHRlciIpICsKICBzdGF0X3N1bW1hcnkoZnVuLnkgPSBtZWFuLCBnZW9tID0gInBvaW50Iiwgc2hhcGUgPSAxOSwgc2l6ZSA9IDMsIGNvbG9yID0gInJlZCIsIGZpbGwgPSAicmVkIikgKwogIHlsYWIoIkRpZmZlcmVuY2UgKG1tIG1lcmN1cnkpIikKYGBgCgoKLSBXZSB3aWxsIGRvIHRoaXMgMTAwMDAgdGltZXMgYW5kIHdlIHdpbGwga2VlcCB0cmFjayBvZiB0aGUgbWVhbi4KLSBXZSBiYXNpY2FsbHkgb25seSBoYXZlIHRvIHN3YXAgdGhlIHNpZ25zIG9mIHRoZSBvYnNlcnZlZCBibG9vZCBwcmVzc3VyZSBkaWZmZXJlbmNlcyAkeCQgd2hlbiB3ZSBzaHVmZmxlLgoKYGBge3J9CiMgZ2VuZXJhdGUgYSBtYXRyaXggd2l0aCAxNSByb3dzIGFuZCAxMDAwMCBjb2x1bW5zIHdoaWNoIGNvbnNpc3Qgb2YgLTEgYW5kIDEKcGVybUggPC0gc2FtcGxlKGMoLTEsIDEpLCAxNTAwMDAsIHJlcGxhY2UgPSBUUlVFKQpkaW0ocGVybUgpIDwtIGMoMTUsIDEwMDAwKQoKIyBjYWxjdWxhdGUgdGhlIG1lYW5zIGZvciB0aGUgcGVybXV0ZWQgZGF0YQptdVBlcm0gPC0gY29sTWVhbnMocGVybUggKiBjYXB0b3ByaWwkZGVsdGFTQlApCm11UGVybSAlPiUKICBhcy5kYXRhLmZyYW1lKCkgJT4lCiAgZ2dwbG90KGFlcyh4ID0gLikpICsKICBnZW9tX2hpc3RvZ3JhbSgpICsKICBnZW9tX3ZsaW5lKHhpbnRlcmNlcHQgPSBtZWFuKGNhcHRvcHJpbCRkZWx0YVNCUCksIGNvbCA9ICJibHVlIikKYGBgCgotIFdlIG9ic2VydmUgdGhhdCBub3Qgb25lIG9mIHRoZSBtZWFucyB0aGF0IHdlcmUgb2J0YWluZWQgdW5kZXIgJEhfMCQgKGJ5IHBlcm11dGF0aW9uKSB3ZXJlIGFzIGV4dHJlbWUgYXMgdGhlIHNhbXBsZSBtZWFuIHdlIG9ic2VydmVkIGluIHRoZSBjYXB0b3ByaWwgc3R1ZHkuCgotIFNvIHRoZSBwcm9iYWJpbGl0eSB0byBvYnNlcnZlIGEgYmxvb2QgcHJlc3N1cmUgZHJvcCB0aGF0IGlzIGxhcmdlciB0aGVuIHRoZSBvbmUgaW4gdGhlIGNhcHRvcHJpbCBzdHVkeSBpbiBhIHJhbmRvbSBzYW1wbGUgZ2VuZXJhdGVkIHVuZGVyIHRoZSBudWxsIGh5cG90aGVzaXMgaXMgIHNtYWxsZXIgdGhlbiAxIG91dCBvZiAxMDAwMC4KClNvIHdlIGhhdmUgc3Ryb25nIGV2aWRlbmNlIHRoYXQgJEhfMCQgaXMgaW5jb3JyZWN0IGFuZCB3ZSB0aHVzIHdlIHJlamVjdCBpdCBhbmQgY29uY2x1ZGUgJEhfMSQ6IFRoZXJlIGlzIGFuIGVmZmVjdCBvZiBhZG1pbmlzdGVyaW5nIGNhcHRvcHJpbCBvbiB0aGUgYmxvb2QgcHJlc3N1cmUgb2YgcGF0aWVudHMgd2l0aCBoeXBlcnRlbnNpb24uCgotLS0KCiMjIyBQaXZvdAoKLSBJbiBwcmFjdGljZSB3ZSBhbHdheXMgdXNlIHN0YXRpc3RpY3MgdGhhdCBiYWxhbmNlIHRoZSBlZmZlY3Qgc2l6ZSAoYXZlcmFnZSBkaWZmZXJlbmNlKSB0byB0aGUgbm9pc2UgKHN0YW5kYXJkIGVycm9yKQoKLSBXaGVuIHdlIGZhbHNpZnkgdGhlIG51bGwgaHlwb3RoZXNpcywgd2Ugc3RhbmRhcmRpemUgdGhlIG1lYW4gYXJvdW5kICRcbXVfMD0wJCB0aGUgbWVhbiB1bmRlciAkSF8wJAoKJCR0PVxmcmFje1xiYXIgWC1cbXVfMH17c2Vfe1xiYXIgWH19JCQKCi0gZm9yIHRoZSBjYXB0b3ByaWwgZXhhbXBsZSB0aGlzIGJlY29tZXM6CiQkXGZyYWN7YHIgcm91bmQobWVhbihjYXB0b3ByaWwkZGVsdGFTQlApLDIpYC0wfXtgciByb3VuZChzZChjYXB0b3ByaWwkZGVsdGFTQlApL3NxcnQoMTUpLDIpYH09YHIgcm91bmQobWVhbihjYXB0b3ByaWwkZGVsdGFTQlApLyhzZChjYXB0b3ByaWwkZGVsdGFTQlApL3NxcnQoMTUpKSwyKWAkJAoKCldlIG5vdyBkZXRlcm1pbmUgdGhlIG51bGwgZGlzdHJpYnV0aW9uIG9mIHRlc3Qgc3RhdGlzdGljIHQgd2l0aCBwZXJtdXRhdGlvbi4KCmBgYHtyfQpkZWx0YVBlcm1zIDwtIHBlcm1IICogY2FwdG9wcmlsJGRlbHRhU0JQCnRQZXJtIDwtIGNvbE1lYW5zKGRlbHRhUGVybXMpIC8gKGFwcGx5KGRlbHRhUGVybXMsIDIsIHNkKSAvIHNxcnQoMTUpKQp0T3JpZyA8LSBtZWFuKGNhcHRvcHJpbCRkZWx0YVNCUCkgLyBzZChjYXB0b3ByaWwkZGVsdGFTQlApICogc3FydCgxNSkKCnRQZXJtUGxvdCA8LSB0UGVybSAlPiUKICBhcy5kYXRhLmZyYW1lKCkgJT4lCiAgZ2dwbG90KGFlcyh4ID0gLikpICsKICBnZW9tX2hpc3RvZ3JhbShhZXMoeSA9IC4uZGVuc2l0eS4uLCBmaWxsID0gLi5jb3VudC4uKSkgKwogIGdlb21fdmxpbmUoeGludGVyY2VwdCA9IHRPcmlnLCBjb2wgPSAiYmx1ZSIpCnRQZXJtUGxvdApgYGAKCi0gQWdhaW4sIG5vbmUgb2YgdGhlIHBlcm11dGF0aW9ucyBnaXZlcyBhIHQtc3RhdGlzdGljIGFzIGV4dHJlbWUgYXMgdGhlIG9uZSBvYnNlcnZlZCBpbiB0aGUgY2FwdG9wcmlsIHN0dWR5LgoKV2hlbiB0aGVyZSBpcyBubyBlZmZlY3Qgb2YgY2FwdG9wcmlsIGl0IGlzIG5lYXJseSBpbXBvc3NpYmxlIHRvIG9idGFpbiBhIHRlc3Qgc3RhdGlzdGljIGFzIGV4dHJlbWUgYXMgdGhlIG9uZSB0aGF0IHdhcyBvYnNlcnZlZCAoICB0PWByIHJvdW5kKHRPcmlnLDIpYCkuCgotIFRoZSBwcm9iYWJpbGl0eSB0byBvYnNlcnZlIGEgbGFyZ2VyIGJsb29kIHByZXNzdXJlIGRyb3AgdGhlbiB0aGUgb25lIHdlIG9ic2VydmVkIGluIG91ciBzYW1wbGUgaW4gYSByYW5kb20gc2FtcGxlIHVuZGVyICRIXzAkIGlzIHNtYWxsZXIgMS8xMDAwMC4KCi0gV2UgcmVmZXIgdG8gdGhpcyBwcm9iYWJpbGl0eSB3aXRoIHRoZSAqcC12YWx1ZSouCgotIEl0IG1lYXN1cmVzIHRoZSBzdHJlbmd0aCBvZiB0aGUgZXZpZGVuY2UgYWdhaW5zdCB0aGUgbnVsbDogdGhlIHNtYWxsZXIgdGhlIHAtdmFsdWUgdGhlIG1vcmUgZXZpZGVuY2Ugd2UgaGF2ZSB0aGF0IHRoZSBudWxsIGlzIG5vdCB0cnVlLgoKLSBUaGUgZGlzdHJpYnV0aW9uIGhhcyBhIG5pY2UgYmVsbCBzaGFwZS4KCi0tLQoKIyMjIEhvdyBkbyB3ZSBkZWNpZGU/CgpXaGVuIGlzIHRoZSBwLXZhbHVlIHN1ZmZpY2llbnRseSBzbWFsbCB0byBjb25jbHVkZSB0aGF0IHRoZXJlIGlzIHN0cm9uZyBldmlkZW5jZSBhZ2FpbnN0IHRoZSBudWxsIGh5cG90aGVzaXM/CgotIFdlIHR5cGljYWxseSB3b3JrIGF0IGEgc2lnbmlmaWNhbmNlIGxldmVsIG9mICRcYWxwaGE9MC4wNSQKCi0gV2Ugc3RhdGUgdGhhdCB3ZSBjb25kdWN0ZWQgdGhlIHRlc3QgYXQgdGhlIDUlIHNpZ25pZmljYW5jZSBsZXZlbAoKLS0tCgojIyMgUGVybXV0YXRpb24gdGVzdHMgYXJlIGNvbXB1dGF0aW9uYWxseSBkZW1hbmRpbmcKCi0gQ2FuIHdlIGFzc2VzcyBob3cgZXh0cmVtZSB0aGUgYmxvb2QgcHJlc3N1cmUgZHJvcCB3YXMgd2l0aG91dCBwZXJtdXRhdGlvbj8KCi0gV2Uga25vdyB0aGF0IHRoZSBibG9vZCBwcmVzc3VyZSBkaWZmZXJlbmNlcyBhcmUgYXBwcm94aW1hdGVseSBOb3JtYWxseSBkaXN0cmlidXRlZCwgc28KCiQkdD1cZnJhY3tcYmFyIFggLSBcbXV9e3NlX3tcYmFyIFh9fSQkCgpmb2xsb3dzIGEgdC1kaXN0cmlidXRpb24gKHdpdGggMTQgZGYgZm9yIHRoZSBjYXB0b3ByaWwgZXhhbXBsZSkuCgoKLSBVbmRlciBIJF8wJCAkXG11PTAkIGFuZCAkJHQ9XGZyYWN7XGJhciBYLTB9e3NlX3tcYmFyIFh9fVxzaW0gZl97VCwxNH0kJAoKYGBge3J9CnRQZXJtUGxvdCArCiAgc3RhdF9mdW5jdGlvbihmdW4gPSBkdCwgY29sb3IgPSAicmVkIiwgYXJncyA9IGxpc3QoZGYgPSAxNCkpCmBgYAoKLSBOb3RlLCB0aGUgcGVybXV0YXRpb24gbnVsbCBkaXN0cmlidXRpb24gaW5kZWVkIGNvcnJlc3BvbmRzIHRvIGEgdC1kaXN0cmlidXRpb24gd2l0aCAxNCBkZWdyZWVzIG9mIGZyZWVkb20uCgotIFNvIHdlIGNhbiBjb25kdWN0IHRoZSBzdGF0aXN0aWNhbCB0ZXN0IHVzaW5nIHN0YXRpc3RpY2FsIG1vZGVsbGluZyBvZiB0aGUgZGF0YS4KCi0gV2UgbmVlZCB0byBtYWtlIGFzc3VtcHRpb25zIGZvciB0aGlzLCB3aGljaCB3ZSB2ZXJpZnkgaW4gdGhlIGRhdGEgZXhwbG9yYXRpb24gcGhhc2UuCgoKLS0tCgoKIyMgSHlwb3RoZXNlcwoKPGRldGFpbHM+PHN1bW1hcnk+Q2xpY2sgdG8gc2VlIG1vcmUgZm9ybWFsIGRldGFpbHMgPC9zdW1tYXJ5PjxwPgoKVHJhbnNsYXRlIHRoZSByZXNlYXJjaCBxdWVzdGlvbiB0byBhIG51bGwgaHlwb3RoZXNpcyAoJEhfMCQpIGFuZCBhbiBhbHRlcm5hdGl2ZSBoeXBvdGhlc2lzICgkSF8xJCkKCkZpcnN0IHRoZSB3ZSBuZWVkIHRvIHRyYW5zbGF0ZSB0aGUgcmVzZWFyY2ggcXVlc3Rpb24gdG8gYSBwYXJhbWV0ZXJpemVkIHN0YXRpc3RpY2FsIG1vZGVsLgoKLSBGcm9tIHRoZSBleHBlcmltZW50YWwgZGVzaWduIGl0IGZvbGxvd3MgdGhhdCAgJCRYXzEsLi4uLFhfbiBcdGV4dHsgaS5pLmQgfSBmKFgpLCQkIHdpdGggJGYoWCkkIHRoZSBkZW5zaXR5IGZ1bmN0aW9uIG9mIGJsb29kIHByZXNzdXJlIGRpZmZlcmVuY2VzLgoKLSAqKlNpbXBsaWZ5Kio6IGFzc3VtZSB0aGF0ICRmKFgpJCBpcyBrbm93biBleGNlcHQgZm9yIGFuIGZpbml0ZSBkaW1lbnNpb25hbCBzZXQgb2YgcGFyYW1ldGVycyAkXG1hdGhiZntcdGhldGF9JCB0aGF0IHN0aWxsIGhhcyB0byBiZSBlc3RpbWF0ZWQgKHBhcmFtZXRyaWMgc3RhdGlzdGljIG1vZGVsKS4KPC9wPjwvZGV0YWlscz4KCiMjIyBDYXB0b3ByaWwgZXhhbXBsZQoKPGRldGFpbHM+PHN1bW1hcnk+Q2xpY2sgdG8gc2VlIG1vcmUgZm9ybWFsIGRldGFpbHMgPC9zdW1tYXJ5PjxwPgokWCBcc2ltIE4oXG11LFxzaWdtYV4yKSQgd2l0aCAkXG1hdGhiZntcdGhldGF9PShcbXUsXHNpZ21hXjIpJCwgdGhlIG1lYW4gJFxtdSQgYW5kIHZhcmlhbmNlICRcc2lnbWFeMiQuCgpUaGUgcmVzZWFyY2ggcXVlc3Rpb24gaXMgbm93IHRyYW5zbGF0ZWQgaW4gdGVybXMgb2YgdGhlIGF2ZXJhZ2UgYmxvb2QgcHJlc3N1cmUgZHJvcDogJFxtdT1FX2ZbWF0kLgoKVGhlICoqYWx0ZXJuYXRpdmUgaHlwb3RoZXNpcyoqIGlzIGZvcm11bGF0ZWQgaW4gdGVybXMgb2YgYSBwYXJhbWV0ZXIgb2YgJGYoWCkkIGFuZCBoYXMgdG8gZXhwcmVzcyB3aGF0IHRoZSByZXNlYXJjaGVycyB3YW50IHRvIHByb3ZlIHdpdGggdGhlIHN0dWR5LgoKLSBIZXJlOgokJEhfMTogXG11PDAuJCQgT24gYXZlcmFnZSB0aGUgYmxvb2QgcHJlc3N1cmUgb2YgcGF0aWVudHMgd2l0aCBoeXBlcnRlbnNpb24gZGVjcmVhc2VzIHVwb24gYWRtaW5pc3RlcmluZyBjYXB0b3ByaWwuCgoKVGhlICoqbnVsbCBoeXBvdGhlc2lzKiogZ2VuZXJhbGx5IGV4cHJlc3NlcyBhIG51bGwgY29uZGl0aW9uLCBpLmUuIHdoZW4gbm90dGluZyBleGNlcHRpb25hbCBoYXBwZW5zLgoKLSBSZXNlYXJjaGVycyB0eXBpY2FsbHkgYWltIHRvIHByb3ZlIHZpYSBlbXBpcmljYWwgcmVzZWFyY2ggdGhhdCBvYnNlcnZpbmcgdGhlIGRhdGEgdW5kZXIgdGhlIG51bGwgaXMgaGlnaGx5IHVubGlrZWx5IHNvIHRoYXQgdGhleSBjYW4gcmVqZWN0IHRoZSBudWxsIGh5cG90aGVzaXM6CioqRmFsc2lmaWNhdGlvbiBwcmluY2lwbGUqKi4KCi0gVGhlICoqbnVsbCBoeXBvdGhlc2lzIGlzIHR5cGljYWxseSBleHByZXNzZWQgd2l0aCB0aGUgc2FtZSBtb2RlbCBwYXJhbWV0ZXIgYXMgdGhlIG9uZSB1c2VkIGZvciAkSF8xJC4qKgoKLSBIZXJlOgokJEhfMCA6IFxtdT0wJCQgaS5lLiBvbiBhdmVyYWdlIHRoZSBzeXN0b2xpYyBibG9vZCBwcmVzc3VyZSByZW1haW5zIHVuY2hhbmdlZCB1cG9uIGFkbWluaXN0ZXJpbmcgY2FwdG9wcmlsLgoKPC9wPjwvZGV0YWlscz4KCi0tLQoKIyMgVGVzdC1zdGF0aXN0aWMKCjxkZXRhaWxzPjxzdW1tYXJ5PkNsaWNrIHRvIHNlZSBtb3JlIGZvcm1hbCBkZXRhaWxzIDwvc3VtbWFyeT48cD4KCk9uY2UgdGhlIHBvcHVsYXRpb24sIHRoZSBwYXJhbWV0ZXJzLCBhbmQsICRIXzAkIGFuZCAkSF8xJCBhcmUgZGV0ZXJtaW5lZCB0aGUgY29uY2VwdCBvZiBoeXBvdGhlc2lzIHRlc3RpbmcgaXMgYXMgZm9sbG93czoKCgpDb25zdHJ1Y3QgYSB0ZXN0IHN0YXRpc3RpYyBzbyB0aGF0IGl0CgoxLiBtZWFzdXJlcyBldmlkZW5jZSBpbiB0aGUgc2FtcGxlLApcdnNwYWNlezEwcHR9CjIuIGFnYWluc3QgdGhlIG51bGwgaHlwb3RoZXNpcywgYW5kClx2c3BhY2V7MTBwdH0KMy4gaW4gZmF2b3VyIG9mIHRoZSBhbHRlcm5hdGl2ZSBoeXBvdGhlc2lzLgoKQSB0ZXN0IHN0YXRpc3RpYyB0aHVzIGhhcyB0byBiZSBhIGZ1bmN0aW9uIG9mIHRoZSBvYnNlcnZhdGlvbnMgaW4gdGhlIHNhbXBsZS4KCjwvcD48L2RldGFpbHM+CgojIyMgQ2FwdG9wcmlsIGV4YW1wbGUKCjxkZXRhaWxzPjxzdW1tYXJ5PkNsaWNrIHRvIHNlZSBtb3JlIGZvcm1hbCBkZXRhaWxzIDwvc3VtbWFyeT48cD4KCiQkVD1cZnJhY3tcYmFye1h9LVxtdV8wfXtcdGV4dHtTRX1fe1xiYXIgWH19JCQKV2l0aCAkXG11XzA9MCQgdW5kZXIgJEhfMCQKCkFnYWluCgotIElmICRIXzAkIGhvbGRzIHRoZXJlIGlzIG5vIGVmZmVjdCBvZiBjYXB0b3ByaWwgb24gdGhlIGJsb29kIHByZXNzdXJlIGluIHRoZSBwb3B1bGF0aW9uIGFuZCB0aGVuIHdlIGV4cGVjdCB0ZXN0IHN0YXRpc3RpYyAkVCQgY2xvc2UgdG8gMC4KCi0gSWYgJEhfMSQgaXMgdHJ1ZSB3ZSBleHBlY3QgJFQ8MCQuCgotIEluIHRoZSBjYXB0b3ByaWwgZXhhbXBsZSB3ZSBvYnNlcnZlICR0PSgtMTguOTMtMCkvMi4zMz0tOC4xMiQuCgotIElzICR0ID0gLTguMTIkIGxhcmdlIGVub3VnaCBpbiBhYnNvbHV0ZSB2YWx1ZSB0byBjb25jbHVkZSB0aGF0ICAkXG11IDwgMCQgYW5kIHdpdGggd2hpY2ggY29uZmlkZW5jZSBjYW4gd2UgbWFrZSB0aGlzIGNvbmNsdXNpb24/CgotIFdlIGtub3duIHRoYXQgdCBmb2xsb3dzIGEgdC1kaXN0cmlidXRpb24gd2l0aCAxNCBkLmYuIHVuZGVyICRIXzAkCgo8L3A+PC9kZXRhaWxzPgoKLS0tCgojIyBwLXZhbHVlCgpUaGUgcC12YWx1ZSBpcyB0aGUgcHJvYmFiaWxpdHkgdG8gYmFsYW5jZSBiZXR3ZWVuICRIXzAkIGFuZCAkSF8xJC4KClRoZSB3YXkgaG93IHdlIGNhbGN1bGF0ZSBpdCBpcyBjb250ZXh0IGRlcGVuZGVudAoKLSBGb3IgdGhlIGNhcHRvcHJpbCBleGFtcGxlIHdlIGhhdmUKICAkJAogICAgcCA9IFBcbGVmdFtUIFxsZXEgdCBcbWlkIEhfMFxyaWdodF0gPSBcdGV4dHtQfV8wXGxlZnRbVFxsZXEgdFxyaWdodF0sCiAgJCQKd2l0aCB0aGUgaW5kZXggIjAiIGluICRcdGV4dHtQfV8wXGxlZnRbLlxyaWdodF0kIGluZGljYXRlcyB0aGF0IHRoZSBwcm9iYWJpbGl0eSBpcyBjYWxjdWxhdGVkIHVuZGVyICRIXzAkLgoKSXQgZ2l2ZXMgdGhlIHByb2JhYmlsaXR5IHRvIG9ic2VydmUgYSB0ZXN0IHN0YXRpc3RpYyAkVCQgbG93ZXIgb3IgZXF1YWwgdG8gdGhlIHZhbHVlIG9ic2VydmVkIGluIHRoZSBjdXJyZW50IHNhbXBsZSBpbiBhIHJhbmRvbSBzYW1wbGUgdW5kZXIgJEhfMCQKCiAgICAtIGkuZS4gYSB0ZXN0IHN0YXRpc3RpYyAkVCQgaW4gdGhlIHJhbmRvbSBzYW1wbGUgdW5kZXIgJEhfMCQgd2l0aCBhIHZhbHVlIHRoYXQgaXMgbW9yZSBleHRyZW1lLCBtb3JlIGluIHRoZSBkaXJlY3Rpb24gb2YgJEhfMSQgdGhlbiB0aGUgb25lIG9ic2VydmVkIGluIHRoZSBjdXJyZW50IHNhbXBsZS4KCiMjIyBDYXB0b3ByaWwgZXhhbXBsZQoKPGRldGFpbHM+PHN1bW1hcnk+Q2xpY2sgdG8gc2VlIG1vcmUgZm9ybWFsIGRldGFpbHMgPC9zdW1tYXJ5PjxwPgoKLSBUaGUgJHAkLXZhbHVlIGZvciB0aGUgY2FwdG9wcmlsIGV4YW1wbGUgaXMgY2FsY3VsYXRlZCBhcyBmb2xsb3dzCiAgJCRwPSBcdGV4dHtQfV8wXGxlZnRbVFxsZXEgLTguMTJccmlnaHRdPUZfdCgtOC4xMjsxNCkgPSAwLjZcIDEwXnstNn0uJCQKCiAgd2l0aCAkRl90KDsxNCkkIHRoZSBjdW11bGF0aXZlIGRpc3RyaWJ1dGlvbiBmdW5jdGlvbiBvZiBhIHQtZGlzdHJpYnV0aW9uIHdpdGggMTQgZGVncmVlcyBvZiBmcmVlZG9tOgoKJCRGX3QoeDsxNCk9XGludFxsaW1pdHNfey1caW5mdHl9Xnt4fSBmX3QoeDsxNCkuJCQKCmFuZCAkZl90KC47MTQpJCB0aGUgZGVuc2l0eSBmdW5jdGlvbiBvZiB0aGUgdC1kaXN0cmlidXRpb24uCgoKLSBXZSBjYWxjdWxhdGUgdGhpcyBwcm9iYWJpbGl0eSBpbiBSIHdpdGggYHB0KHgsZGYpYAoKICAgIC0gdGhlIHZhbHVlIG9mIHRoZSBvYnNlcnZlZCB0ZXN0IHN0YXRpc3RpYyBgeGAgZW4KICAgIC0gdGhlIG51bWJlciBvZiBkZWdyZWVzIG9mIGZyZWVkb20gb2YgdGhlIHQtZGlzdHJpYnV0aW9uIGBkZmAuCgotIGBwdCh4LGRmKWAgY2FsY3VsYXRlcyB0aGUgcHJvYmFiaWxpdHkgdG8gb2JzZXJ2ZSBhIHZhbHVlIHNtYWxsZXIgb3IgZXF1YWwgdG8geCB3aGVuIHdlIHdvdWxkIGRyYXcgYSByYW5kb20gc2FtcGxlIGZyb20gYSB0LWRpc3RyaWJ1dGlvbiB3aXRoIGRmIGRlZ3JlZXMgb2YgZnJlZWRvbS4KCmBgYHtyfQpuIDwtIGxlbmd0aChjYXB0b3ByaWwkZGVsdGFTQlApCnN0YXQgPC0gKG1lYW4oY2FwdG9wcmlsJGRlbHRhU0JQKSAtIDApIC8gKHNkKGNhcHRvcHJpbCRkZWx0YVNCUCkgLyBzcXJ0KG4pKQpzdGF0CnB0KHN0YXQsIG4gLSAxKQpgYGAKCjwvcD48L2RldGFpbHM+CgpJbiBwcmFjdGljZSB3ZSB3aWxsIG5vdCBjYWxjdWxhdGUgdGhlIHRlc3Qgb3Vyc2VsZiwgYnV0IHdlIHdpbGwgdXNlIHRoZSBmdW5jdGlvbiB0LnRlc3Q6CgpgYGB7cn0KdC50ZXN0KGNhcHRvcHJpbCRkZWx0YVNCUCwgYWx0ZXJuYXRpdmUgPSAibGVzcyIpCmBgYAoKTm90ZSwgdGhhdCB3ZSBuZWVkIHRvIHNwZWNpZnkgdGhlIGFyZ3VtZW50IGBhbHRlcm5hdGl2ZT0ibGVzcyJgIHNvIHRoYXQgdGhlIHAtdmFsdWUgd291bGQgYmUgY2FsY3VsYXRlZCBpbiB0aGUgbGVmdCB0YWlsLgoKVGhlIGZ1bmN0aW9uIGFsc28gZ2l2ZXMgYSBvbmUtc2lkZWQgaW50ZXJ2YWwgYmVjYXVzZSB3ZSB0ZXN0IGluIG9uZSBkaXJlY3Rpb24uCgotLS0KCiMjIyBEZWZpbml0aW9uIG9mIHRoZSBwLXZhbHVlCgpUaGUgKipwLXZhbHVlKiogKGFsc28gcmVmZXJyZWQgdG8gYXMgdGhlICoqb2JzZXJ2ZWQgc2lnbmlmaWNhbmNlIGxldmVsKiopIGlzIHRoZSBwcm9iYWJpbGl0eSB0byBvYnNlcnZlIGEgdGVzdCBzdGF0aXN0aWMgaW4gYSByYW5kb20gc2FtcGxlIHVuZGVyIHRoZSBudWxsIGh5cG90aGVzaXMgdGhhdCBpcyBhcyBvciBtb3JlIGV4dHJlbWUgdGhlbiB0aGUgdGVzdCBzdGF0aXN0aWMgb2JzZXJ2ZWQgaW4gdGhlIGN1cnJlbnQgc2FtcGxlLgoKLSBUaGUgc21hbGxlciB0aGUgcHJvYmFiaWxpdHkgdGhlIG1vcmUgZXZpZGVuY2UgYWdhaW5zdCAkSF8wJC4KCi0gTm90ZSwgdGhhdCB0aGUgcC12YWx1ZSBpcyAqKm5vdCoqIHRoZSBwcm9iYWJpbGl0eSB0aGF0IG51bGwgaHlwb3RoZXNpcyBpcyB0cnVlIQoKLSBUaGUgd29yZCAiZXh0cmVtZSIgaW5kaWNhdGVzIG9uIHRoZSBkaXJlY3Rpb24gaW4gd2hpY2ggdGhlIHRlc3Qgc3RhdGlzdGljIGlzIG1vcmUgbGlrZWx5IHVuZGVyIHRoZSBhbHRlcm5hdGl2ZSBoeXBvdGhlc2lzLgoKLSBJbiB0aGUgZXhhbXBsZSAkSF8xOiBcbXUgPCAwJCBhbmQgd2UgdGh1cyBleHBlY3QgdmVyeSBuZWdhdGl2ZSB2YWx1ZXMgZm9yICR0JCB1bmRlciAkSF8xJC4KCi0gRnJvbSB0aGUgZGVmaW5pdGlvbiBzbWFsbCAkcCQtdmFsdWVzIGluZGljYXRlIHRoYXQgb2JzZXJ2ZWQgdGVzdCBzdGF0aXN0aWMgaXMgdW5saWtlbHkgdW5kZXIgdGhlIGFzc3VtcHRpb24gdGhhdCAkSF8wJCBpcyBjb3JyZWN0LgoKLSBUaHVzIGEgc21hbGwgdmFsdWUgb2YgJHAkLXZhbHVlIG1lYW5zIHRoYXQgd2UgaGF2ZSB0byAqKnJlamVjdCAgJEhfMCQqKiBpbiBmYXZvdXIgb2YgJEhfMSQuCgotIFRoZSB0aHJlc2hvbGQgdGhhdCB3ZSB1c2UgdG8gY29tcGFyZSB0aGUgJHAkLXZhbHVlIHdpdGggaXMgcmVmZXJyZWQgdG8gYXMgdGhlICoqc2lnbmlmaWNhbmNlIGxldmVsKiogYW5kIGlzIGRlbm90ZWQgd2l0aCAkXGFscGhhJC4KCi0gQSBzdGF0aXN0aWNhbCB0ZXN0IGNvbmR1Y3RlZCBvbiB0aGUgJFxhbHBoYSQgc2lnbmlmaWNhbmNlIGxldmVsIGlzIGFsc28gcmVmZXJyZWQgdG8gYXMgYSAqKmxldmVsLSRcYWxwaGEkIHRlc3QqKi4KCkEgdGVzdCByZXN1bHQgaXMgKnN0YXRpc3RpY2FsbHkgc2lnbmlmaWNhbnQqIGlmICRwPFxhbHBoYSQKCi0gJFxhbHBoYSQgaXMgY29tbW9ubHkgc2V0IGF0IDVcJS4KCi0gVGhlIHNtYWxsZXIgdGhlIHAtdmFsdWUgdGhlIG1vcmUgYHNpZ25pZmljYW50JyB0aGUgdGVzdCByZXN1bHQgZGV2aWF0ZXMgZnJvbSB3aGF0IGNhbiBiZSBleHBlY3RlZCB1bmRlciAkSF8wJC4KCi0gSXQgc3VtbWFyaXplcyB0aGUgZXZpZGVuY2UgYWdhaW5zdCB0aGUgbnVsbC4KCiQkXGJlZ2lue2FycmF5fXtjbH0+MC4xMCAmIFx0ZXh0eyBub24gc2lnbmlmaWNhbnQgKG5vIGV2aWRlbmNlKX1cXDAuMDUtMC4xMCAmIFx0ZXh0eyBtYXJnaW5hbCBzaWduaWZpY2FudCwgd2VhayBldmlkZW5jZSAoZG8gbm90IHVzZSB0aGlzIHlvdXJzZWxmKX1cXDAuMDEtMC4wNSAmIFx0ZXh0eyBzaWduaWZpY2FudH1cXDAuMDAxLTAuMDEgJiBcdGV4dHtzdHJvbmdseSBzaWduaWZpY2FudH1cXDwwLjAwMSAmIFx0ZXh0eyBleHRyZW1lbHkgc2lnbmlmaWNhbnR9XGVuZHthcnJheX0kJAoKLS0tCgojIyBDcml0aWNhbCB2YWx1ZQoKYGBge3IgIG91dC53aWR0aD0nMTAwJScsIGZpZy5hc3A9LjgsIGZpZy5hbGlnbj0nY2VudGVyJyxlY2hvPUZBTFNFfQpwYXIobWFyID0gYyg2LCA2LCA2LCAyKSkKZ3JpZCA8LSBzZXEoLTEwLCAxMCwgLjAxKQp0Y3JpdCA8LSBxdCgwLjA1LCBuIC0gMSkKcmVqZWN0IDwtIGMoZ3JpZFtncmlkIDwgdGNyaXRdLCB0Y3JpdCkKcGxvdChncmlkLCBkdChncmlkLCBuIC0gMSksIHR5cGUgPSAibCIsIGx3ZCA9IDIsIHhsYWIgPSAidC1zdGF0aXN0aWMiLCB5bGFiID0gImRlbnNpdHkiLCBjZXgubGFiID0gMiwgY2V4LmF4aXMgPSAyLCBjZXgubWFpbiA9IDIpCmFibGluZSh2ID0gbWVhbihjYXB0b3ByaWwkZGVsdGFTQlApIC8gc2UsIGNvbCA9IDIsIGx3ZCA9IDIsIGx0eSA9IDIpCmFibGluZSh2ID0gcXQoYyguMDUpLCBuIC0gMSksIGNvbCA9IDIsIGx0eSA9IDEsIGx3ZCA9IDIpCnRleHQoYygtNSwgLTUsIDUsIDUpLCBjKC4yMSwgLjE5LCAuMjEsIC4xOSksIGxhYmVsID0gYygicmVqZWN0aW9uLSIsICJyZWdpb24iLCAiYWNjZXB0aW9uLSIsICJyZWdpb24iKSwgY29sID0gYygyLCAyLCA0LCA0KSkKYXJyb3dzKC0xMDAsIC40LCBtZWFuKGNhcHRvcHJpbCRkZWx0YVNCUCkgLyBzZSwgLjQsIGx3ZCA9IDIsIGNvbCA9IDIsIGFuZ2xlID0gMjAsIGxlbmd0aCA9IC4xKQp0ZXh0KC0xMCwgLjM1LCBsYWJlbCA9ICJwLXZhbHVlIiwgc3J0ID0gOTAsIGNvbCA9IDIpCmFycm93cygtMTAwLCAuMiwgdGNyaXQsIC4yLCBsd2QgPSAyLCBjb2wgPSAyLCBhbmdsZSA9IDIwLCBsZW5ndGggPSAuMSkKdGV4dChwb3MgPSA0LCBtZWFuKGNhcHRvcHJpbCRkZWx0YVNCUCkgLyBzZSwgLjAyLCBsYWJlbCA9IHBhc3RlKCJ0PSIsIHJvdW5kKG1lYW4oY2FwdG9wcmlsJGRlbHRhU0JQKSAvIHNlLCAyKSksIGNvbCA9IDIpCmFycm93cygxMDAsIC4yLCB0Y3JpdCwgLjIsIGx3ZCA9IDIsIGNvbCA9IDQsIGFuZ2xlID0gMjAsIGxlbmd0aCA9IC4xKQp0ZXh0KHBvcyA9IDQsIHRjcml0LCAuMDIsIGxhYmVsID0gcGFzdGUoInQtY3JpdD0iLCByb3VuZCh0Y3JpdCwgMikpLCBjb2wgPSAyKQpwb2x5Z29uKGMocmVqZWN0LCB0Y3JpdCwgLTEwKSwgYyhkdChyZWplY3QsIG4gLSAxKSwgMCwgMCksIGNvbCA9IDIsIGJvcmRlciA9IDIpCnRleHQoLTMuNSwgLjA1LCBsYWJlbCA9IGV4cHJlc3Npb24ocGFzdGUoYWxwaGEsICI9MC4wNSIpKSwgY29sID0gMikKYXJyb3dzKC0yLCAwLjAyLCAtMy41LCAuMDQsIGNvbCA9IDIsIGx3ZCA9IDIsIGFuZ2xlID0gMjAsIGxlbmd0aCA9IC4xKQpgYGAKCi0tLQoKIyMgRGVjaXNpb24gRXJyb3JzCgpUaGUgZGVjaXNpb24gdG8gYWNjZXB0IG9yIHJlamVjdCAkSF8wJCBpcyBtYWRlIGJhc2VkIG9uIGEgc2luZ2xlIHNhbXBsZS4KQSB3cm9uZyBkZWNpc2lvbiBjb3VsZCBoYXZlIGJlZW4gbWFkZS4KCmBgYHtyLGVjaG89RkFMU0V9CmxpYnJhcnkoImthYmxlRXh0cmEiKQpEZWNpc2lvbkVycm9ycyA8LSBkYXRhLmZyYW1lKENvbmNsdXNpb24gPSBjKCJBY2NlcHQgSDAiLCAiUmVqZWN0IEgwIiksICJIMCIgPSBjKCJPSyIsICJUeXBlIEkgKCRcXGFscGhhJCkiKSwgIkgxIiA9IGMoIlR5cGUgSUkgKCRcXGJldGEkKSIsICJPSyIpKQprbml0cjo6a2FibGUoRGVjaXNpb25FcnJvcnMsICwgYWxpZ24gPSAiYyIpICU+JQogIGthYmxlX3N0eWxpbmcocG9zaXRpb24gPSAiY2VudGVyIikgJT4lCiAgYWRkX2hlYWRlcl9hYm92ZShjKCIgIiA9IDEsICJSZWFsaXR5IiA9IDIpKQpgYGAKIC0gVHlwZSBJIGVycm9yLCAkXGFscGhhJDogd3JvbmdseSByZWplY3QgdGhlIG51bGwgaHlwb3RoZXNpcyAoZmFsc2UgcG9zaXRpdmUpCiBcdnNwYWNlezEwcHR9CiAtIFR5cGUgSUkgZXJyb3IsICRcYmV0YSQ6IHdyb25nbHkgYWNjZXB0IHRoZSBudWxsIGh5cG90aGVzaXMKCiAtIERlY2lzaW9uIGlzIGFsc28gc3RvY2hhc3RpYyEgU2VlIGZpcnN0IGNoYXB0ZXIgb2YgdGhlIGNvdXJzZQoKIyMjIENhcHRvcHJpbCBFeGFtcGxlCgotICRIXzAkOiBhZG1pbmlzdGVyaW5nIGNhcHRvcHJpbCBoYXMgbm8gZWZmZWN0IG9uIHRoZSBzeXN0b2xpYyBibG9vZCBwcmVzc3VyZQoKLSAkSF8xJDogYWRtaW5pc3RlcmluZyBjYXB0b3ByaWwgYW4gYXZlcmFnZSBsZWFkcyB0byBhIGRlY3JlYXNlIGluIGJsb29kIHByZXNzdXJlCgotICoqVHlwZSBJIGVycm9yKio6IHRoZXJlIGlzIG9uIGF2ZXJhZ2Ugbm8gYmxvb2QgcHJlc3N1cmUgZHJvcCB1cG9uIGFkbWluaXN0ZXJpbmcgY2FwdG9wcmlsLCBidXQgd2UgY29uY2x1ZGUgdGhhdCB0aGVyZSBpcyBhbiBlZmZlY3Qgb2YgY2FwdG9wcmlsLgotICoqVHlwZSBJSSBlcnJvcioqOiB0aGVyZSBpcyBvbiBhdmVyYWdlIGEgYmxvb2QgcHJlc3N1cmUgZHJvcCB1cG9uIGFkbWluaXN0ZXJpbmcgY2FwdG9wcmlsLCBidXQgaXQgaXMgbm90IHBpY2tlZCB1cCBieSB0aGUgc3RhdGlzdGljYWwgdGVzdC4KCi0tLQoKIyMjIFR5cGUgSSBlcnJvciBpcyBjb250cm9sbGVkCgpUaGUgdHlwZSBJIGVycm9yIGlzIGNvbnRyb2xsZWQgYnkgdGhlIGNvbnN0cnVjdGlvbiBvZiB0aGUgc3RhdGlzdGljYWwgdGVzdC4KCiQkXHRleHR7UH1cbGVmdFtcdGV4dHt0eXBlIEkgZXJyb3J9XHJpZ2h0XT1cdGV4dHtQfVxsZWZ0W1x0ZXh0e3JlamVjdCB9SF8wIFxtaWQgSF8wXHJpZ2h0XSA9IFx0ZXh0e1B9XzBcbGVmdFtUPHRfe24tMTsxLVxhbHBoYX1ccmlnaHRdPVxhbHBoYSAkJAoKCi0gVGhlIHNpZ25pZmljYW5jZS1sZXZlbCAkXGFscGhhJCBpcyB0aGUgcHJvYmFiaWxpdHkgdG8gbWFrZSBhIHR5cGUgSSBlcnJvci4KCi0gVGhlIHN0YXRpc3RpY2FsIHRlc3QgZW5zdXJlcyB0aGF0IHRoZSBwcm9iYWJpbGl0eSBvbiBhIHR5cGUgSSBlcnJvciBpcyBjb250cm9sbGVkIGF0IHRoZSBzaWduaWZpY2FuY2UgbGV2ZWwgJFxhbHBoYSQuCgotIFRoZSBwcm9iYWJpbGl0eSB0byBjb3JyZWN0bHkgYWNjZXB0ICRIXzAkIGlzICQxLVxhbHBoYSQuCgotIFdlIGNhbiBzaG93IHRoYXQgdGhlIHAtdmFsdWUgdW5kZXIgJEhfMCQgaXMgdW5pZm9ybSBkaXN0cmlidXRlZC4KCi0gU28gc3RhdGlzdGljYWwgaHlwb3RoZXNpcyB0ZXN0aW5nIGxlYWRzIHRvIGEgdW5pZm9ybSBkZWNpc2lvbiBzdHJhdGVneS4KCldlIHdpbGwgaWxsdXN0cmF0ZSB0aGlzIGluIGEgc2ltdWxhdGlvbiBzdHVkeQoKLSBuPTE1Ci0gJFxtdT0wJCBtbUhnCi0gJFxzaWdtYSA9OSQgbW1IZwotIG51bWJlciBvZiBzaW11bGF0aW9ucyAxMDAwCgpgYGB7cn0KbnNpbSA8LSAxMDAwMApuIDwtIDE1CnNpZ21hIDwtIDkKbXUgPC0gMAptdTAgPC0gMAphbHBoYSA8LSAwLjA1CgojIHNpbXVsYXRlIG5zaW0gc2FtcGxlcyBvZiBzaXplIG4KZGVsdGFTaW0gPC0gbWF0cml4KHJub3JtKG4gKiBuc2ltLCBtdSwgc2lnbWEpLCBucm93ID0gbiwgbmNvbCA9IG5zaW0pCnBTaW0gPC0gYXBwbHkoZGVsdGFTaW0sIDIsIGZ1bmN0aW9uKHgsIG11LCBhbHRlcm5hdGl2ZSkgdC50ZXN0KHgsIG11ID0gbXUsIGFsdGVybmF0aXZlID0gYWx0ZXJuYXRpdmUpJHAudmFsdWUsIG11ID0gbXUwLCBhbHRlcm5hdGl2ZSA9ICJsZXNzIikKCm1lYW4ocFNpbSA8IGFscGhhKQpwU2ltICU+JQogIGFzLmRhdGEuZnJhbWUoKSAlPiUKICBnZ3Bsb3QoYWVzKHggPSAuKSkgKwogIGdlb21faGlzdG9ncmFtKCkgKwogIHhsaW0oMCwgMSkKYGBgCgotIFRoZSB0eXBlIEkgZXJyb3IgaXMgaW5kZWVkIGFib3V0IDAuMDUKLSBUaGUgcC12YWx1ZXMgYXJlIHVuaWZvcm0KCi0tLQoKIyMjIFR5cGUgSUkgZXJyb3IKCi0gRGV0ZXJtaW5lIHRoZSB0eXBlIElJIGVycm9yIGlzIGxlc3MgZXZpZGVudC4KLSBXZSBoYXZlIHRvIHJlYXNvbiB1bmRlciAkSF8xJAotIEluIHRoZSBjYXB0b3ByaWwgdm9vcmJlZWxkIGlzICRIXzE6IFxtdTwwJAotIE1hbnkgYWx0ZXJuYXRpdmVzIGFyZSBwb3NzaWJsZQotIFRoZSBkaXN0cmlidXRpb24gdW5kZXIgJEhfMSQgaXMgbm90IGZ1bGx5IHNwZWNpZmllZAoKLSAqd29yay1hcm91bmQ6KiBjaG9vc2Ugb25lIHNwZWNpZmljIGRpc3RyaWJ1dGlvbiB1bmRlciAkSF8xJC4KCiAkJEhfMShcZGVsdGEpOiBcbXU9MC1cZGVsdGEgXHRleHR7IGZvciB9XGRlbHRhPjAuJCQKCi0gZS5nLiBhIGJsb29kIHByZXNzdXJlIGRpZmZlcmVuY2Ugb2YgMiBtbUhnCgotIDEtdHlwZSBJSSBpcyBhbHNvIHJlZmVycmVkIHRvIGFzIHRoZSBwb3dlci4gSXQgaXMgdGhlIHByb2JhYmlsaXR5IHRvIHBpY2sgdXAgdGhlIGFsdGVybmF0aXZlLgoKLSBJdCBpcyBub3QgZ3VhcmFudGVlZCBieSB0aGUgZGVzaWduIG9mIHRoZSB0ZXN0CgotIEl0IGRlcGVuZHMgb24gdGhlIGV4cGVyaW1lbnRhbCBkZXNpZ24gb2YgdGhlIHN0dWR5CgoKYGBge3J9Cm5zaW0gPC0gMTAwMDAKbiA8LSAxNQpzaWdtYSA8LSA5Cm11IDwtIC0yCm11MCA8LSAwCmFscGhhIDwtIDAuMDUKCiMgc2ltdWxhdGUgbnNpbSBzYW1wbGVzIG9mIHNpemUgbgpkZWx0YVNpbSA8LSBtYXRyaXgocm5vcm0obiAqIG5zaW0sIG11LCBzaWdtYSksIG5yb3cgPSBuLCBuY29sID0gbnNpbSkKcFNpbSA8LSBhcHBseShkZWx0YVNpbSwgMiwgZnVuY3Rpb24oeCwgbXUsIGFsdGVybmF0aXZlKSB0LnRlc3QoeCwgbXUgPSBtdSwgYWx0ZXJuYXRpdmUgPSBhbHRlcm5hdGl2ZSkkcC52YWx1ZSwgbXUgPSBtdTAsIGFsdGVybmF0aXZlID0gImxlc3MiKQoKbWVhbihwU2ltIDwgYWxwaGEpCnBTaW0gJT4lCiAgYXMuZGF0YS5mcmFtZSgpICU+JQogIGdncGxvdChhZXMoeCA9IC4pKSArCiAgZ2VvbV9oaXN0b2dyYW0oKSArCiAgeGxpbSgwLCAxKQpgYGAKLSBXZSBvYnNlcnZlIHRoYXQgYSBwb3dlciBvZiBgciBtZWFuKHBTaW08YWxwaGEpYCBvciBhIHR5cGUgSUkgZXJyb3Igb2YgYHIgMS1tZWFuKHBTaW08YWxwaGEpYC4KCi0tLQoKLSBXaGVuIHdlIGluY3JlYXNlIHRoZSBzYW1wbGUgc2l6ZQoKYGBge3J9Cm5zaW0gPC0gMTAwMDAKbiA8LSAzMApzaWdtYSA8LSA5Cm11IDwtIC0yCm11MCA8LSAwCmFscGhhIDwtIDAuMDUKCiMgc2ltdWxhdGUgbnNpbSBzYW1wbGVzIG9mIHNpemUgbgpkZWx0YVNpbSA8LSBtYXRyaXgocm5vcm0obiAqIG5zaW0sIG11LCBzaWdtYSksIG5yb3cgPSBuLCBuY29sID0gbnNpbSkKcFNpbSA8LSBhcHBseShkZWx0YVNpbSwgMiwgZnVuY3Rpb24oeCwgbXUsIGFsdGVybmF0aXZlKSB0LnRlc3QoeCwgbXUgPSBtdSwgYWx0ZXJuYXRpdmUgPSBhbHRlcm5hdGl2ZSkkcC52YWx1ZSwgbXUgPSBtdTAsIGFsdGVybmF0aXZlID0gImxlc3MiKQoKbWVhbihwU2ltIDwgYWxwaGEpCnBTaW0gJT4lCiAgYXMuZGF0YS5mcmFtZSgpICU+JQogIGdncGxvdChhZXMoeCA9IC4pKSArCiAgZ2VvbV9oaXN0b2dyYW0oKSArCiAgeGxpbSgwLCAxKQpgYGAKCi0gSW5jcmVhc2luZyB0aGUgc2FtcGxlIHNpemUgbGVhZHMgdG8gYSBoaWdoZXIgcG93ZXIuCi0gU3RpbGwgdGhlIHBvd2VyIHRvIHBpY2sgdXAgc3VjaCBhIHNtYWxsIGJsb29kIHByZXNzdXJlIGRyb3AgcmVtYWlucyB2ZXJ5IGxvdy4KLSBBIGRyb3Agb2YgMiBtbUhnIGlzIGFsc28gbm90IHJlbGV2YW50IGZvciBkcnVnIGNvbXBhbmllcy4KCiFbXShodHRwczovL3d3dy5uYXR1cmUuY29tL2FydGljbGVzL25tZXRoLjI3MzgucGRmKXt3aWR0aD0xMDAlfQoKLS0tCgojIyMgSW50ZXJwcmV0YXRpb24KClN1cHBvc2UgdGhhdCBnaXZlbiBhIHBhcnRpY3VsYXIgc2FtcGxlICRwPFxhbHBoYSQsIGkuZS4gcmVqZWN0ICRIXzAkCgotIFR3byBwb3NzaWJpbGl0aWVzCgogICAgLSBjb3JyZWN0IGRlY2lzaW9uLAoJICAtIG9yIHR5cGUgSSBlcnJvci4KCi0gV2Uga25vd24gdGhhdCB0aGUgcHJvYmFiaWxpdHkgb24gYSB0eXBlIGVycm9yIGlzIGxvdywgaS5lLiAkXGFscGhhPTAuMDUkLgoKCk9uIHRoZSBvdGhlciBoYW5kLCB3aGVuICRwXGdlcVxhbHBoYSQgYW5kIHdlIGRvIG5vdCByZWplY3QgJEhfMCQgd2UgYWxzbyBoYXZlIHR3byBvcHRpb25zOgoKICAtIENvcnJlY3QgZGVjaXNpb24sCiAgLSBvciB3ZSBtYWRlIGEgdHlwZSBJSSBlcnJvci4KClRoZSBwcm9iYWJpbGl0eSBvbiBhIHR5cGUgSUkgZXJyb3IgKCRcYmV0YSQpIGlzIG5vdCBjb250cm9sbGVkIGF0IGEgc3BlY2lmaWMgdmFsdWUuCgpTdGF0aXN0aWNhbCB0ZXN0IGlzIGNvbnN0cnVjdGVkIHRvIG9ubHkgY29udHJvbCB0aGUgcHJvYmFiaWxpdHkgb24gYSB0eXBlIEkgZXJyb3IgYXQgICRcYWxwaGEkLgoKVG8gYmUgc2NpZW50aWZpY2FsbHkgY29ycmVjdCB3ZSBoYXZlIHRvIHRha2UgYSBwZXNzaW1pc3RpYyBhdHRpdHVkZSBhbmQgd2UgaGF2ZSB0byBhZG1pdCB0aGF0ICRcYmV0YSQgY2FuIGJlIGxhcmdlIChpLmUuIGEgc21hbGwgcG93ZXIgdG8gZGV0ZWN0IHRoZSBhbHRlcm5hdGl2ZSkuCgpIZW5jZSwKCi0gJHAgPCBcYWxwaGEkIHdlIHJlamVjdCAkSF8wJAoKICAgIC0gV2UgY29uY2x1ZGUgdGhhdCAkSF8xJCBpcyBwcm9iYWJseSBjb3JyZWN0LgoJICAtIFdlIHJlZmVyIHRvIHRoaXMgYXMgYSBzdHJvbmcgY29uY2x1c2lvbi4KCi0gJHAgXGdlcSBcYWxwaGEkIGFjY2VwdCAkSF8wJAoKICAtIERvZXMgbm90IGltcGx5IHRoYXQgd2UgYWNjZXB0ICRIXzAkIGNvcnJlY3RseS4KICAtIFdlIGNhbiBvbmx5IGNvbmNsdWRlIHRoYXQgdGhlIGRhdGEgZG8gbm90IGhhdmUgZW5vdWdoIGV2aWRlbmNlIGFnYWluc3QgdGhlICRIXzAkIGluIGZhdm91ciBvZiAkSF8xJC4KICAtIFdlIHJlZmVyIHRvIHRoaXMgYXMgYSB3ZWFrIGNvbmNsdXNpb24uCiAgLSBXZSB0eXBpY2FsbHkgY29uY2x1ZGUgdGhhdCB0aGUgZWZmZWN0IG9mIHRoZSB0cmVhdG1lbnQgaXMgbm90IHNpZ25pZmljYW50LgoKLS0tCgojIyBDb25jbHVzaW9ucyBjYXB0b3ByaWwgZXhhbXBsZQoKVGhlIHRlc3Qgd2UgaGF2ZSBwZXJmb3JtZWQgaXMgcmVmZXJyZWQgdG8gYXMKCi0gdGhlICoqb25lIHNhbXBsZSB0LXRlc3QqKiBvbiB0aGUgZGlmZmVyZW5jZSBvcgoKLSBhICoqcGFpcmVkIHQtdGVzdCoqLiBJbmRlZWQgd2UgZGlzcG9zZSBvZiBwYWlyZWQgb2JzZXJ2YXRpb25zIGZvciBlYWNoIHBhdGllbnQhCgotIFRoZSB0ZXN0IGlzIGRvbmUgb25lLXNpZGVkIGJlY2F1c2Ugd2UgdGVzdCBhZ2FpbnN0IHRoZSBhbHRlcm5hdGl2ZSBvZiBhIGJsb29kIHByZXNzdXJlIGRyb3AuCgotIEJvdGggdGVzdHMgKG9uZSBzYW1wbGUgdC10ZXN0IG9uIHRoZSBkaWZmZXJlbmNlIGFuZCBwYWlyZWQgdC10ZXN0KSBnaXZlIHRoZSBzYW1lIHJlc3VsdHM6CgpgYGB7cn0KdC50ZXN0KGNhcHRvcHJpbCRkZWx0YVNCUCwgYWx0ZXJuYXRpdmUgPSAibGVzcyIpCmBgYAoKYGBge3J9CnQudGVzdChjYXB0b3ByaWwkU0JQYSwgY2FwdG9wcmlsJFNCUGIsIHBhaXJlZCA9IFRSVUUsIGFsdGVybmF0aXZlID0gImxlc3MiKQpgYGAKCi0tLQoKIyMjIENvbmNsdXNpb24KClRoZXJlIGlzIG9uIGF2ZXJhZ2UgYW4gZXh0cmVtZWx5IHNpZ25pZmljYW50IGJsb29kIHByZXNzdXJlIGRyb3AgdXBvbiBhZG1pbmlzdGVyaW5nIGNhcHRvcHJpbCB0byBwYXRpZW50cyB3aXRoIGh5cGVydGVuc2lvbi4gVGhlIHN5c3RvbGljIGJsb29kIHByZXNzdXJlIGRlY3JlYXNlcyBvbiBhdmVyYWdlIHdpdGggMTguOSBtbUhnIHVwb24gdGhlIHRyZWF0bWVudCB3aXRoIGNhcHRvcHJpbCAoOTUlIENJIFskLVxpbmZ0eSwtMTQuODIkXSBtbUhnKS4KCk5vdGUgdGhhdAoKMS4gQSBvbmUtc2lkZWQgaW50ZXJ2YWwgaXMgcmVwb3J0ZWQgYmVjYXVzZSB3ZSBhcmUgb25seSBpbnRlcmVzdGVkIGluIGEgYmxvb2QgcHJlc3N1cmUgZHJvcC4KCjIuIEJlY2F1c2Ugb2YgdGhlIHByZS10ZXN0L3Bvc3QtdGVzdCBkZXNpZ24gd2UgY2Fubm90IGRpc3Rpbmd1aXNoIGJldHdlZW4gdGhlIGVmZmVjdCBvZiB0aGUgdHJlYXRtZW50IGFuZCBhIHBsYWNlYm8gZWZmZWN0LiBUaGVyZSB3YXMgbm8gZ29vZCBjb250cm9sISBUaGUgbGFjayBvZiBhIGdvb2QgY29udHJvbCB0eXBpY2FsbHkgb2NjdXJzIGluICBwcmUtdGVzdC9wb3N0LXRlc3QgZGVzaWducy4gSG93IGNvdWxkIHdlIGhhdmUgaW1wcm92ZWQgdGhlIGRlc2lnbj8KCi0tLQoKIyMgT25lLXNpZGVkIG9yIHR3by1zaWRlIHRlc3Rpbmc/CgpEZSB0ZXN0IGluIHRoZSBjYXB0b3ByaWwgZXhhbXBsZSB3YXMgYSBvbmUtc2lkZWQgdGVzdC4gV2Ugb25seSBhaW0gdG8gZGV0ZWN0IGlmIHRoZSBjYXB0b3ByaWwgdHJlYXRtZW50IG9uIGF2ZXJhZ2UgcmVkdWNlcyB0aGUgYmxvb2QgcHJlc3N1cmUuCgpTdXBwb3NlIHRoYXQgd2UgZGVmaW5lZCB0aGUgYmxvb2QgcHJlc3N1cmUgZGlmZmVyZW5jZSBhcyAgJFhfe2l9XlxwcmltZT1ZX3tpfV5cdGV4dHtiZWZvcmV9LVlfe2l9Xlx0ZXh0e2FmdGVyfSQKCi0gTm93LCBhIHBvc2l0aXZlIHZhbHVlIGluZGljYXRlcyBhIGJsb29kIHByZXNzdXJlIGRyb3AKCi0gVGhlIGF2ZXJhZ2UgY2hhbmdlIGluIGJsb29kIHByZXNzdXJlIGlzIG5vdyBkZW5vdGUgYXMgJFxtdV5ccHJpbWU9XHRleHR7RX1bWF5ccHJpbWVdJC4KCi0gU28gbm93IHdlIHNob3VsZCB1c2UgYSBvbmUtc2lkZWQgdGVzdCB0byBhc3Nlc3MgJEhfMDogXG11XlxwcmltZT0wJCBhZ2FpbnN0ICRIXzE6IFxtdV5ccHJpbWU+MCQuCgotIHAtdmFsdWUgbm93IGJlY29tZXM6CiQkcD1cdGV4dHtQfV8wXGxlZnRbVFxnZXEgdFxyaWdodF0uJCQKCi0tLQoKQW5hbHlzaXMgYmFzZWQgb24gJFheXHByaW1lJDogQXJndW1lbnQgYGFsdGVybmF0aXZlPSJncmVhdGVyImAgc28gdGhhdCB3ZSB1c2UgJEhfMTogXG11XlxwcmltZT4wJDoKYGBge3J9CnQudGVzdChjYXB0b3ByaWwkU0JQYiAtIGNhcHRvcHJpbCRTQlBhLCBhbHRlcm5hdGl2ZSA9ICJncmVhdGVyIikKYGBgCgpPZiBjb3Vyc2Ugd2Ugb2J0YWluIHRoZSBzYW1lIHJlc3VsdHMuIE9ubHkgdGhlIHNpZ24gaXMgc3dhcHBlZC4KCi0tLQoKIyMjIFR3by1zaWRlZCB0ZXN0CgpTdXBwb3NlIHRoYXQgcmVzZWFyY2hlcnMgd2FudGVkIHRvIGFzc2VzcyB0aGUgbW9kZSBvZiBhY3Rpb24gb2YgdGhlIG5ldyBkcnVnIGNhcHRvcHJpbCBpbiB0aGUgZGVzaWduIHBoYXNlIGFuZCBzdXBwb3NlIHRoYXQgaGVhbHRoeSBzdWJqZWN0cyB3ZXJlIHVzZWQgaW4gYW4gZWFybHkgcGhhc2Ugb2YgdGhlIGRydWcgZGV2ZWxvcG1lbnQuCgpJbiB0aGlzIGNhc2UgaXQgd291bGQgaGF2ZSBiZWVuIGludGVyZXN0aW5nIHRvIG9ic2VydmUgYmxvb2QgcHJlc3N1cmUgZHJvcHMgYXMgd2VsbCBhcyBnYWlucy4KClRoZW4gd2Ugd291bGQgcmVxdWlyZSBhIHR3by1zaWRlZCB0ZXN0IHN0cmF0ZWd5CgokJEhfMDogXG11PTAkJAphZ2FpbnN0IHRoZSBhbHRlcm5hdGl2ZSBoeXBvdGhlc2lzCgokJEhfMTogXG11XG5lcTAsJCQKCnNvIHRoYXQgdGhlIG1lYW4gdW5kZXIgdGhlIGFsdGVybmF0aXZlIGlzIGRpZmZlcmVudCBmcm9tIHplcm8uCgpJdCBjYW4gYmUgcG9zaXRpdmUgYXMgd2VsbCBhcyBuZWdhdGl2ZSBjaGFuZ2VzIGFuZCB3ZSBkaWQgbm90IGtub3cgdXBmcm9udCBpbiB3aGljaCBkaXJlY3Rpb24gdGhlIHJlYWwgbWVhbiB3aWxsIGRldmlhdGUgZnJvbSAkSF8xJC4KCgpXZSBjYW4gY29uZHVjdCBhIHR3by1zaWRlZCB0ZXN0IG9uIHRoZSAkXGFscGhhPTVcJSQgc2lnbmlmaWNhbmNlIGxldmVsIGJ5CgpgYGB7ciBvdXQud2lkdGg9JzEwMCUnLCBmaWcuYXNwPS44LCBmaWcuYWxpZ249J2NlbnRlcicsZWNobz1GQUxTRX0KZ3JpZCA8LSBzZXEoLTEwLCAxMCwgLjAxKQp0Y3JpdCA8LSBxdCgwLjk3NSwgbiAtIDEpCnJlamVjdDEgPC0gYyhncmlkW2dyaWQgPCAtdGNyaXRdLCAtdGNyaXQpCnJlamVjdDIgPC0gYyh0Y3JpdCwgZ3JpZFtncmlkID4gdGNyaXRdKQoKcGxvdChncmlkLCBkdChncmlkLCBuIC0gMSksIHR5cGUgPSAibCIsIGx3ZCA9IDIsIHhsYWIgPSAidC1zdGF0aXN0aWMiLCB5bGFiID0gImRlbnNpdHkiLCB5bGltID0gYygtLjA1LCAuNCkpCmFibGluZSh2ID0gYygtMSwgMSkgKiBtZWFuKGNhcHRvcHJpbCRkZWx0YVNCUCkgLyBzZSwgY29sID0gMiwgbHdkID0gMiwgbHR5ID0gMikKYWJsaW5lKHYgPSBjKC0xLCAxKSAqIHRjcml0LCBjb2wgPSAyLCBsdHkgPSAxLCBsd2QgPSAyKQp0ZXh0KGMoLTUsIC01LCA1LCA1KSwgYygtLjAzLCAtLjA1LCAtLjAzLCAtLjA1KSwgbGFiZWwgPSBjKCJyZWplY3Rpb24tIiwgInJlZ2lvbiIsICJyZWplY3Rpb24tIiwgInJlZ2lvbiIpLCBjb2wgPSBjKDIsIDIsIDIsIDIpKQp0ZXh0KGMoMCwgMCksIGMoLS4wMywgLS4wNSksIGxhYmVsID0gYygiYWNjZXB0aW9uLSIsICJyZWdpbyIpLCBjb2wgPSBjKDQsIDQpKQoKYXJyb3dzKC0xMDAsIC40LCAtYWJzKG1lYW4oY2FwdG9wcmlsJGRlbHRhU0JQKSAvIHNlKSwgLjQsIGx3ZCA9IDIsIGNvbCA9IDIsIGFuZ2xlID0gMjAsIGxlbmd0aCA9IC4xKQphcnJvd3MoMTAwLCAuNCwgYWJzKG1lYW4oY2FwdG9wcmlsJGRlbHRhU0JQKSAvIHNlKSwgLjQsIGx3ZCA9IDIsIGNvbCA9IDIsIGFuZ2xlID0gMjAsIGxlbmd0aCA9IC4xKQp0ZXh0KC0xMCwgLjM1LCBsYWJlbCA9ICJwLXZhbHVlIiwgc3J0ID0gOTAsIGNvbCA9IDIpCnRleHQoMTAsIC4zNSwgbGFiZWwgPSAicC12YWx1ZSIsIHNydCA9IDkwLCBjb2wgPSAyKQoKYXJyb3dzKC0xMDAsIC0uMDQsIC10Y3JpdCwgLS4wNCwgbHdkID0gMiwgY29sID0gMiwgYW5nbGUgPSAyMCwgbGVuZ3RoID0gLjEpCmFycm93cygxMDAsIC0uMDQsIHRjcml0LCAtLjA0LCBsd2QgPSAyLCBjb2wgPSAyLCBhbmdsZSA9IDIwLCBsZW5ndGggPSAuMSkKCnBvbHlnb24oYyhyZWplY3QxLCAtdGNyaXQsIC0xMCksIGMoZHQocmVqZWN0MSwgbiAtIDEpLCAwLCAwKSwgY29sID0gMiwgYm9yZGVyID0gMikKcG9seWdvbihjKHRjcml0LCByZWplY3QyLCB0Y3JpdCksIGMoMCwgZHQocmVqZWN0MiwgbiAtIDEpLCAwKSwgY29sID0gMiwgYm9yZGVyID0gMikKCnRleHQoLTMuNSwgLjA1LCBsYWJlbCA9IGV4cHJlc3Npb24ocGFzdGUoYWxwaGEsICIvMj0yLjUlIikpLCBjb2wgPSAyKQp0ZXh0KDMuNiwgLjA1LCBsYWJlbCA9IGV4cHJlc3Npb24ocGFzdGUoYWxwaGEsICIvMj0yLjUlIikpLCBjb2wgPSAyKQphcnJvd3MoLTMsIDAuMDIsIC0zLjUsIC4wNCwgY29sID0gMiwgbHdkID0gMiwgYW5nbGUgPSAyMCwgbGVuZ3RoID0gLjEpCmFycm93cygzLCAwLjAyLCAzLjUsIC4wNCwgY29sID0gMiwgbHdkID0gMiwgYW5nbGUgPSAyMCwgbGVuZ3RoID0gLjEpCmBgYAoKLS0tCgpUaGUgYXJndW1lbnQgYGFsdGVybmF0aXZlYCBvZiB0aGUgYHQudGVzdGAgZnVuY3Rpb24gaXMgYnkgZGVmYXVsdCBgYWx0ZXJuYXRpdmU9InR3by5zaWRlZCJgLgoKYGBge3J9CnQudGVzdChjYXB0b3ByaWwkZGVsdGFTQlApCmBgYAoKLSBXZSBzdGlsbCBvYnRhaW4gYW4gZXh0cmVtZWx5IHNpZ25pZmljYW50IHJlc3VsdC4KLSBUaGUgcC12YWx1ZSBpcyBkb3VibGUgYXMgbGFyZ2UgYmVjYXVzZSB3ZSB0ZXN0IHR3by1zaWRlZC4KCkluZGVlZAoKJCRwPVBfMFtUIFxsZXEgLVx2ZXJ0IHQgXHZlcnRdICsgUF8wW1QgXGdlcSBcdmVydCB0IFx2ZXJ0XSA9IFBfMFtcdmVydCBUIFx2ZXJ0IFxnZXEgXHZlcnQgdCBcdmVydF0gPSAyIFx0aW1lcyBQXzBbVCBcZ2VxIFx2ZXJ0IHQgXHZlcnRdJCQKCi0gV2UgYWxzbyBvYnRhaW4gYSAgdHdvLXNpZGVkIGNvbmZpZGVuY2UgaW50ZXJ2YWwKCi0tLQoKIyMjIE9uZS1zaWRlZCBvciB0d28tc2lkZWQgdGVzdD8KCldpdGggYSBvbmUtc2lkZWQgdGVzdCB3ZSBjYW4gbW9yZSBlYXNpbHkgcmVqZWN0ICRIXzAkIG9uIGNvbmRpdGlvbiB0aGF0ICRIXzEkIGlzIHRydWUgdGhhbiB3aXRoIGEgdHdvLXNpZGVkIHRlc3QuCgotIEFsbCBpbmZvcm1hdGlvbiBpcyB1c2VkIHRvIHRlc3QgaW50byBvbmUgZGlyZWN0aW9uCgotIFRoZSBkZWNpc2lvbiB0byB0ZXN0IG9uZS1zaWRlZCBoYXMgdG8gYmUgZG9uZSBpbiB0aGUgZGVzaWduIHBoYXNlIGJlZm9yZSB0aGUgZXhwZXJpbWVudCBpcyBjb25kdWN0ZWQKCi0gRXZlbiBpZiB3ZSBoYXZlIHN0cm9uZyBhIHByaW9yaSBwcmVzdW1wdGlvbnMsIHdlIGFyZSBub3QgZW50aXJlbHkgc3VyZSBvdGhlcndpc2Ugd2Ugd291bGQgaGF2ZSBubyByZWFzb24gdG8gZG8gdGhlIHJlc2VhcmNoLgoKLSBJZiB3ZSBwcm9wb3NlIGEgb25lLXNpZGVkIHRlc3QgaW4gdGhlIGRlc2lnbiBwaGFzZSBhbmQgd2Ugb2JzZXJ2ZSBhIHJlc3VsdCBpbiB0aGUgb3Bwb3NpdGUgZGlyZWN0aW9uIHRoYXQgd291bGQgYmUgc3RhdGlzdGljYWxseSBzaWduaWZpY2FudCB3ZSBjYW4gbm90IGRyYXcgY29uY2x1c2lvbnMgZnJvbSB0aGUgZXhwZXJpbWVudC4KCi0gSW4gdGhlIGRlc2lnbiBwaGFzZSB3ZSBoYXZlIGV4Y2x1ZGVkIHRoaXMgcmVzdWx0IGJlY2F1c2UgaXQgaXMgc28gdW5leHBlY3RlZCB0aGF0IGl0IGhhcyB0byBiZSBhIGZhbHNlIHBvc2l0aXZlLgoKLSBIZW5jZSwgb25lLXNpZGVkIHRlc3RzIGFyZSBub3QgcmVjb21tZW5kZWQuCgpBIHR3by1zaWRlZCB0ZXN0IGNhbiBhbHdheXMgYmUgZGVmZW5kZWQgYW5kIGFsbG93cyB5b3UgdG8gZGV0ZWN0IGFueSBkZXZpYXRpb24gb2YgJEhfMCQgYW5kIGlzIGhpZ2hseSByZWNvbW1lbmRlZC4KCgpJdCBpcyAqKm5ldmVyIGFsbG93ZWQqKiB0byBjaGFuZ2UgYSB0d28tc2lkZWQgdGVzdCBpbnRvIGEgb25lLXNpZGVkIHRlc3QgYmFzZWQgb24gd2hhdCBoYXMgYmVlbiBvYnNlcnZlZCBpbiB0aGUgc2FtcGxlISBPdGhlcndpc2UgdGhlIHR5cGUgSSBlcnJvciBvZiB0aGUgdGVzdCBzdHJhdGVneSBpcyBub3QgY29ycmVjdGx5IGNvbnRyb2xsZWQuCgotLS0KCldlIGlsbHVzdHJhdGUgdGhpcyBpbiB0aGUgc2ltdWxhdGlvbiBzdHVkeSBiZWxvdzoKCjEuIGNvcnJlY3QgdHdvLXNpZGVkIHRlc3QgYW5kCjIuIG9uZS1zaWRlZCB0ZXN0IHdpdGggaXRzIHNpZ24gYmFzZWQgb24gd2hhdCB3YXMgb2JzZXJ2ZWQgaW4gdGhlIHNhbXBsZS4KCgpgYGB7cn0KbXUgPC0gMApzaWdtYSA8LSA5LjAKblNpbSA8LSAxMDAwCmFscGhhIDwtIDAuMDUKbiA8LSAxNQpwdmFsc0NvciA8LSBwdmFsc0luQ29yIDwtIGFycmF5KDAsIG5TaW0pCmZvciAoaSBpbiAxOm5TaW0pCnsKICB4IDwtIHJub3JtKG4sIG1lYW4gPSBtdSwgc2QgPSBzaWdtYSkKICBwdmFsc0NvcltpXSA8LSB0LnRlc3QoeCkkcC52YWx1ZQogIGlmIChtZWFuKHgpIDwgMCkgewogICAgcHZhbHNJbkNvcltpXSA8LSB0LnRlc3QoeCwgYWx0ZXJuYXRpdmUgPSAibGVzcyIpJHAudmFsdWUKICB9IGVsc2UgewogICAgcHZhbHNJbkNvcltpXSA8LSB0LnRlc3QoeCwgYWx0ZXJuYXRpdmUgPSAiZ3JlYXRlciIpJHAudmFsdWUKICB9Cn0KCm1lYW4ocHZhbHNDb3IgPCAwLjA1KQptZWFuKHB2YWxzSW5Db3IgPCAwLjA1KQpgYGAKCi0gVHlwZSBJIGVycm9yIGNvcnJlY3RseSBjb250cm9sbGVkIGF0ICRcYWxwaGEkIGZvciB0d28tc2lkZWQgdGVzdC4KLSBUeXBlIEkgZXJyb3Igbm90IGNvcnJlY3RseSBjb250cm9sbGVkIHdoZW4gd2UgdGVzdCBvbmUtc2lkZWQgYmFzZWQgb24gd2hhdCB3ZSBvYnNlcnZlZCBpbiB0aGUgc2FtcGxlLgoKIyBOYXR1cmUgY29sdW1uIG9uIHRlc3RpbmcKCiFbXShodHRwczovL3d3dy5uYXR1cmUuY29tL2FydGljbGVzL25tZXRoLjI2OTgucGRmKXt3aWR0aD0xMDAlfQo=</div>
<div class="footer">
    <hr>
    This work is licensed under the <a href= "https://creativecommons.org/licenses/by-nc-sa/4.0">
    CC BY-NC-SA 4.0</a> licence.
</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("05-statisticalInference.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
